; Moved from MordorInfantry.INI Aug 24 2005

;------------------------------------------------------------------------------
; aka Orc Archer, MordorOrcArcher, ArcherMordor, OrcArcher
Object IsengardOrcArcher
	; *** ART Parameters ***

	; This is required for garrisoned objects - please put in all objects.
	ButtonImage = UIMordorArchers
	SelectPortrait         = UPMordorOrcArchers
;	UpgradeCameo1           = Upgrade_FireArrows

	Draw = W3DHordeModelDraw ModuleTag_01

		OkToChangeModelColor = Yes
		StaticModelLODMode = Yes
		ParticlesAttachedToAnimatedBones = yes

		; specify options for static LODs
		LodOptions	= LOW
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_LOW
			MaxRandomTextures		=	2
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_LOW
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_LOW
		End
	
		LodOptions	= MEDIUM
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_MED
			MaxRandomTextures		=	3
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_MED
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_MED
		End
		
		LodOptions	= HIGH
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_HIGH
			MaxRandomTextures		=	4
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_HIGH
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_HIGH
		End

		RandomTexture = muorc2.tga 0 muorc1.tga
;		RandomTexture = muorc16.tga 0 muorc1.tga
;		RandomTexture = muorc12.tga 0 muorc1.tga
;		RandomTexture = muorcheads.tga 0 muorcheads.tga
;		RandomTexture = muorchelms1.tga 0 muorchelms1.tga

;========= WITH BOW

        DefaultModelConditionState
            Model                        = iuorcarch_skn
            Skeleton                    = MUOrcArchr_SKL
            WeaponLaunchBone            = PRIMARY ARRROW
        End
    
;========= WITH BOW UPGRADE

        ModelConditionState            WEAPONSET_PLAYER_UPGRADE
            Model                        = iuorcarch_skn
            Skeleton                    = MUOrcArchr_SKL
            WeaponLaunchBone            = PRIMARY ARRROW
            ;ParticleSysBone                = arrowFire arrowFire FollowBone:Yes
        End

;========= DEFAULT IDLE ANIMATIONS

		IdleAnimationState
			StateName = STATE_Idle
				Animation = IDLA
				AnimationName		= MUOrcArchr_IDLA
				AnimationMode		= ONCE
				AnimationPriority	= 6
				AnimationSpeedFactorRange = 0.8 1.2
				AnimationBlendTime  = 15
			End
			;*** Repeat IDLA because animation priorities will not choose same animation twice so it can alternate between first two mostly.
			StateName = STATE_Idle
				Animation = IDLA
				AnimationName		= MUOrcArchr_IDLA
				AnimationMode		= ONCE
				AnimationPriority	= 6
				AnimationSpeedFactorRange = 0.8 1.2
				AnimationBlendTime  = 15
			End
			Animation = IDLC
				AnimationName		= MUOrcArchr_IDLC
				AnimationMode		= ONCE
				AnimationPriority	= 1
				AnimationSpeedFactorRange = 0.8 1.2
				AnimationBlendTime  = 15
			End
			Animation = IDLD
				AnimationName		= MUOrcArchr_IDLD
				AnimationMode		= ONCE
				AnimationPriority	= 1
				AnimationSpeedFactorRange = 0.8 1.2
				AnimationBlendTime  = 15
			End
;			Animation = IDLE
;				AnimationName		= MUOrcArchr_IDLE
;				AnimationMode		= ONCE
;				AnimationPriority	= 1
;				AnimationSpeedFactorRange = 0.8 1.2
;				AnimationBlendTime  = 15
;			End
;			Animation = IDLF
;				AnimationName		= MUOrcArchr_IDLF
;				AnimationMode		= ONCE
;				AnimationPriority	= 1
;				AnimationSpeedFactorRange = 0.8 1.2
;				AnimationBlendTime  = 15
;			End
			BeginScript
				CurDrawableShowSubObject("arrownock") ;Circumvents blend issues when the arrow is being shown...

				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected"	then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") return end
			EndScript
		End
 
;========= PASSENGER ANIMS
    AnimationState						= PASSENGER EATING
		Animation						= being_eaten
			AnimationName				= MUOrcArchr_EATA
			AnimationMode				= ONCE
		End
    End
 
    AnimationState						= PASSENGER
		Animation						= Wiggling
			AnimationName				= MUOrcArchr_FLLA
			AnimationMode				= LOOP
		End
    End

    AnimationState						= THROWN_PROJECTILE
		Animation						= Thrown
			AnimationName				= MUOrcArchr_FLYA
			AnimationMode				= LOOP
		End
    End

;========= FLYING THROUGH AIR

	AnimationState						= FREEFALL
		Animation						= Flying_1
			AnimationName				= MUORCARCHR_FLYA
			AnimationMode				= LOOP
			AnimationSpeedFactorRange	= 0.5	0.5
			AnimationBlendTime			= 10
		End
    End
 
;========= STUNNED ANIMS

    AnimationState = STUNNED_FLAILING
 		Animation = Flying
			AnimationName = MUOrcArchr_FLYA
			AnimationMode = LOOP
			AnimationSpeedFactorRange	= 0.4 0.6
		End
		Flags = RANDOMSTART
    End
    
    ;========= DYING

		AnimationState			= DYING BURNINGDEATH
			Animation
				AnimationName	= MUOrcArchr_DIEA
				AnimationMode	= ONCE
				AnimationBlendTime = 10
			End
			Animation
				AnimationName	= MUOrcArchr_DIEB
				AnimationMode	= ONCE
				AnimationBlendTime = 10
			End
			Animation
				AnimationName	= MUOrcArchr_DIEC
				AnimationMode	= ONCE
				AnimationBlendTime = 10
			End
			Animation
				AnimationName	= MUOrcArchr_DIED
				AnimationMode	= ONCE
				AnimationBlendTime = 10
			End
		End

    ; smashed
    AnimationState						= USER_1 DYING
		Animation						= Moving
			AnimationName				= MUOrcArchr_DIEC
			AnimationMode				= ONCE
		End
    End
    
    AnimationState						= DYING SPLATTED
 		Animation						= Splattered_On_Ground
			AnimationName				= MUOrcArchr_LNDA
			AnimationMode				= ONCE
		End
		EnteringStateFX					= FX_OrcHitGround
    End

    AnimationState = DYING AFLAME
 		Animation = Flaming_Death
			AnimationName = MUOrcArchr_MFDA
			AnimationMode = LOOP
		End
		Animation = Flaming_Death2
			AnimationName = MUOrcArchr_MFDB
			AnimationMode = LOOP
		End
    End

    AnimationState = DYING
 		Animation = Dying1
			AnimationName = MUOrcArchr_DIEA
			AnimationMode = ONCE
			AnimationPriority = 20
		End
		Animation = Dying2
			AnimationName = MUOrcArchr_DIEB
			AnimationMode = ONCE
			AnimationPriority = 1
		End
		Animation = Dying3
			AnimationName = MUOrcArchr_DIEC
			AnimationMode = ONCE
			AnimationPriority = 5
		End
		Animation = Dying4
			AnimationName = MUOrcArchr_DIED
			AnimationMode = ONCE
			AnimationPriority = 15
		End
    End
    
		AnimationState			= BURNINGDEATH
			Animation
				AnimationName	= MUOrcArchr_MFDB
				AnimationMode	= LOOP
				Distance		= 30
			End
		End

	AnimationState						= PARALYZED
		Animation
			AnimationName				= MUOrcArchr_IDLA
			AnimationMode				= LOOP
		End
	End

    ;========= STUNNED ANIMS

    AnimationState = STUNNED_STANDING_UP
 		Animation = Standing_Back_Up
			AnimationName = MUOrcArchr_GTPA
			AnimationMode = ONCE
			AnimationSpeedFactorRange = 1.5 1.5
		End
    End
    
    AnimationState = STUNNED
 		Animation = Splattered_On_Ground
			AnimationName = MUOrcArchr_LNDA
			AnimationMode = ONCE
		End
		EnteringStateFX = FX_OrcHitGround
    End


 


;========= CLIMBING

	AnimationState				= MOVING CLIMBING BACKING_UP
		Animation				= ClimbingDown
			AnimationName		= MUOrcArchr_CLMA
			AnimationMode		= LOOP_BACKWARDS
		End
    End

	AnimationState				= MOVING CLIMBING
		Animation				= ClimbingUp
			AnimationName		= MUOrcArchr_CLMA
			AnimationMode		= LOOP
		End
    End

;========= TERROR

	AnimationState					= MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
		ShareAnimation = Yes
		Animation					= TerrorFromTheSky
			AnimationName			= MUOrcArchr_RUNG
			AnimationMode			= LOOP
		End
	End
	AnimationState					= MOVING EMOTION_TERROR
		ShareAnimation = Yes
		Animation					= Terror
			AnimationName			= MUOrcArchr_RUNF
			AnimationMode			= LOOP
		End
	End

;========= BACKING UP

	AnimationState = MOVING BACKING_UP
		ShareAnimation = Yes
		;Animation = Backing_Up_1
		;	AnimationName = MUOrcArchr_BAKA
		;	AnimationMode = LOOP
		;End
 		;Animation = Backing_Up_2
		;	AnimationName = MUOrcArchr_BAKB
		;	AnimationMode = LOOP
		;End
 		Animation = Backing_Up_3
			AnimationName = MUOrcArchr_BAKC
			AnimationMode = LOOP
		End
	End    
       
;========= MOVING

	AnimationState					=	MOVING WANDER
		ShareAnimation = Yes
		Animation					=	Wander1
			AnimationName			=	MUOrcArchr_WLKA 
		End
		Animation					=	Wander2
			AnimationName			=	MUOrcArchr_WLKB ;20
		End
		Flags						=	RANDOMSTART
	End

	AnimationState = MOVING
		ShareAnimation = Yes
		Animation = Moving
			AnimationName = MUOrcArchr_RUNB
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 0.8 0.8
		End
		Animation = Moving
			AnimationName = MUOrcArchr_RUNC
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 0.8 0.8
		End
		Animation = Moving
			AnimationName = MUOrcArchr_RUND
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 0.8 0.8
		End
		ParticleSysBone = None InfantryDustTrails
		BeginScript
			CurDrawableShowSubObject("arrownock") ;Circumvents blend issues when the arrow is being shown...
		EndScript
	End
	
	
	AnimationState					=	FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
  		Animation					=	BowPunchWhenClose
  			AnimationName			=	MUOrcArchr_ATKD 
  			AnimationMode			=	ONCE
  			UseWeaponTiming			=	Yes
  		End
 		BeginScript
			CurDrawableHideSubObject("arrow") ;Circumvents blend issues when the arrow is being shown...
		EndScript
 	End
	

;========= NEW STYLE ARCHERY 

	AnimationState					=	PREATTACK_A 
		StateName					=	STATE_PreFiring
		Animation					=	ReadyToDrawn
			AnimationName			=	MUOrcArchr_ATA1
			AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
			AnimationBlendTime		=	10
		End
	End

	AnimationState					=	FIRING_OR_RELOADING_A 
		StateName					=	STATE_Firing
		Animation					=	OneFrameOfShooting
			AnimationName			=	MUOrcArchr_ATA2
			AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; Left in as reminder why not to use: UseWeaponTiming does not work for archers. Do not attempt to use this!
			AnimationSpeedFactorRange = 1.1 1.1			; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
			AnimationBlendTime		=	0				; Blend time needs to be zero or else the arrow subobject lingers length of blend.
		End
	End

	AnimationState					=	PREATTACK_C 
		StateName					=	STATE_PreFiring
		Animation					=	ReadyToDrawn
			AnimationName			=	MUOrcArchr_ATA1
			AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
			AnimationBlendTime		=	10
		End
	End

	AnimationState					=	FIRING_OR_RELOADING_C
		StateName					=	STATE_Firing
		Animation					=	OneFrameOfShooting
			AnimationName			=	MUOrcArchr_ATA2
			AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; Left in as reminder why not to use: UseWeaponTiming does not work for archers. Do not attempt to use this!
			AnimationSpeedFactorRange = 1.1 1.1			; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
			AnimationBlendTime		=	0				; Blend time needs to be zero or else the arrow subobject lingers length of blend.
		End
	End

;========= PERSISTANT FIRING (KEEP BOW DRAWN )

	AnimationState					= CONTINUOUS_FIRE_MEAN
		StateName					=	STATE_Coasting
		Animation					=	HangFrameWhileCoasting
			AnimationName			=	MUOrcArchr_ATA2
			AnimationMode			=	MANUAL
		End
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "STATE_Firing" then CurDrawableAllowToContinue() return end
		EndScript
	End
	
	AnimationState					= CONTINUOUS_FIRE_SLOW
		StateName					= STATE_Idle
		Animation					= PutAwayArrow
			AnimationName			= MUOrcArchr_ATA3
			AnimationMode			= ONCE
		End
	End

;========= HIT REACTION

	AnimationState = HIT_REACTION
		Animation = Hit_Level_1_a
			AnimationName = MUOrcArchr_HITA
			AnimationMode = ONCE
		End
	End
	
;========= WAR CHANT 

	AnimationState = WAR_CHANT
;		Animation = Chant
;			AnimationName = MUOrcArchr_TNTA ; This looks bad here.
;			AnimationMode = ONCE
;		End
		Animation					= TauntingA
			AnimationName			= MUOrcArchr_TNTA
			AnimationMode			= ONCE
		End
		Animation					= TauntingB
			AnimationName			= MUOrcArchr_TNTB
			AnimationMode			= ONCE
		End
		Animation					= TauntingC
			AnimationName			= MUOrcArchr_TNTC
			AnimationMode			= ONCE
		End
		Animation					= TauntingD
			AnimationName			= MUOrcArchr_TNTD
			AnimationMode			= ONCE
		End	
		Flags						= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
	End

;========= EMOTIONS ===================================
		
;;======= TERROR

		AnimationState							= EMOTION_AFRAID
			ShareAnimation						= Yes
			Animation							= FERA
				AnimationName					= MUOrcArchr_FERA
				AnimationMode					= LOOP
			End
			Animation							= FERB
				AnimationName					= MUOrcArchr_FERB
				AnimationMode					= LOOP
			End
			Animation							= FERC
				AnimationName					= MUOrcArchr_FERC
				AnimationMode					= LOOP
			End
		End	

;;======= TAUNTING

		AnimationState							= EMOTION_TAUNTING
			Animation							= TNTA
				AnimationName					= MUOrcArchr_TNTA
				AnimationMode					= ONCE
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Animation							= TNTB
				AnimationName					= MUOrcArchr_TNTB
				AnimationMode					= ONCE
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Animation							= TNTC
				AnimationName					= MUOrcArchr_TNTC
				AnimationMode					= ONCE
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Animation							= TNTD
				AnimationName					= MUOrcArchr_TNTD
				AnimationMode					= ONCE
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Flags								= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
		End
		
;;======= POINTING

		AnimationState							= EMOTION_POINTING
			Animation							= Pointing1
				AnimationName					= MUOrcArchr_PNTA
				AnimationMode					= LOOP
			End
		End

;;======= CELEBRATING
		AnimationState							= EMOTION_CELEBRATING
			Animation							= CHRA1
				AnimationName					= MUOrcArchr_CHRA
				AnimationMode					= Once
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Animation							= CHRA2
				AnimationName					= MUOrcArchr_CHRB
				AnimationMode					= Once
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Animation							= CHRA3
				AnimationName					= MUOrcArchr_CHRC
				AnimationMode					= Once
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Flags								= RESTART_ANIM_WHEN_COMPLETE
		End
	
;;======= ALERT

		AnimationState							= EMOTION_ALERT
			Animation							= ALERT
				AnimationName					= MUOrcArchr_IDLB
				AnimationMode					= LOOP
			End
			Flags								= RANDOMSTART
		End

		AnimationState							= RAISING_FLAG
			Animation							= CHRA1
				AnimationName					= MUOrcArchr_CHRA
				AnimationMode					= Once
				AnimationSpeedFactorRange		= 0.9 1.1
			End
			Animation							= CHRA2
				AnimationName					= MUOrcArchr_CHRB
				AnimationMode					= Once
				AnimationSpeedFactorRange		= 0.9 1.1
			End
			Animation							= CHRA3
				AnimationName					= MUOrcArchr_CHRC
				AnimationMode					= Once
				AnimationSpeedFactorRange		= 0.9 1.1
			End
			Flags								= RESTART_ANIM_WHEN_COMPLETE
		End


;;======= SELECTED

		AnimationState = SELECTED
			StateName			= STATE_Selected
 			Animation			= Selected
				AnimationName	= MUOrcArchr_ATNB
				AnimationMode	= LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle"	then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") return end
			EndScript
		End

;;======= TRANSITIONS

		TransitionState = TRANS_Idle_to_Selected
			Animation			= Salute
				AnimationName	= MUOrcArchr_ATNA
				AnimationMode	= ONCE
			End		
		End
		
		TransitionState = TRANS_Selected_to_Idle
			Animation			= ATNC
				AnimationName	= MUOrcArchr_ATNC
				AnimationMode	= ONCE
			End		
		End		
	End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"

; ***DESIGN parameters ***
	Side 		= Isengard
	EditorSorting 	= UNIT
	ThreatLevel 	= 1.0
	ThingClass 	= HORDE_UNIT
	EmotionRange 	= 240
	CommandPoints 	= 3 ;;,;; 2		; originally 3

	TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT
	WeaponSet
		Conditions 	= None 
		Weapon 		= PRIMARY    MordorArcherBow
		Weapon 		= TERTIARY   MordorArcherBowBombard
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT			; Not from AI.
	End
;	WeaponSet
;		Conditions 	= CLOSE_RANGE CONTESTING_BUILDING
;		Weapon 		= PRIMARY   MordorArcherBowMelee
;		Weapon 		= TERTIARY   MordorArcherBowBombard
;		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
;	End
	ArmorSet
		Conditions      = None
		Armor           = MordorArcherArmor
		DamageFX        = NormalDamageFX
	End
	ArmorSet
		Conditions	= PLAYER_UPGRADE
		Armor		= MordorArcherHeavyArmor
		DamageFX	= NormalDamageFX
	End


	ShroudClearingRange = SHROUD_CLEAR_STANDARD
	VisionRange = MORDOR_ARCHER_VISION_RANGE

	BountyValue = 4  ;MORDOR_ARCHER_BOUNTY_VALUE
	DisplayName = OBJECT:MordorArcher
	CrushableLevel = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 0 ;What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
	CrushRevengeWeapon = RangedInfantryCrushRevenge
	  
	CommandSet = MordorArcherCommandSet
 
	; *** AUDIO Parameters ***;

	VoiceAttack 					= OrcArcherVoiceAttackMS
	VoiceAttackAir					= OrcArcherVoiceAttackMS
	VoiceAttackStructure				= OrcArcherVoiceAttackBuilding
	VoiceAttackCharge				= OrcArcherVoiceAttackCharge
	VoiceCreated					= EVA:OrcArchersCreated
	VoiceFullyCreated 				= EVA:OrcArchersCreated
	VoiceGuard					= OrcArcherVoiceMove
	VoiceMove 					= OrcArcherVoiceMoveMS
	VoiceMoveWhileAttacking				= OrcArcherVoiceDisengage
	VoicePriority					= 46
	VoiceRetreatToCastle				= OrcArcherVoiceRetreat
	VoiceSelect 					= OrcArcherVoiceSelectMS
	VoiceSelectBattle				= OrcArcherVoiceSelectBattle

	VoiceEnterStateAttack 				= OrcArcherVoiceEnterStateAttack		
	VoiceEnterStateAttackStructure			= OrcArcherVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackCharge			= OrcArcherVoiceEnterStateAttackCharge
	VoiceEnterStateMove 				= OrcArcherVoiceEnterStateMove		
	VoiceEnterStateMoveWhileAttacking		= OrcArcherVoiceEnterStateDisengage
	VoiceEnterStateRetreatToCastle			= OrcArcherVoiceEnterStateRetreat
	
	SoundImpact 					= ImpactHorse					;UrukDie

	UnitSpecificSounds
		VoiceGarrison				= OrcArcherVoiceGarrison
		VoiceEnterUnitSlaughterHouse		= OrcArcherVoiceGarrisonSlaughterHouse
		VoiceEnterUnitMordorMumakil		= OrcArcherVoiceEnterMumakil
		VoiceEnterUnitEvilMenTransportShip	= OrcArcherVoiceEnterShip
		VoiceEnterUnitTransportShip		= OrcArcherVoiceEnterShip
		VoiceInitiateCaptureBuilding		= OrcHordeVoiceCaptureBuilding			;OrcArcherVoiceMoveMS
	End

	CrowdResponseKey = Orc

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
	;EvaEventDieOwner			= GroupOrcArcherDie		;Eva event to trigger on unit's death. NOTICE THAT this is only for permanent deaths
										;For deaths you can respawn from, use the DeathFX

	ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
		ModelCondition = Required:RAISING_FLAG			Excluded:DYING ENGAGED	Sound:EmotionOrcCompilationVoxTauntSinglesLoop
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:BodyFallOrc			Animation:MUOrcArchr_SKL.MUOrcArchr_DIEA	Frames:20
		AnimationSound = Sound:BodyFallOrc			Animation:MUOrcArchr_SKL.MUOrcArchr_DIEB	Frames:22
		AnimationSound = Sound:BodyFallGeneric2		Animation:MUOrcArchr_SKL.MUOrcArchr_DIEB	Frames:80
		AnimationSound = Sound:BodyFallOrc			Animation:MUOrcArchr_SKL.MUOrcArchr_DIEC	Frames:48
		AnimationSound = Sound:BodyFallOrc			Animation:MUOrcArchr_SKL.MUOrcArchr_DIED	Frames:33
	End


	; *** ENGINEERING Parameters ***

	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER CAN_USE_SIEGE_TOWER SCORE THROWN_OBJECT ORC ATTACK_NEEDS_LINE_OF_SIGHT ARCHER GRAB_AND_DROP
	 
	Body = ActiveBody ModuleTag_02
		CheerRadius 	= EMOTION_CHEER_RADIUS
		MaxHealth         	= MORDOR_ARCHER_HEALTH
		MaxHealthDamaged  	= MORDOR_ARCHER_HEALTH_DAMAGED
		BurningDeathBehavior = Yes
		BurningDeathFX       = FX_InfantryBurningFlame
	End
 
	Behavior = AIUpdateInterface ModuleTag_03
		AutoAcquireEnemiesWhenIdle	=	Yes ATTACK_BUILDINGS
		CanAttackWhileContained		=	Yes
		AILuaEventsList				=	IsengardOrcArcherFunctions
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		AttackPriority				= 	AttackPriority_Archer
		BurningDeathTime			=	BURNINGDEATH_DURATION_INFANTRY
	End
	  
	LocomotorSet
		Locomotor = BurningDeathLocomotorInfantry
		Condition = SET_BURNINGDEATH
		Speed	  = BURNINGDEATH_WANDERSPEED_INFANTRY
	End

	LocomotorSet
		Locomotor   = HumanLocomotor
		Condition   = SET_NORMAL
		Speed       = NORMAL_FOOT_MED_MEMBER_SPEED
	End

	;------------- Fire arrow upgrade ----------------
	Behavior 		= WeaponSetUpgrade ModuleTag_Fire
		TriggeredBy 	= Upgrade_MordorFireArrows
	End

  	Behavior 		= SubObjectsUpgrade FireArrows_Upgrade
  		TriggeredBy	= Upgrade_MordorFireArrows
  		ShowSubObjects	= ARROWFIRE
  		HideSubObjects	= arrrow			; yes, it's a typo.
  	End
  	
	;------------- HeavyArmor Upgrade ----------------
	Behavior 		= ArmorUpgrade ArmorUpgradeModuleTag
		TriggeredBy 	= Upgrade_MordorHeavyArmor
		ArmorSetFlag	= PLAYER_UPGRADE
	End


	Behavior = SubObjectsUpgrade Armor_Upgrade				; Added for BFME Expansion
		TriggeredBy		= Upgrade_MordorHeavyArmor
		UpgradeTexture		= MUOrcArchr.tga 0 MUOrcArchr_HA.tga
		RecolorHouse		= Yes
		ExcludeSubobjects	= Forged_Blade
	End


	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult = 1.0
		ShockStandingTime = 1200	;msec
	End
  
	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes = ALL -KNOCKBACK
		SinkDelay = 3000
		SinkRate = 0.60     ; in Dist/Sec
		DestructionDelay = 10000
		Sound = INITIAL OrcVoiceDie				;UrukDie
	End
	 
	Behavior = SquishCollide ModuleTag_06
		;nothing
	End
	
	; MordorArcher
	Behavior = HordeMemberCollide ModuleTag_HMC
		;nothing
	End
	 
	Behavior = SlowDeathBehavior ModuleTag_07
		; Same as normal death, but no sound (sound already played by SoundImpact = ... )
		DeathTypes = NONE +KNOCKBACK
		SinkDelay = 3000
		SinkRate = 0.60     ; in Dist/Sec
		DestructionDelay = 10000
		Sound = INITIAL OrcVoiceDie
	End
 
	Behavior = BezierProjectileBehavior ModuleTag_08 ; Module starts asleep, and wakes up when thrown.
		FirstHeight = 24  ; Height of Bezier control points above highest intervening terrain
		SecondHeight = 24
		FirstPercentIndent = 30% ; Percentage of shot distance control points are placed
		SecondPercentIndent = 70%
		TumbleRandomly = Yes

		CrushStyle = Yes ; I don't detonate, I just hit
		DieOnImpact = Yes
		BounceCount = 1   ; When I hit the ground, I'll arc again
		BounceDistance = 40 ; this far
		BounceFirstHeight = 24  ; Height of Bezier control points above highest intervening terrain
		BounceSecondHeight = 24
		BounceFirstPercentIndent = 20% ; Percentage of shot distance control points are placed
		BounceSecondPercentIndent = 80%

		GroundHitFX       = FX_ThrownRockGroundHit
		GroundBounceFX    = FX_ThrownRockBounceHit
	End

	; Tie into LargeGroupAudio system
	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
		Key = Orc_Archer
	End


; 	Behavior = DualWeaponBehavior ModuleTag_10
;		SwitchWeaponOnCloseRangeDistance = 40
;	End
	
;	Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
;		HitReactionLifeTimer1 = 1800 ; level 1 (light  damage)  hit reaction animations in frames (5 per sec)
;		HitReactionLifeTimer2 = 1800 ; level 2 (medium damage)  hit reaction animations in frames (5 per sec)
;		HitReactionLifeTimer3 = 1800 ; level 3 (heavy  damage)  hit reaction animations in frames (5 per sec)

;		HitReactionThreshold1 = 0.0   ; level 1 (light  damage) threshold trigger
;		HitReactionThreshold2 = 25.0  ; level 2 (medium damage) threshold trigger
;		HitReactionThreshold3 = 50.0  ; level 3 (heavy  damage) threshold trigger
;	End
 
	Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes

    Shadow = SHADOW_DECAL
    ShadowSizeX = 21;
    ShadowSizeY = 21;
    ShadowTexture = ShadowI;
End

Object IsengardOrcArcherHorde

  	; This is required for garrisoned objects - please put in all objects.
	ButtonImage = UIMordorArchers
	SelectPortrait         = UPMordorOrcArchers

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkMUArc
		End
	End
	
	Side = Isengard
	EditorSorting = UNIT
	EmotionRange = 240
	TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
	DisplayName = OBJECT:HordeMordorArchers
	DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorArcherHorde
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorArcherHorde
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY     MordorArcherMissileHordeRangefinder
		Weapon = TERTIARY	 MordorArcherMissileHordeRangefinderBombard
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT				; Not AI.
	End

; *** AUDIO Parameters ***;

	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members
	#include "..\..\..\includes\StandardHordeEvaEvents.inc"

	BuildCost = 225 ;150 ;MORDOR_ARCHER_BUILDCOST
	BuildTime = MORDOR_ARCHER_BUILDTIME 
	        
	VisionRange 		= MORDOR_ARCHER_HORDE_VISION_RANGE	
	ShroudClearingRange 	= MORDOR_ARCHER_SHROUD_RANGE

	VisionSide = 50%
	VisionRear = 25%
	
	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0%
	
	
	CrushableLevel 	= 0  			; What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel 	= 0 			; What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles 
	UseCrushAttack 	= No			; Archer hordes cannot crush or Bombard will not work
	CommandPoints 	= 60 ;;,;; 40 			; BALANCE, set up to just produce 2 hordes if 700 cp left    originally 60
	CommandSet 	= MordorArcherHordeCommandSet
		
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 2 ; Depth it occupies in formations. Current choices are 1 or 2.
	
	TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ORC ARCHER ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND ;UNATTACKABLE ORC
	
	ThreatLevel = MORDOR_ARCHER_HORDE_THREAT
	ThreatBreakdown MordorArcherHorde_DetailedThreat
		AIKindOf = ARCHER
	End
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	#include "..\..\..\includes\CaptureBuilding.inc"
	
	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle 	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        	= 500
		MaxCowerTime			= 5000
		MinCowerTime			= 3000
		CanAttackWhileContained    	= Yes  ; Can fire out of garrisoned building		
        AILuaEventsList				= InfantryFunctions
        AttackPriority				= AttackPriority_Archer
	End

	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle 		= 270
		FlankedDelay 		= 2000
		ObjectStatusOfContained = 
		InitialPayload 		= IsengardOrcArcher 20
		Slots 			= 20
		PassengerFilter 	= NONE +INFANTRY
		ShowPips 		= No

		; Banner Carrier info		
		BannerCarriersAllowed	= MordorBannerOrcNewSmall ;,; MordorBannerOrc		; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:IsengardOrcArcher		Pos:X:60.0 Y:0.0	; (DEFAULT) position of banner carrier for fighter horde
		
		RandomOffset		= X:5 Y:3	
		MeleeBehavior 		= Amoeba
		End
		
		RankInfo = RankNumber:1 UnitType:IsengardOrcArcher Position:X:50 Y:0		Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:IsengardOrcArcher Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		RankInfo = RankNumber:3 UnitType:IsengardOrcArcher Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		RankInfo = RankNumber:4 UnitType:IsengardOrcArcher Position:X:-10 Y:0 Leader 3 0	Position:X:-10 Y:20 Leader 3 1	Position:X:-10 Y:-20 Leader 3 2	Position:X:-10 Y:40 Leader 3 3	Position:X:-10 Y:-40 Leader 3 4 ;;,;; RankNumber corrected to 4 from 3
		
		;ComboHorde = Target:MordorFighterHorde Result:MordorFighterArcherComboHorde InitiateVoice:OrcArcherVoiceJoinAnybody
		;ComboHorde = Target:MordorPikemanHorde Result:MordorPikemenArcherComboHorde InitiateVoice:OrcArcherVoiceJoinAnybody
;		;ComboHorde = Target:MordorBlackOrcHorde Result:MordorBlackOrcArcherComboHorde InitiateVoice:OrcArcherVoiceJoinAnybody
		
		RanksToReleaseWhenAttacking = 1 2 3 4
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
		End
	
	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End

;;,;; Removed  
;	Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty 
;		;In order to sacrifice or be sacrificed, you must have a BloodthirstyUpdate
;		SacrificeFilter			= ALL		; Hordes with BloodthirstyUpdates I can sacrifice (hint: use template names)
;		ExperienceModifier		= 3.50 ;2.70 ;;,;; 1.95		; Balance this so that a level 1 orc horde eating a level 1 orc horde gets enough exp to get to level 2
;		InitiateVoice			= EVA:BloodthirstySacrificOfOrcs
;	End
	
 	;-----------------------------------------------------------------------------
	;	Brawl
	;-----------------------------------------------------------------------------
	Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty 
		;In order to sacrifice or be sacrificed, you must have a BloodthirstyUpdate
		SacrificeFilter			= ALL
		ExperienceModifier		= 3.50
		InitiateVoice			= EVA:BloodthirstySacrificOfOrcs
	End
	;-----------------------------------------------------------------------------
	
	Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus
		UpdateRate			= 1000
		HordeMemberFilter		= NONE +IsengardOrcFighter +IsengardOrcArcher
		Count				= 100
		Radius				= 200 ;160.0
		RubOffRadius			= 200 ;160.0
		AlliesOnly			= Yes
		AttributeModifier		= MordorLargeGroupBonus
	End
	
 	Behavior 		= EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		= INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	= 1000	; how often scan (milliseconds)
		TauntAndPointExcluded		= NONE
		AfraidOf			= EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			= EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				= EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		= 150
		FearScanDistance		= ARCHER_FEAR_SCAN_RADIUS ;250

		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		AddEmotion	=   	BraceForBeingCrushed_Base
		AddEmotion	=	UncontrollableFear_Base_Evil
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base
		AddEmotion	=	Taunt_Base	
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End		
	
	LocomotorSet
		Locomotor     = NormalRangedHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_MED_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_MordorBasicTraining
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_MordorFireArrows
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2		; Added for BFME Expansion
		TriggeredBy = Upgrade_MordorHeavyArmor				
	End	

	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly = Yes
		StuffToPickUp = NONE +CRATE
		ScanRange = 200
		ScanIntervalSeconds = 0.5
	End

	;///////////////////
	; AISpecialPowers
	;///////////////////
	
	Behavior = AISpecialPowerUpdate MordorArcherHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End
	
	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End

	
	Geometry 		= BOX
	GeometryMajorRadius 	= 40.0
	GeometryMinorRadius 	= 50.0
	GeometryHeight 		= 20.0
	GeometryIsSmall 	= No
	
	
	// *** AUTO RESOLVE DATA *** 
	AutoResolveUnitType = AutoResolveUnit_Archer
	AutoResolveCombatChain = AutoResolve_ArcherCombatChain
	
	AutoResolveBody = AutoResolve_MordorArcherHordeBody

	AutoResolveArmor
		Armor = AutoResolve_MordorArcherArmor
	End

	AutoResolveWeapon
		RequiredUpgrades = Upgrade_MordorFireArrows
		Weapon = AutoResolve_BasicArcherWeakUpgradedWeapon
	End

	AutoResolveWeapon
		ExcludedUpgrades = Upgrade_MordorFireArrows
		Weapon = AutoResolve_BasicArcherWeakWeapon
	End
	
	WorldMapArmoryUpgradesAllowed = Upgrade_MordorBasicTraining Upgrade_MordorFireArrows
End

ChildObject IsengardOrcArcher_Patrol IsengardOrcArcher
	; *** ART Parameters ***

	; This is required for garrisoned objects - please put in all objects.
	ButtonImage = UIMordorArchers
	SelectPortrait         = UPMordorOrcArchers
;	UpgradeCameo1           = Upgrade_FireArrows

	Draw = W3DHordeModelDraw ModuleTag_01

		OkToChangeModelColor = Yes
		StaticModelLODMode = Yes
		ParticlesAttachedToAnimatedBones = yes

		; specify options for static LODs
		LodOptions	= LOW
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_LOW
			MaxRandomTextures		=	2
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_LOW
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_LOW
		End
	
		LodOptions	= MEDIUM
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_MED
			MaxRandomTextures		=	2
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_MED
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_MED
		End
		
		LodOptions	= HIGH
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_HIGH
			MaxRandomTextures		=	3
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_HIGH
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_HIGH
		End

;		RandomTexture = muorc1.tga 0 muorc1.tga
;		RandomTexture = muorc3.tga 0 muorc1.tga
;		RandomTexture = muorcheads.tga 0 muorcheads.tga
;		RandomTexture = muorchelms1.tga 0 muorchelms1.tga

;========= WITH BOW

        DefaultModelConditionState
            Model                        = iuorcarch_skn
            Skeleton                    = MUOrcArchr_SKL
            WeaponLaunchBone            = PRIMARY ARRROW
        End
    
;========= WITH BOW UPGRADE

        ModelConditionState            WEAPONSET_PLAYER_UPGRADE
            Model                        = iuorcarch_skn
            Skeleton                    = MUOrcArchr_SKL
            WeaponLaunchBone            = PRIMARY ARRROW
            ;ParticleSysBone                = arrowFire arrowFire FollowBone:Yes
        End

;========= DEFAULT IDLE ANIMATIONS

		IdleAnimationState
			StateName = STATE_Idle
				Animation = IDLA
				AnimationName		= MUOrcArchr_IDLA
				AnimationMode		= ONCE
				AnimationPriority	= 6
				AnimationSpeedFactorRange = 0.8 1.2
				AnimationBlendTime  = 15
			End
			;*** Repeat IDLA because animation priorities will not choose same animation twice so it can alternate between first two mostly.
			StateName = STATE_Idle
				Animation = IDLA
				AnimationName		= MUOrcArchr_IDLA
				AnimationMode		= ONCE
				AnimationPriority	= 6
				AnimationSpeedFactorRange = 0.8 1.2
				AnimationBlendTime  = 15
			End
			Animation = IDLC
				AnimationName		= MUOrcArchr_IDLC
				AnimationMode		= ONCE
				AnimationPriority	= 1
				AnimationSpeedFactorRange = 0.8 1.2
				AnimationBlendTime  = 15
			End
			Animation = IDLD
				AnimationName		= MUOrcArchr_IDLD
				AnimationMode		= ONCE
				AnimationPriority	= 1
				AnimationSpeedFactorRange = 0.8 1.2
				AnimationBlendTime  = 15
			End
;			Animation = IDLE
;				AnimationName		= MUOrcArchr_IDLE
;				AnimationMode		= ONCE
;				AnimationPriority	= 1
;				AnimationSpeedFactorRange = 0.8 1.2
;				AnimationBlendTime  = 15
;			End
;			Animation = IDLF
;				AnimationName		= MUOrcArchr_IDLF
;				AnimationMode		= ONCE
;				AnimationPriority	= 1
;				AnimationSpeedFactorRange = 0.8 1.2
;				AnimationBlendTime  = 15
;			End
			BeginScript
				CurDrawableShowSubObject("arrownock") ;Circumvents blend issues when the arrow is being shown...

				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected"	then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") return end
			EndScript
		End
 
;========= PASSENGER ANIMS
    AnimationState						= PASSENGER EATING
		Animation						= being_eaten
			AnimationName				= MUOrcArchr_EATA
			AnimationMode				= ONCE
		End
    End
 
    AnimationState						= PASSENGER
		Animation						= Wiggling
			AnimationName				= MUOrcArchr_FLLA
			AnimationMode				= LOOP
		End
    End

    AnimationState						= THROWN_PROJECTILE
		Animation						= Thrown
			AnimationName				= MUOrcArchr_FLYA
			AnimationMode				= LOOP
		End
    End

;========= FLYING THROUGH AIR

	AnimationState						= FREEFALL
		Animation						= Flying_1
			AnimationName				= MUORCARCHR_FLYA
			AnimationMode				= LOOP
			AnimationSpeedFactorRange	= 0.5	0.5
			AnimationBlendTime			= 10
		End
    End
 
;========= STUNNED ANIMS

    AnimationState = STUNNED_FLAILING
 		Animation = Flying
			AnimationName = MUOrcArchr_FLYA
			AnimationMode = LOOP
			AnimationSpeedFactorRange	= 0.4 0.6
		End
		Flags = RANDOMSTART
    End
    
    ;========= DYING

		AnimationState			= DYING BURNINGDEATH
			Animation
				AnimationName	= MUOrcArchr_DIEA
				AnimationMode	= ONCE
				AnimationBlendTime = 10
			End
			Animation
				AnimationName	= MUOrcArchr_DIEB
				AnimationMode	= ONCE
				AnimationBlendTime = 10
			End
			Animation
				AnimationName	= MUOrcArchr_DIEC
				AnimationMode	= ONCE
				AnimationBlendTime = 10
			End
			Animation
				AnimationName	= MUOrcArchr_DIED
				AnimationMode	= ONCE
				AnimationBlendTime = 10
			End
		End

    ; smashed
    AnimationState						= USER_1 DYING
		Animation						= Moving
			AnimationName				= MUOrcArchr_DIEC
			AnimationMode				= ONCE
		End
    End
    
    AnimationState						= DYING SPLATTED
 		Animation						= Splattered_On_Ground
			AnimationName				= MUOrcArchr_LNDA
			AnimationMode				= ONCE
		End
		EnteringStateFX					= FX_OrcHitGround
    End

    AnimationState = DYING AFLAME
 		Animation = Flaming_Death
			AnimationName = MUOrcArchr_MFDA
			AnimationMode = LOOP
		End
		Animation = Flaming_Death2
			AnimationName = MUOrcArchr_MFDB
			AnimationMode = LOOP
		End
    End

    AnimationState = DYING
 		Animation = Dying1
			AnimationName = MUOrcArchr_DIEA
			AnimationMode = ONCE
			AnimationPriority = 20
		End
		Animation = Dying2
			AnimationName = MUOrcArchr_DIEB
			AnimationMode = ONCE
			AnimationPriority = 1
		End
		Animation = Dying3
			AnimationName = MUOrcArchr_DIEC
			AnimationMode = ONCE
			AnimationPriority = 5
		End
		Animation = Dying4
			AnimationName = MUOrcArchr_DIED
			AnimationMode = ONCE
			AnimationPriority = 15
		End
    End
    
		AnimationState			= BURNINGDEATH
			Animation
				AnimationName	= MUOrcArchr_MFDB
				AnimationMode	= LOOP
				Distance		= 30
			End
		End

	AnimationState						= PARALYZED
		Animation
			AnimationName				= MUOrcArchr_IDLA
			AnimationMode				= LOOP
		End
	End

    ;========= STUNNED ANIMS

    AnimationState = STUNNED_STANDING_UP
 		Animation = Standing_Back_Up
			AnimationName = MUOrcArchr_GTPA
			AnimationMode = ONCE
			AnimationSpeedFactorRange = 1.5 1.5
		End
    End
    
    AnimationState = STUNNED
 		Animation = Splattered_On_Ground
			AnimationName = MUOrcArchr_LNDA
			AnimationMode = ONCE
		End
		EnteringStateFX = FX_OrcHitGround
    End


 


;========= CLIMBING

	AnimationState				= MOVING CLIMBING BACKING_UP
		Animation				= ClimbingDown
			AnimationName		= MUOrcArchr_CLMA
			AnimationMode		= LOOP_BACKWARDS
		End
    End

	AnimationState				= MOVING CLIMBING
		Animation				= ClimbingUp
			AnimationName		= MUOrcArchr_CLMA
			AnimationMode		= LOOP
		End
    End

;========= TERROR

	AnimationState					= MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
		ShareAnimation = Yes
		Animation					= TerrorFromTheSky
			AnimationName			= MUOrcArchr_RUNG
			AnimationMode			= LOOP
		End
	End
	AnimationState					= MOVING EMOTION_TERROR
		ShareAnimation = Yes
		Animation					= Terror
			AnimationName			= MUOrcArchr_RUNF
			AnimationMode			= LOOP
		End
	End

;========= BACKING UP

	AnimationState = MOVING BACKING_UP
		ShareAnimation = Yes
		;Animation = Backing_Up_1
		;	AnimationName = MUOrcArchr_BAKA
		;	AnimationMode = LOOP
		;End
 		;Animation = Backing_Up_2
		;	AnimationName = MUOrcArchr_BAKB
		;	AnimationMode = LOOP
		;End
 		Animation = Backing_Up_3
			AnimationName = MUOrcArchr_BAKC
			AnimationMode = LOOP
		End
	End    
       
;========= MOVING

	AnimationState					=	MOVING WANDER
		ShareAnimation = Yes
		Animation					=	Wander1
			AnimationName			=	MUOrcArchr_WLKA 
		End
		Animation					=	Wander2
			AnimationName			=	MUOrcArchr_WLKB ;20
		End
		Flags						=	RANDOMSTART
	End

	AnimationState = MOVING
		ShareAnimation = Yes
		Animation = Moving
			AnimationName = MUOrcArchr_WLKA
			AnimationMode = LOOP
		End
		Animation = Moving
			AnimationName = MUOrcArchr_WLKB
			AnimationMode = LOOP
		End
		BeginScript
			CurDrawableShowSubObject("arrownock") ;Circumvents blend issues when the arrow is being shown...
		EndScript
	End
	
	
	AnimationState					=	FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
  		Animation					=	BowPunchWhenClose
  			AnimationName			=	MUOrcArchr_ATKD 
  			AnimationMode			=	ONCE
  			UseWeaponTiming			=	Yes
  		End
 		BeginScript
			CurDrawableHideSubObject("arrow") ;Circumvents blend issues when the arrow is being shown...
		EndScript
 	End
	

;========= NEW STYLE ARCHERY 

	AnimationState					=	PREATTACK_A 
		StateName					=	STATE_PreFiring
		Animation					=	ReadyToDrawn
			AnimationName			=	MUOrcArchr_ATA1
			AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
			AnimationBlendTime		=	10
		End
	End

	AnimationState					=	FIRING_OR_RELOADING_A 
		StateName					=	STATE_Firing
		Animation					=	OneFrameOfShooting
			AnimationName			=	MUOrcArchr_ATA2
			AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; Left in as reminder why not to use: UseWeaponTiming does not work for archers. Do not attempt to use this!
			AnimationSpeedFactorRange = 1.1 1.1			; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
			AnimationBlendTime		=	0				; Blend time needs to be zero or else the arrow subobject lingers length of blend.
		End
	End

	AnimationState					=	PREATTACK_C 
		StateName					=	STATE_PreFiring
		Animation					=	ReadyToDrawn
			AnimationName			=	MUOrcArchr_ATA1
			AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
			AnimationBlendTime		=	10
		End
	End

	AnimationState					=	FIRING_OR_RELOADING_C
		StateName					=	STATE_Firing
		Animation					=	OneFrameOfShooting
			AnimationName			=	MUOrcArchr_ATA2
			AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; Left in as reminder why not to use: UseWeaponTiming does not work for archers. Do not attempt to use this!
			AnimationSpeedFactorRange = 1.1 1.1			; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
			AnimationBlendTime		=	0				; Blend time needs to be zero or else the arrow subobject lingers length of blend.
		End
	End

;========= PERSISTANT FIRING (KEEP BOW DRAWN )

	AnimationState					= CONTINUOUS_FIRE_MEAN
		StateName					=	STATE_Coasting
		Animation					=	HangFrameWhileCoasting
			AnimationName			=	MUOrcArchr_ATA2
			AnimationMode			=	MANUAL
		End
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "STATE_Firing" then CurDrawableAllowToContinue() return end
		EndScript
	End
	
	AnimationState					= CONTINUOUS_FIRE_SLOW
		StateName					= STATE_Idle
		Animation					= PutAwayArrow
			AnimationName			= MUOrcArchr_ATA3
			AnimationMode			= ONCE
		End
	End

;========= HIT REACTION

	AnimationState = HIT_REACTION
		Animation = Hit_Level_1_a
			AnimationName = MUOrcArchr_HITA
			AnimationMode = ONCE
		End
	End
	
;========= WAR CHANT 

	AnimationState = WAR_CHANT
;		Animation = Chant
;			AnimationName = MUOrcArchr_TNTA ; This looks bad here.
;			AnimationMode = ONCE
;		End
		Animation					= TauntingA
			AnimationName			= MUOrcArchr_TNTA
			AnimationMode			= ONCE
		End
		Animation					= TauntingB
			AnimationName			= MUOrcArchr_TNTB
			AnimationMode			= ONCE
		End
		Animation					= TauntingC
			AnimationName			= MUOrcArchr_TNTC
			AnimationMode			= ONCE
		End
		Animation					= TauntingD
			AnimationName			= MUOrcArchr_TNTD
			AnimationMode			= ONCE
		End	
		Flags						= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
	End

;========= EMOTIONS ===================================
		
;;======= TERROR

		AnimationState							= EMOTION_AFRAID
			ShareAnimation						= Yes
			Animation							= FERA
				AnimationName					= MUOrcArchr_FERA
				AnimationMode					= LOOP
			End
			Animation							= FERB
				AnimationName					= MUOrcArchr_FERB
				AnimationMode					= LOOP
			End
			Animation							= FERC
				AnimationName					= MUOrcArchr_FERC
				AnimationMode					= LOOP
			End
		End	

;;======= TAUNTING

		AnimationState							= EMOTION_TAUNTING
			Animation							= TNTA
				AnimationName					= MUOrcArchr_TNTA
				AnimationMode					= ONCE
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Animation							= TNTB
				AnimationName					= MUOrcArchr_TNTB
				AnimationMode					= ONCE
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Animation							= TNTC
				AnimationName					= MUOrcArchr_TNTC
				AnimationMode					= ONCE
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Animation							= TNTD
				AnimationName					= MUOrcArchr_TNTD
				AnimationMode					= ONCE
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Flags								= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
		End
		
;;======= POINTING

		AnimationState							= EMOTION_POINTING
			Animation							= Pointing1
				AnimationName					= MUOrcArchr_PNTA
				AnimationMode					= LOOP
			End
		End

;;======= CELEBRATING
		AnimationState							= EMOTION_CELEBRATING
			Animation							= CHRA1
				AnimationName					= MUOrcArchr_CHRA
				AnimationMode					= Once
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Animation							= CHRA2
				AnimationName					= MUOrcArchr_CHRB
				AnimationMode					= Once
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Animation							= CHRA3
				AnimationName					= MUOrcArchr_CHRC
				AnimationMode					= Once
				AnimationSpeedFactorRange		= 0.8 1.2
			End
			Flags								= RESTART_ANIM_WHEN_COMPLETE
		End
	
;;======= ALERT

		AnimationState							= EMOTION_ALERT
			Animation							= ALERT
				AnimationName					= MUOrcArchr_IDLB
				AnimationMode					= LOOP
			End
			Flags								= RANDOMSTART
		End

		AnimationState							= RAISING_FLAG
			Animation							= CHRA1
				AnimationName					= MUOrcArchr_CHRA
				AnimationMode					= Once
				AnimationSpeedFactorRange		= 0.9 1.1
			End
			Animation							= CHRA2
				AnimationName					= MUOrcArchr_CHRB
				AnimationMode					= Once
				AnimationSpeedFactorRange		= 0.9 1.1
			End
			Animation							= CHRA3
				AnimationName					= MUOrcArchr_CHRC
				AnimationMode					= Once
				AnimationSpeedFactorRange		= 0.9 1.1
			End
			Flags								= RESTART_ANIM_WHEN_COMPLETE
		End


;;======= SELECTED

		AnimationState = SELECTED
			StateName			= STATE_Selected
 			Animation			= Selected
				AnimationName	= MUOrcArchr_ATNB
				AnimationMode	= LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle"	then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") return end
			EndScript
		End

;;======= TRANSITIONS

		TransitionState = TRANS_Idle_to_Selected
			Animation			= Salute
				AnimationName	= MUOrcArchr_ATNA
				AnimationMode	= ONCE
			End		
		End
		
		TransitionState = TRANS_Selected_to_Idle
			Animation			= ATNC
				AnimationName	= MUOrcArchr_ATNC
				AnimationMode	= ONCE
			End		
		End		
	End
	CommandPoints = 0
	EquivalentTo = MordorArcher

	WeaponSet
		Conditions 	= None 
		Weapon 		= PRIMARY    IsengadOrcArcherBow_P
		Weapon 		= TERTIARY   IsengadOrcArcherBow_P
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT			; Not from AI.
	End

	;------------- Fire arrow upgrade ----------------
	Behavior 		= WeaponSetUpgrade ModuleTag_Fire
		TriggeredBy 	= Upgrade_TechnologyIsengardFireArrows
	End

  	Behavior 		= SubObjectsUpgrade FireArrows_Upgrade
  		TriggeredBy	= Upgrade_TechnologyIsengardFireArrows
  		ShowSubObjects	= FIREAROWTIP
  		HideSubObjects	= arrrow			; yes, it's a typo.
  	End

	Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 100.0
		GuardWanderRange	= 100.0
		DieOnMastersDeath		= Yes
		MarkUnselectable		= Yes
	End
  	

	LocomotorSet
		Locomotor = PatrolLocomotor ; HumanLocomotor
		Condition = SET_NORMAL 
		Speed     = 16 ;NORMAL_FOOT_MED_MEMBER_SPEED
	End

	LocomotorSet
		Locomotor = BurningDeathLocomotorInfantry
		Condition = SET_BURNINGDEATH
		Speed	  = BURNINGDEATH_WANDERSPEED_INFANTRY
	End
End

ChildObject IsengardOrcArcherFloatingBuilding_Slaved IsengardOrcArcher

	; make sure we can see all round.
	VisionSide			= 100%
	VisionRear			= 100%
	ShroudClearingRange	= 300
	ShockwaveResistance	= SHOCKWAVE_RESISTANCE_ALWAYS

	LocomotorSet
		Locomotor   = FloatingHumanLocomotor
		Condition   = SET_NORMAL
		Speed       = 0
	End

	WeaponSet
		Conditions 	= None 
		Weapon 		= PRIMARY    IsengadOrcArcherBow_P
		Weapon 		= TERTIARY   IsengadOrcArcherBow_P
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT			; Not from AI.
	End

	;------------- Fire arrow upgrade ----------------
	Behavior 		= WeaponSetUpgrade ModuleTag_Fire
		TriggeredBy 	= Upgrade_TechnologyIsengardFireArrows
	End

  	Behavior 		= SubObjectsUpgrade FireArrows_Upgrade
  		TriggeredBy	= Upgrade_TechnologyIsengardFireArrows
  		ShowSubObjects	= FIREAROWTIP
  		HideSubObjects	= arrrow			; yes, it's a typo.
  	End

	;//These guys are stuck in the barricade can't move and can't be attacked
	KindOf =  UNATTACKABLE NOT_AUTOACQUIRABLE
	
	VoiceCreated							= NoVoice
	VoiceFullyCreated 						= NoVoice

	Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 0
		GuardWanderRange	= 0
		UseSlaverAsControlForEvaObjectSightedEvents = No ; Not a creep
		DieOnMastersDeath	= Yes
		MarkUnselectable	= No
	End
	
	Behavior = SlowDeathBehavior ModuleTag_05				; overriden to be faster, so we fall with the barricade rubble.
		DeathTypes			= ALL -KNOCKBACK
		SinkDelay			= 10
		SinkRate			= 1.50							; in Dist/Sec
		DestructionDelay	= 10000
		Sound				= INITIAL OrcVoiceDie
	End

End