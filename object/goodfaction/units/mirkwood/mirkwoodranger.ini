; Moved from ElvenInfantry.INI Aug 24 2005
;------------------------------------------------------------------------------
;Creating this elf will randomize between several variations of the elf.
;------------------------------------------------------------------------------
Object MirkwoodRanger

	SelectPortrait	= UPMirkwoodRangers

	Draw = W3DScriptedModelDraw ModuleTag_01  
		DefaultModelConditionState
			;Give it a model so it'll show up in WB
			Model               = tumirkarch_m  ;eugrnwdrngr_m1
		End
	End

	;***** IMPORTANT NOTE! ***************************************************************	
	;Certain Upgrades and costs may need to be propagated from here. One example was veterancy
	;overlays.
	;*************************************************************************************	
	DisplayName = OBJECT:MirkwoodRanger
	Side = Mirkwood
	EditorSorting = UNIT
	BuildVariations = MirkwoodRanger1 MirkwoodRanger2
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT SWARM_DOZER GRAB_AND_DROP DOZER 
	
  ;Shadow = SHADOW_DECAL
  ;ShadowSizeX = 24;
  ;ShadowSizeY = 24;
  ;ShadowTexture = ShadowI;

End

;------------------------------------------------------------------------------
Object MirkwoodRanger_Patrol

	SelectPortrait	= UPMirkwoodRangers

	Draw = W3DScriptedModelDraw ModuleTag_01  
		DefaultModelConditionState
			;Give it a model so it'll show up in WB
			Model               = tumirkarch_m  ;eugrnwdrngr_m1
		End
	End

	;***** IMPORTANT NOTE! ***************************************************************	
	;Certain Upgrades and costs may need to be propagated from here. One example was veterancy
	;overlays.
	;*************************************************************************************	

	Side = Mirkwood
	EditorSorting = UNIT
	BuildVariations = MirkwoodRanger1_Patrol MirkwoodRanger2_Patrol
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT SWARM_DOZER GRAB_AND_DROP DOZER 
	
  ;Shadow = SHADOW_DECAL
  ;ShadowSizeX = 24;
  ;ShadowSizeY = 24;
  ;ShadowTexture = ShadowI;

End

; aka Elven Mirkwood Archer
Object MirkwoodRanger1
	Scale = 1.07
	; *** ART Parameters ***
	UpgradeCameo1						=	Upgrade_RohanFireArrows	
	SelectPortrait						=	UPMirkwoodRangers
	ButtonImage							=	UIMirkwoodRangers
	
	Draw	=	W3DHordeModelDraw ModuleTag_01

		OkToChangeModelColor = Yes
	  
		;	---Test entry for the time of day texture swap test---
		;	TimeOfDayTexture = twwater01.tga AFTERNOON 0 ROHANWARRIOR01
			
		;	RandomTexture = guarcher.tga 0
		;	RandomTexture = twwater01.tga 0
		;	RandomTexture = rbgen01.tga 0

		StaticModelLODMode = no ; Will append M or L to the skin name depending on GameLOD

		ParticlesAttachedToAnimatedBones = yes

; --------- With Bow ------------
		DefaultModelConditionState
			Model						=	tumirkarch_m
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	SECONDARY ARROWNOCK	; when upgraded to flaming arrow
			WeaponLaunchBone			=	TERTIARY ARROW
			ParticleSysBone				=	NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
		End
		
; --------- With Bow Upgrade  ------------

		ModelConditionState				=	WEAPONSET_PLAYER_UPGRADE INVISIBLE_STEALTH
			Model						=	tumirkarch_m
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	SECONDARY ARROWNOCK	; when upgraded to flaming arrow
			WeaponLaunchBone			=	TERTIARY ARROW
			ParticleSysBone				=	NONE Predator FollowBone:Yes Persist:SPAWN PersistID:100
		End

		ModelConditionState				=	INVISIBLE_STEALTH
			ParticleSysBone				=	NONE Predator FollowBone:Yes Persist:SPAWN PersistID:100
		End

		ModelConditionState				=	WEAPONSET_PLAYER_UPGRADE
			Model						=	tumirkarch_m
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	SECONDARY ARROWNOCK	; when upgraded to flaming arrow
			WeaponLaunchBone			=	TERTIARY ARROW
			ParticleSysBone				=	NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
		End
		
		ModelConditionState				=	RIDER5
			Model						=	tumirkarch_mHA
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	SECONDARY ARROWNOCK	; when upgraded to flaming arrow
			WeaponLaunchBone			=	TERTIARY ARROW
			; ParticleSysBone				=	NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
		End
		
;----------- Default Idle animations -------
		IdleAnimationState
			StateName					=   STATE_Idle
			Animation = IdleA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			;*** Repeat IDLA because animation priorities will not choose same animation twice so it can alternate between first two mostly.
			Animation = IdleA	
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleH
				AnimationName			=	GUArcher_IDLH
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleI
				AnimationName			=	GUArcher_IDLI
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleJ
				AnimationName			=	GUArcher_IDLJ
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
			EndScript
		End
		
;----------- Flying through air -------
		AnimationState						= PASSENGER
			Animation						= FLLA
				AnimationName				= GUArcher_FLLA
				AnimationMode				= LOOP
			End
		End
		
		
		AnimationState        = THROWN_PROJECTILE
			Animation           = FLYA
				AnimationName     = GUArcher_FLYA
				AnimationMode     = LOOP
			End
		End
		
		AnimationState						= FREEFALL
			Animation						= Falling
				AnimationName				= GUArcher_FLYA
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
				AnimationSpeedFactorRange	= 0.35	0.35
			End
		End
		
		AnimationState					=	STUNNED_FLAILING 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_FLLA 
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End
		
		

;----------- Dying -------
	AnimationState				=	DYING DEATH_2
		Animation
			AnimationName				= GUArcher_IDLA
			AnimationMode				= LOOP
		End
	End
		AnimationState					= DYING BURNINGDEATH
			Animation
				AnimationName			= GUArcher_DIEB
				AnimationMode			= ONCE
				AnimationBlendTime		= 10
			End
			Animation
				AnimationName			= GUArcher_DIED
				AnimationMode			= ONCE
				AnimationBlendTime		= 10
			End
		End
		
		AnimationState					=	DYING SPLATTED
			Animation					=	Fire
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
            EnteringStateFX = FX_SoldierHitGround
		End

		AnimationState					=	DYING AFLAME
			Animation					=	Fire
				AnimationName			=	GUArcher_MFDA 
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					=	Fire
				AnimationName			=	GUArcher_MFDB 
				AnimationSpeedFactorRange = 0.9 1.1
			End
		End
		AnimationState					=	DYING
			Animation					=	Die2
				AnimationName			=	GUArcher_DIEB 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation					=	Die3
				AnimationName			=	GUArcher_DIED 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End
	AnimationState						= PARALYZED
		Animation
			AnimationName				= GUArcher_IDLA
			AnimationMode				= LOOP
		End
	End
	AnimationState						= BURNINGDEATH
		Animation
			AnimationName				= GUArcher_MFDA
			AnimationMode				= Loop
			Distance					= 65
		End
	End

;------ Stunned anims -----------
		AnimationState					=	STUNNED_STANDING_UP 
			Animation					=	GTPA
				AnimationName			=	GUArcher_GTPA
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End

		

		AnimationState					=	STUNNED 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
			End
            EnteringStateFX = FX_SoldierHitGround
		End

;------- Close range melee fighting ------------
		AnimationState					=	FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
			Animation					=	ATKD
				AnimationName			=	GUArcher_ATKD
				AnimationMode			=	ONCE
				UseWeaponTiming			=	Yes
			End
		End

;------- New Style Archery --------------------------------------------
		AnimationState					=	PREATTACK_A 
			StateName					=	STATE_Firing
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_A 
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; Left in as reminder why not to use: UseWeaponTiming does not work for archers. Do not attempt to use this!
				AnimationSpeedFactorRange = 1.1 1.1			; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0				; Blend time needs to be zero or else the arrow subobject lingers length of blend.
			End
		End

		AnimationState					=	PREATTACK_C
			StateName					=	STATE_Firing
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_C
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; Left in as reminder why not to use: UseWeaponTiming does not work for archers. Do not attempt to use this!
				AnimationSpeedFactorRange = 1.1 1.1			; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0				; Blend time needs to be zero or else the arrow subobject lingers length of blend.
			End
		End

	
;;========= TERROR
		AnimationState					= MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
			Animation					= TerrorFromTheSky
				AnimationName			= GUArcher_RUNC
				AnimationMode			= LOOP
			End
		End

;;========= BACKING UP
		AnimationState				=	MOVING BACKING_UP
			Animation				=	BackingUp
				AnimationName		=	GUArcher_BAKA
				AnimationMode		=	LOOP
			End
			Flags					=	RANDOMSTART
		End

;;========= MOVING

		AnimationState					=	MOVING ATTACKING
			Animation					=	AMove
				AnimationName			=	GUArcher_RUNB 
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End
		
		AnimationState					=	MOVING WANDER
			Animation					=	Wander1
				AnimationName			=	GUArcher_WLKA 
			End
			Animation					=	Wander2
				AnimationName			=	GUArcher_WLKB ;20
			End
			Flags						=	RANDOMSTART
		End

		AnimationState					=	MOVING
			Animation					=	Move
				AnimationName			=	GUArcher_RUNA 
				AnimationMode			=	LOOP
			End
			Animation					=	MoveB
				AnimationName			=	GUArcher_RUNB 
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End

;-------- Persistant firing (keep bow drawn ) ------------
		AnimationState					= CONTINUOUS_FIRE_MEAN
			StateName					=	STATE_Firing
			Animation					=	HangFrameWhileCoasting
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	MANUAL
			End
		End
		
		AnimationState						= CONTINUOUS_FIRE_SLOW
			StateName						= STATE_Idle
			Animation						= PutAwayArrow
				AnimationName				= GUArcher_ATKF3
				AnimationMode				= ONCE
			End
		End
		
;------------ HIT REACTION -----------------------------------------------------
		AnimationState = HIT_REACTION
			Animation = Hit_Level_1_a
				AnimationName = GUArcher_HITA
				AnimationMode = ONCE
			End
		End
		
;--------------------- EMOTIONS -----------------------------

;;======= TERROR

		AnimationState					= EMOTION_AFRAID
			Animation					= FERA
				AnimationName			= GUArcher_FERA
				AnimationMode			= LOOP
			End
			Animation					= FERB
				AnimationName			= GUArcher_FERB
				AnimationMode			= LOOP
			End
			Animation					= FERC
				AnimationName			= GUArcher_FERC
				AnimationMode			= LOOP
			End
			Animation					= FERD
				AnimationName			= GUArcher_FERD
				AnimationMode			= LOOP
			End
		End
		
;;======= CELEBRATING

		AnimationState					= EMOTION_CELEBRATING
			Animation					= CHRB
				AnimationName			= GUArcher_CHRB
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= SLTA
				AnimationName			= GUArcher_SLTA
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= CHRA
				AnimationName			= GUArcher_CHRA
				AnimationMode			= Once
				AnimationBlendTime		= 15		
				AnimationPriority		= 1;Use least often of cheers (Eugene)
			End
			Flags						=	RESTART_ANIM_WHEN_COMPLETE
		End
		
;;======== TAUNTING

		AnimationState					= EMOTION_TAUNTING
			Animation					= Taunting2
				AnimationName			= GUArcher_IDLE
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting3
				AnimationName			= GUArcher_IDLF
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting4
				AnimationName			= GUArcher_IDLG
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End

			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End

;;======== POINTING

		AnimationState						= EMOTION_POINTING
			ShareAnimation					= Yes
			Animation						= pointing
				AnimationName				= GUArcher_PNTA
				AnimationPriority			= 2
				AnimationSpeedFactorRange	= 0.9 1.1
				AnimationMode				= LOOP
			End
		End
		

;;======== ALERT
		
		AnimationState					= EMOTION_ALERT
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Point
				AnimationName			= GUArcher_PNTA
				AnimationMode			= LOOP
				AnimationPriority		= 1
				AnimationBlendTime		= 15
			End
		End

; Turn off fire arrow visuals -- will be redone like Peasant drafting.
;;----------------- FIRE ARROW UPGRADE --------------------------------------------
		AnimationState        =  USER_4 ;Fire arrow upgrade
			Animation = IdleB
				AnimationName			=	GUArcher_IDLB 
				AnimationPriority		=	2 ;10
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleC
				AnimationName			=	GUArcher_IDLC
				AnimationPriority		=	1 ;5
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleD
				AnimationName			=	GUArcher_IDLD
				AnimationPriority		=	1 ;5
				AnimationSpeedFactorRange = 0.7 1.3
			End
			BeginScript
				CurDrawableShowSubObject("ArrowNock")
				CurDrawableShowSubObject("FireArowTip")
			EndScript
			StateName           = Bow
		End

		AnimationState					= RAISING_FLAG
			Animation					= CHRB
				AnimationName			= GUArcher_CHRB
				AnimationMode			= Once
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					= SLTA
				AnimationName			= GUArcher_SLTA
				AnimationMode			= Once
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					= CHRA
				AnimationName			= GUArcher_CHRA
				AnimationMode			= Once
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Flags						=	RESTART_ANIM_WHEN_COMPLETE
		End

;;----------------- SELECTED --------------------------------------------
		AnimationState					=	SELECTED
			StateName					=	STATE_Selected
			Animation					=	ATNB
				AnimationName			=	GUArcher_ATNB
				AnimationMode			=	LOOP
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					=	IDLA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	10
				AnimationSpeedFactorRange = 0.7 1.3
			End

			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" 
				then 
					CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") 
				end
				if CurDrawableModelcondition("ATTACKING")
				then
					return "IDLA"
				else
					return "ATNB"
				end
			EndScript
		End
		
	
;;----------------- Transitions ------------------------------------------------------
		TransitionState					=	TRANS_Idle_to_Selected
			Animation					=	ATNA
				AnimationName			=	GUArcher_ATNA
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.8 1.2
			End
		End
		TransitionState					=	TRANS_Selected_To_Idle
			Animation					=	ATNC
				AnimationName			=	GUArcher_ATNC
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 1.0 2.0 ;Kind of a slow animation
			End
		End
	End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"

	; ***DESIGN parameters ***
	Side 		= Mirkwood
	EditorSorting 	= UNIT
	ThreatLevel 	= 1.0
	ThingClass 	= HORDE_UNIT
	CommandPoints 	= 4 ;8		; originally 4
	
	CommandSet = ElvenMirkwoodArcherCommandSet

	TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT
	WeaponSet
		Conditions = None 
		Weapon 			= PRIMARY    MirkwoodRangerBow
		Weapon 			= TERTIARY   MirkwoodRangerBowBombard
		Weapon = QUINARY	SilvanRangerThornedBarbs   ;DwarvenMenOfDaleBlackArrows
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT				; Not AI.
		AutoChooseSources = QUINARY FROM_PLAYER FROM_SCRIPT ; not from ai
	End
	WeaponSet
		Conditions = CLOSE_RANGE CONTESTING_BUILDING
		Weapon = PRIMARY   RohanArcherBowMelee
		Weapon = TERTIARY  MirkwoodRangerBowBombard ;MirkwoodArcherBowBombard
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT				; Not AI.
	End

	ArmorSet
		Conditions      = None
		Armor           = MirkwoodArcherArmor
		DamageFX        = NormalDamageFX
	End
	
	ArmorSet
		Conditions		= PLAYER_UPGRADE
		Armor			= MirkwoodArcherHeavyArmor
		DamageFX		= NormalDamageFX
	End
	
	BountyValue = 5 ;ELVEN_MIRKWOOD_ARCHER_BOUNTY_VALUE

	VisionRange = ELVEN_LORIENARCHER_VISION_RANGE
	VisionSide = 35%
	VisionRear = 25%
	VisionBonusPercentPerFoot = 5.0%
	ShroudClearingRange = SHROUD_CLEAR_STANDARD			

	DisplayName = OBJECT:MirkwoodRanger
	CrushableLevel = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrushRevengeWeapon = RangedInfantryCrushRevenge
	

	; *** AUDIO Parameters ***;

	VoiceAttack 								= MSilElvesVoiceAttackRanged
	VoiceAttackAir								= MSilElvesVoiceAttackRanged
	VoiceAttackCharge 							= MSilElvesVoiceAttackCharge
	VoiceAttackMachine 							= MSilElvesVoiceAttackRanged
	VoiceAttackStructure 						= MSilElvesVoiceAttackBuilding
	VoiceCreated 								= MSilElvesVoiceSaluteRanged
	VoiceFullyCreated							= MSilElvesVoiceSaluteRanged
	VoiceGuard									= MSilElvesVoiceMove
	VoiceMove 									= MSilElvesVoiceMove
	VoiceMoveToCamp 							= MSilElvesVoiceMoveCamp
	;VoiceMoveToHigherGround						= MSilElvesVoiceMoveHighGround
	VoiceMoveWhileAttacking 					= MSilElvesVoiceDisengage
	VoicePriority								= 24
	VoiceRetreatToCastle 						= MSilElvesVoiceRetreat
	VoiceSelect 								= MSilElvesVoiceSelectMS
	VoiceSelectBattle  							= MSilElvesVoiceSelectBattle
	
	VoiceEnterStateAttack 						= MSilElvesVoiceEnterStateAttackRanged
	VoiceEnterStateAttackCharge 				= MSilElvesVoiceEnterStateAttackCharge
	VoiceEnterStateAttackStructure 				= MSilElvesVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackMachine 				= MSilElvesVoiceEnterStateAttackBuilding
	VoiceEnterStateMove 						= MSilElvesVoiceEnterStateMove
	VoiceEnterStateMoveToCamp 					= MSilElvesVoiceEnterStateMoveCamp
	;VoiceEnterStateMoveToHigherGround			= MSilElvesVoiceEnterStateMoveHighGround	;MSilElvesVoiceMoveHighGround
	VoiceEnterStateMoveWhileAttacking			= MSilElvesVoiceEnterStateDisengage
	VoiceEnterStateRetreatToCastle	 			= MSilElvesVoiceEnterStateRetreat

	MinZIncreaseForVoiceMoveToHigherGround		= 45

	SoundImpact									= ImpactHorse

	CrowdResponseKey = Elf

	UnitSpecificSounds
		VoiceEnterStateInitiateCaptureBuilding	= MSilElvesVoiceEnterStateMove
		VoiceEnterUnitElvenTransportShip		= MSilElvesVoiceGarrison
		VoiceGarrison         					= MSilElvesVoiceGarrison
		VoiceInitiateCaptureBuilding			= MSilElvesVoiceEnterStateMove				; From SpecialPower SpecialAbilityCaptureBuilding
		VoiceMoveToTrees						= MSilElvesVoiceMoveTrees
		VoiceEnterStateMoveToTrees				= MSilElvesVoiceEnterStateMoveTrees
	End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
	
	; ClientBehavior = RandomSoundSelectorClientBehavior ModuleTag_RSSCB
		; ; This is a counter to the similar module in the RohanPeasant4. Without this,
		; ; the larger a group, the more likely it is a woman's voice will be heard; until
		; ; a 100 peasant group will basically ALWAYS be playing a woman's voice. This ensures that a 
		; ; large group of mixed peasants will still be led by a man. [Sorry, but that's
		; ; Middle Earth for you -- just ask Eowyn!]
		; Chance = 50% 
		; RerollOnEveryFrame = No ; For consistancy
		; VoicePriority = 25 ; Bossy man is high enough to overcome "bossy" women
	; End

	ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
		ModelCondition = Required:EMOTION_CELEBRATING	Excluded:DYING ENGAGED	Sound:EmotionElfCompilationVoxCheerSinglesLoop	;MOVING ATTACKING 
		ModelCondition = Required:EMOTION_TAUNTING		Excluded:DYING ENGAGED	Sound:EmotionElfCompilationVoxTauntSinglesLoop	;MOVING ATTACKING
		;ModelCondition = Required:EMOTION_POINTING		Excluded:DYING ENGAGED	Sound:EmotionElfCompilationVoxTauntSinglesLoop
		ModelCondition = Required:RAISING_FLAG			Excluded:DYING ENGAGED	Sound:EmotionElfCompilationVoxTauntSinglesLoop
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:BodyFallGeneric1			Animation:GUArcher_SKL.GUArcher_DIEB	Frames:19
		AnimationSound = Sound:BodyFallGeneric1			Animation:GUArcher_SKL.GUArcher_DIED	Frames:53
		AnimationSound = Sound:BodyFallGeneric1			Animation:GUArcher_SKL.GUArcher_LNDA	Frames:1
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:GUArcher_SKL.GUArcher_LNDA	Frames:14
	End

	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU		; Tie into LargeGroupAudio system
		Key = Humanoid_Male Elf Elf_Male Unit Infantry Elf_MirkwoodArcher		;Human
	End

	; *** ENGINEERING Parameters ***

	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT ARCHER GRAB_AND_DROP ATTACK_NEEDS_LINE_OF_SIGHT ;GRAB_AND_KILL
	CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_LONG
	
	Body = ActiveBody ModuleTag_02
		CheerRadius 	  = EMOTION_CHEER_RADIUS
		MaxHealth         = ELVEN_LORIENARCHER_HEALTH				;BALANCE Archer Health
		MaxHealthDamaged  = ELVEN_MIRKWOOD_ARCHER_HEALTH_DAMAGED			
		;RecoveryTime      = ELVEN_MIRKWOOD_ARCHER_HEALTH_RECOVERY_TIME		
		BurningDeathBehavior = Yes
		BurningDeathFX       = FX_InfantryBurningFlame
	End
	
	Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTagMirkwoodArcher
		TriggeredBy = Upgrade_MirkwoodSilverthornArrows   ;Upgrade_ElvenSilverthornArrows
	End

	;Wambly - Updated AI Preferences
	
	Behavior = AIUpdateInterface ModuleTag_03
		;AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
		AutoAcquireEnemiesWhenIdle	= Yes 
		CanAttackWhileContained		= Yes
		AILuaEventsList				= MirkwoodSilvanFunctions
		AttackPriority				= 	AttackPriority_ARCHER
		BurningDeathTime				= BURNINGDEATH_DURATION_INFANTRY
	End
	
	Behavior = ArmorUpgrade ModuleTag_ArmorUpgrade
		TriggeredBy = Upgrade_RohanHeavyArmor ;ForElves
		ArmorSetFlag = PLAYER_UPGRADE
	End

	LocomotorSet
		Locomotor = HumanLocomotor
		Condition = SET_NORMAL
		Speed     = NORMAL_FOOT_VERYFAST_MEMBER_SPEED	
	End

	LocomotorSet
		Locomotor = HumanWanderLocomotor
		Condition = SET_WANDER 
		Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED	
	End

	LocomotorSet
		Locomotor = BurningDeathLocomotorInfantry
		Condition = SET_BURNINGDEATH
		Speed	  = BURNINGDEATH_WANDERSPEED_INFANTRY
	End

	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult = 1.0
	End

	Behavior = AimWeaponBehavior AimWeaponModuleTag
		AimLowThreshold  = -0.15
		AimHighThreshold =  0.15
	End
	
	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes = ALL -FADED
		SinkDelay = 3000
		SinkRate = 0.600     ; in Dist/Sec
		DestructionDelay = 12000
		Sound = INITIAL SilvanElfGenericVoiceDie
	End
	
	Behavior = SlowDeathBehavior ModuleTag_SlowDeathFaded
		DeathTypes = NONE +FADED
		FadeDelay		= 0
		FadeTime		= 4000
		DestructionDelay = 4000
		DeathFlags		= DEATH_2
		Sound = INITIAL SpellGenericUnsummonFasterMS
	End
	
	Behavior = SquishCollide ModuleTag_06
		;nothing
	End
	
	; RohanArcher
	Behavior = HordeMemberCollide ModuleTag_HMC
		;nothing
	End
	
	Behavior = BezierProjectileBehavior ModuleTag_07 ; Module starts asleep, and wakes up when thrown.
		FirstHeight = 24  ; Height of Bezier control points above highest intervening terrain
		SecondHeight = 24
		FirstPercentIndent = 30% ; Percentage of shot distance control points are placed
		SecondPercentIndent = 70%
		TumbleRandomly = Yes

		CrushStyle = Yes ; I don't detonate, I just hit
		DieOnImpact = Yes
		BounceCount = 1   ; When I hit the ground, I'll arc again
		BounceDistance = 40 ; this far
		BounceFirstHeight = 24  ; Height of Bezier control points above highest intervening terrain
		BounceSecondHeight = 24
		BounceFirstPercentIndent = 20% ; Percentage of shot distance control points are placed
		BounceSecondPercentIndent = 80%

		GroundHitFX       = FX_ThrownRockGroundHit
		GroundBounceFX    = FX_ThrownRockBounceHit
	End

	; Fire arrow upgrade
	Behavior = WeaponSetUpgrade ModuleTag_08
		TriggeredBy = Upgrade_MirkwoodSilverthornArrows   ;Upgrade_ElvenSilverthornArrows
		; Turn off fire arrow visuals -- will be redone like Peasant drafting.
		;CustomAnimAndDuration   = AnimState:USER_4 AnimTime:0 TriggerTime:0 ;set flag forever		
	End

	;--------------------------------------------------------------------------
	;
	;	Sub object upgrades.
	;
  	
  	; ;Heavy Armor
	; Behavior = ArmorUpgrade ArmorUpgradeModuleTag
		; TriggeredBy = Upgrade_ElvenHeavyArmor
		; ArmorSetFlag			= PLAYER_UPGRADE
	; End

	Behavior = SubObjectsUpgrade Armor_Upgrade
		TriggeredBy		= Upgrade_SindarinHeavyArmor
		; UpgradeTexture	= tugreenwood.tga 0 tugreenwood_HA.tga
;		UpgradeTexture	= eulorien2.tga 0 eulorienHA2.tga
;		UpgradeTexture	= eulorien3.tga 0 eulorienHA3.tga
		RecolorHouse			= Yes
		ExcludeSubobjects		= Forged_Blade
		; ShowSubObjects	= BODYHA VAMBRACES
		; HideSubObjects	= BODY1 BODY2 BODY3
	End
  	
  	Behavior = SubObjectsUpgrade HeavyArmorVisual_Upgrade
  		TriggeredBy		= Upgrade_SindarinHeavyArmor
  		; ShowSubObjects	= BODYMHOODHA LEGGUARDSM ARMSMHA HOODMHA BODYMHA HOODMDOWNHA BODYFHOODHA LEGGUARDSF ARMSFHA HOODFHA BODYFHA HOODFDOWNHA  
		; HideSubObjects	= ARMSF ARMSM BODYM1 BODYM2 BODYM3 HOODMDOWN1 HOODMDOWN2 HOODMDOWN3 BODYMHOOD1 BODYMHOOD2 BODYMHOOD3 HOODM1 HOODM2 HOODM3 BODYF1 BODYF2 BODYF3 HOODFDOWN1 HOODFDOWN2 HOODFDOWN3 BODYFHOOD1 BODYFHOOD2 BODYFHOOD3 HOODF1 HOODF2 HOODF3
  	End
	
	Behavior = AttributeModifierUpgrade ModuleTag_ElvenGiftBonus
		TriggeredBy = Upgrade_SindarinHeavyArmor
		AttributeModifier = SilverandJewels
	End
  	
  	Behavior = SubObjectsUpgrade MagicArrows_Upgrade
  		TriggeredBy		= Upgrade_MirkwoodSilverthornArrows    ;Upgrade_ElvenSilverthornArrows
  		ShowSubObjects	= FireArowTip ArrowNockU	QARROWSU		; yes, it's a typo.
  		HideSubObjects	= ArrowNock QARROWS
  	End
	
  	;Behavior = SubObjectsUpgrade ElvenCloak_Upgrade
  	;	TriggeredBy		= Upgrade_ElvenCloak
;
;		; NEED TO FILL THIS IN
;
 ; 	End

	;--------------------------------------------------------------------------

;	Behavior = DualWeaponBehavior ModuleTag_09
;		SwitchWeaponOnCloseRangeDistance = 40
;	End
	
	Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
		HitReactionLifeTimer1 = 1993 ; level 1 (light  damage)  hit reaction animations in ms
		HitReactionLifeTimer2 = 1993 ; level 2 (medium damage)  hit reaction animations in ms
		HitReactionLifeTimer3 = 1993 ; level 3 (heavy  damage)  hit reaction animations in ms

		HitReactionThreshold1 = 5.0   ; level 1 (light  damage) threshold trigger
		HitReactionThreshold2 = 25.0  ; level 2 (medium damage) threshold trigger
		HitReactionThreshold3 = 50.0  ; level 3 (heavy  damage) threshold trigger

		FastHitsResetReaction = Yes    ;If set -- when hits occur faster than the reaction animations, it will reset the animation. (like getting riddled with machine gun bullets)
	End
	
	Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes

  Shadow = SHADOW_DECAL
  ShadowSizeX = 19;
  ShadowSizeY = 19;
  ShadowTexture = ShadowI;
End
;===================================FEMALE ARCHER============================================
;--------------------------------------------------------------------------------------------
ChildObject MirkwoodRanger2 MirkwoodRanger1
	Scale = 1.06
	; *** ART Parameters ***
	
	Draw	=	W3DHordeModelDraw ModuleTag_01

		OkToChangeModelColor = Yes
	  
		;	---Test entry for the time of day texture swap test---
		;	TimeOfDayTexture = twwater01.tga AFTERNOON 0 ROHANWARRIOR01
			
		;	RandomTexture = guarcher.tga 0
		;	RandomTexture = twwater01.tga 0
		;	RandomTexture = rbgen01.tga 0

		StaticModelLODMode = no ; Will append M or L to the skin name depending on GameLOD

		ParticlesAttachedToAnimatedBones = yes

; --------- With Bow ------------
		DefaultModelConditionState
			Model						=	tumirkarch_f
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	SECONDARY ARROWNOCK	; when upgraded to flaming arrow
			WeaponLaunchBone			=	TERTIARY ARROW
			ParticleSysBone				=	NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
		End
		
; --------- With Bow Upgrade  ------------

		ModelConditionState				=	WEAPONSET_PLAYER_UPGRADE INVISIBLE_STEALTH
			Model						=	tumirkarch_f
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	SECONDARY ARROWNOCK	; when upgraded to flaming arrow
			WeaponLaunchBone			=	TERTIARY ARROW
			ParticleSysBone				=	NONE Predator FollowBone:Yes Persist:SPAWN PersistID:100
		End

		ModelConditionState				=	INVISIBLE_STEALTH
			ParticleSysBone				=	NONE Predator FollowBone:Yes Persist:SPAWN PersistID:100
		End

		ModelConditionState				=	WEAPONSET_PLAYER_UPGRADE
			Model						=	tumirkarch_f
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	SECONDARY ARROWNOCK	; when upgraded to flaming arrow
			WeaponLaunchBone			=	TERTIARY ARROW
			ParticleSysBone				=	NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
		End
		
		ModelConditionState				=	RIDER5
			Model						=	tumirkarch_fHA
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	SECONDARY ARROWNOCK	; when upgraded to flaming arrow
			WeaponLaunchBone			=	TERTIARY ARROW
			; ParticleSysBone				=	NONE Predator FollowBone:Yes Persist:SPAWN PersistID:100
		End
		
;----------- Default Idle animations -------
		IdleAnimationState
			StateName					=   STATE_Idle
			Animation = IdleA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			;*** Repeat IDLA because animation priorities will not choose same animation twice so it can alternate between first two mostly.
			Animation = IdleA	
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleH
				AnimationName			=	GUArcher_IDLH
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleI
				AnimationName			=	GUArcher_IDLI
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleJ
				AnimationName			=	GUArcher_IDLJ
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
			EndScript
		End
		
;----------- Flying through air -------
		AnimationState						= PASSENGER
			Animation						= FLLA
				AnimationName				= GUArcher_FLLA
				AnimationMode				= LOOP
			End
		End
		
		
		AnimationState        = THROWN_PROJECTILE
			Animation           = FLYA
				AnimationName     = GUArcher_FLYA
				AnimationMode     = LOOP
			End
		End
		
		AnimationState						= FREEFALL
			Animation						= Falling
				AnimationName				= GUArcher_FLYA
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
				AnimationSpeedFactorRange	= 0.35	0.35
			End
		End
		
		AnimationState					=	STUNNED_FLAILING 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_FLLA 
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End
		
		

;----------- Dying -------
	AnimationState				=	DYING DEATH_2
		Animation
			AnimationName				= GUArcher_IDLA
			AnimationMode				= LOOP
		End
	End
		AnimationState					= DYING BURNINGDEATH
			Animation
				AnimationName			= GUArcher_DIEB
				AnimationMode			= ONCE
				AnimationBlendTime		= 10
			End
			Animation
				AnimationName			= GUArcher_DIED
				AnimationMode			= ONCE
				AnimationBlendTime		= 10
			End
		End
		
		AnimationState					=	DYING SPLATTED
			Animation					=	Fire
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
            EnteringStateFX = FX_SoldierHitGround
		End

		AnimationState					=	DYING AFLAME
			Animation					=	Fire
				AnimationName			=	GUArcher_MFDA 
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					=	Fire
				AnimationName			=	GUArcher_MFDB 
				AnimationSpeedFactorRange = 0.9 1.1
			End
		End
		AnimationState					=	DYING
			Animation					=	Die2
				AnimationName			=	GUArcher_DIEB 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation					=	Die3
				AnimationName			=	GUArcher_DIED 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End
	AnimationState						= PARALYZED
		Animation
			AnimationName				= GUArcher_IDLA
			AnimationMode				= LOOP
		End
	End
	AnimationState						= BURNINGDEATH
		Animation
			AnimationName				= GUArcher_MFDA
			AnimationMode				= Loop
			Distance					= 65
		End
	End

;------ Stunned anims -----------
		AnimationState					=	STUNNED_STANDING_UP 
			Animation					=	GTPA
				AnimationName			=	GUArcher_GTPA
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End

		

		AnimationState					=	STUNNED 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
			End
            EnteringStateFX = FX_SoldierHitGround
		End

;------- Close range melee fighting ------------
		AnimationState					=	FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
			Animation					=	ATKD
				AnimationName			=	GUArcher_ATKD
				AnimationMode			=	ONCE
				UseWeaponTiming			=	Yes
			End
		End

;------- New Style Archery --------------------------------------------
		AnimationState					=	PREATTACK_A 
			StateName					=	STATE_Firing
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_A 
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; Left in as reminder why not to use: UseWeaponTiming does not work for archers. Do not attempt to use this!
				AnimationSpeedFactorRange = 1.1 1.1			; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0				; Blend time needs to be zero or else the arrow subobject lingers length of blend.
			End
		End

		AnimationState					=	PREATTACK_C
			StateName					=	STATE_Firing
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_C
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; Left in as reminder why not to use: UseWeaponTiming does not work for archers. Do not attempt to use this!
				AnimationSpeedFactorRange = 1.1 1.1			; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0				; Blend time needs to be zero or else the arrow subobject lingers length of blend.
			End
		End
		
		AnimationState					=	PREATTACK_E
			StateName					=	STATE_Firing
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End
		
		AnimationState					=	FIRING_OR_RELOADING_E
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	NoNONONOO!!!	; Left in as reminder why not to use: UseWeaponTiming does not work for archers. Do not attempt to use this!
				AnimationSpeedFactorRange = 1.1 1.1			; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0				; Blend time needs to be zero or else the arrow subobject lingers length of blend.
			End
		End		
	
;;========= TERROR
		AnimationState					= MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
			Animation					= TerrorFromTheSky
				AnimationName			= GUArcher_RUNC
				AnimationMode			= LOOP
			End
		End

;;========= BACKING UP
		AnimationState				=	MOVING BACKING_UP
			Animation				=	BackingUp
				AnimationName		=	GUArcher_BAKA
				AnimationMode		=	LOOP
			End
			Flags					=	RANDOMSTART
		End

;;========= MOVING

		AnimationState					=	MOVING ATTACKING
			Animation					=	AMove
				AnimationName			=	GUArcher_RUNB 
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End
		
		AnimationState					=	MOVING WANDER
			Animation					=	Wander1
				AnimationName			=	GUArcher_WLKA 
			End
			Animation					=	Wander2
				AnimationName			=	GUArcher_WLKB ;20
			End
			Flags						=	RANDOMSTART
		End

		AnimationState					=	MOVING
			Animation					=	Move
				AnimationName			=	GUArcher_RUNA 
				AnimationMode			=	LOOP
			End
			Animation					=	MoveB
				AnimationName			=	GUArcher_RUNB 
				AnimationMode			=	LOOP
			End
			Flags						=	RANDOMSTART
		End

;-------- Persistant firing (keep bow drawn ) ------------
		AnimationState					= CONTINUOUS_FIRE_MEAN
			StateName					=	STATE_Firing
			Animation					=	HangFrameWhileCoasting
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	MANUAL
			End
		End
		
		AnimationState						= CONTINUOUS_FIRE_SLOW
			StateName						= STATE_Idle
			Animation						= PutAwayArrow
				AnimationName				= GUArcher_ATKF3
				AnimationMode				= ONCE
			End
		End
		
;------------ HIT REACTION -----------------------------------------------------
		AnimationState = HIT_REACTION
			Animation = Hit_Level_1_a
				AnimationName = GUArcher_HITA
				AnimationMode = ONCE
			End
		End
		
;--------------------- EMOTIONS -----------------------------

;;======= TERROR

		AnimationState					= EMOTION_AFRAID
			Animation					= FERA
				AnimationName			= GUArcher_FERA
				AnimationMode			= LOOP
			End
			Animation					= FERB
				AnimationName			= GUArcher_FERB
				AnimationMode			= LOOP
			End
			Animation					= FERC
				AnimationName			= GUArcher_FERC
				AnimationMode			= LOOP
			End
			Animation					= FERD
				AnimationName			= GUArcher_FERD
				AnimationMode			= LOOP
			End
		End
		
;;======= CELEBRATING

		AnimationState					= EMOTION_CELEBRATING
			Animation					= CHRB
				AnimationName			= GUArcher_CHRB
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= SLTA
				AnimationName			= GUArcher_SLTA
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= CHRA
				AnimationName			= GUArcher_CHRA
				AnimationMode			= Once
				AnimationBlendTime		= 15		
				AnimationPriority		= 1;Use least often of cheers (Eugene)
			End
			Flags						=	RESTART_ANIM_WHEN_COMPLETE
		End
		
;;======== TAUNTING

		AnimationState					= EMOTION_TAUNTING
			Animation					= Taunting2
				AnimationName			= GUArcher_IDLE
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting3
				AnimationName			= GUArcher_IDLF
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting4
				AnimationName			= GUArcher_IDLG
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End

			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End

;;======== POINTING

		AnimationState						= EMOTION_POINTING
			ShareAnimation					= Yes
			Animation						= pointing
				AnimationName				= GUArcher_PNTA
				AnimationPriority			= 2
				AnimationSpeedFactorRange	= 0.9 1.1
				AnimationMode				= LOOP
			End
		End
		

;;======== ALERT
		
		AnimationState					= EMOTION_ALERT
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Point
				AnimationName			= GUArcher_PNTA
				AnimationMode			= LOOP
				AnimationPriority		= 1
				AnimationBlendTime		= 15
			End
		End

; Turn off fire arrow visuals -- will be redone like Peasant drafting.
;;----------------- FIRE ARROW UPGRADE --------------------------------------------
		AnimationState        =  USER_4 ;Fire arrow upgrade
			Animation = IdleB
				AnimationName			=	GUArcher_IDLB 
				AnimationPriority		=	2 ;10
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleC
				AnimationName			=	GUArcher_IDLC
				AnimationPriority		=	1 ;5
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleD
				AnimationName			=	GUArcher_IDLD
				AnimationPriority		=	1 ;5
				AnimationSpeedFactorRange = 0.7 1.3
			End
			BeginScript
				CurDrawableShowSubObject("ArrowNock")
				CurDrawableShowSubObject("FireArowTip")
			EndScript
			StateName           = Bow
		End

		AnimationState					= RAISING_FLAG
			Animation					= CHRB
				AnimationName			= GUArcher_CHRB
				AnimationMode			= Once
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					= SLTA
				AnimationName			= GUArcher_SLTA
				AnimationMode			= Once
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					= CHRA
				AnimationName			= GUArcher_CHRA
				AnimationMode			= Once
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Flags						=	RESTART_ANIM_WHEN_COMPLETE
		End

;;----------------- SELECTED --------------------------------------------
		AnimationState					=	SELECTED
			StateName					=	STATE_Selected
			Animation					=	ATNB
				AnimationName			=	GUArcher_ATNB
				AnimationMode			=	LOOP
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					=	IDLA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	10
				AnimationSpeedFactorRange = 0.7 1.3
			End

			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" 
				then 
					CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") 
				end
				if CurDrawableModelcondition("ATTACKING")
				then
					return "IDLA"
				else
					return "ATNB"
				end
			EndScript
		End
		
	
;;----------------- Transitions ------------------------------------------------------
		TransitionState					=	TRANS_Idle_to_Selected
			Animation					=	ATNA
				AnimationName			=	GUArcher_ATNA
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.8 1.2
			End
		End
		TransitionState					=	TRANS_Selected_To_Idle
			Animation					=	ATNC
				AnimationName			=	GUArcher_ATNC
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 1.0 2.0 ;Kind of a slow animation
			End
		End
	End
	
	; *** AUDIO Parameters ***;

	VoiceAttack 								= FSilElvesVoiceAttackRanged
	VoiceAttackAir								= FSilElvesVoiceAttackRanged
	VoiceAttackCharge 							= FSilElvesVoiceAttackCharge
	VoiceAttackMachine 							= FSilElvesVoiceAttackRanged
	VoiceAttackStructure 						= FSilElvesVoiceAttackBuilding
	VoiceCreated 								= FSilElvesVoiceSaluteRanged
	VoiceFullyCreated							= FSilElvesVoiceSaluteRanged
	VoiceGuard									= FSilElvesVoiceMove
	VoiceMove 									= FSilElvesVoiceMove
	VoiceMoveToCamp 							= FSilElvesVoiceMoveCamp
	;VoiceMoveToHigherGround						= FSilElvesVoiceMoveHighGround
	VoiceMoveWhileAttacking 					= FSilElvesVoiceDisengage
	VoicePriority								= 24
	VoiceRetreatToCastle 						= FSilElvesVoiceRetreat
	VoiceSelect 								= FSilElvesVoiceSelectMS
	VoiceSelectBattle  							= FSilElvesVoiceSelectBattle
	
	VoiceEnterStateAttack 						= FSilElvesVoiceEnterStateAttackRanged
	VoiceEnterStateAttackCharge 				= FSilElvesVoiceEnterStateAttackCharge
	VoiceEnterStateAttackStructure 				= FSilElvesVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackMachine 				= FSilElvesVoiceEnterStateAttackBuilding
	VoiceEnterStateMove 						= FSilElvesVoiceEnterStateMove
	VoiceEnterStateMoveToCamp 					= FSilElvesVoiceEnterStateMoveCamp
	;VoiceEnterStateMoveToHigherGround			= FSilElvesVoiceEnterStateMoveHighGround	;FSilElvesVoiceMoveHighGround
	VoiceEnterStateMoveWhileAttacking			= FSilElvesVoiceEnterStateDisengage
	VoiceEnterStateRetreatToCastle	 			= FSilElvesVoiceEnterStateRetreat

	MinZIncreaseForVoiceMoveToHigherGround		= 45

	SoundImpact									= ImpactHorse

	CrowdResponseKey = Elf

	UnitSpecificSounds
		VoiceEnterStateInitiateCaptureBuilding	= FSilElvesVoiceEnterStateMove
		VoiceEnterUnitElvenTransportShip		= FSilElvesVoiceGarrison
		VoiceGarrison         					= FSilElvesVoiceGarrison
		VoiceInitiateCaptureBuilding			= FSilElvesVoiceEnterStateMove				; From SpecialPower SpecialAbilityCaptureBuilding
		VoiceMoveToTrees						= FSilElvesVoiceMoveTrees
		VoiceEnterStateMoveToTrees				= FSilElvesVoiceEnterStateMoveTrees
	End
	
	; ReplaceModule ModuleTag_RSSCB
		; ClientBehavior = RandomSoundSelectorClientBehavior ModuleTag_RSSCB_Woman
			; ; This boils down to: Each time a mixed RohanPeasant is created, there is a 
			; ; 1.5% chance per female the female will be "bossy" and play her voices
			; ; instead of the men's. Once the "bossy-ness" of a female is set, it does
			; ; change, so that we don't keep getting voices from different people.
			; ; So, normally, the male voices will be heard [hey, this IS Middle Earth -- not a place known
			; ; for its gender equity], but every once in a while the females will get a voice. Otherwise
			; ; we basically never ever hear all these nice lines. This spices things up a bit
			; Chance = 50% 
			; RerollOnEveryFrame = No ; For consistancy of which unit plays the voice
			; VoicePriority = 25 ; High enough to overcome the non-bossy men
		; End
	; End
	
	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
		Key = Humanoid_Male Elf Elf_Female Unit Infantry Peasant_Female		;Human
	End
	
	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes = ALL -FADED
		SinkDelay = 3000
		SinkRate = 0.600     ; in Dist/Sec
		DestructionDelay = 12000
		Sound = INITIAL ElfGenericFemaleVoiceDie
	End
	
		Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes

  Shadow = SHADOW_DECAL
  ShadowSizeX = 19;
  ShadowSizeY = 19;
  ShadowTexture = ShadowI;
End

//------------------------------------------------------------------------------
ChildObject MirkwoodRanger1_Patrol MirkwoodRanger1
	Scale = 1.07
	// *** ART Parameters ***
	Draw = W3DHordeModelDraw ModuleTag_01
		OkToChangeModelColor = Yes
		StaticModelLODMode = Yes
		// specify options for static LODs
		LodOptions	= LOW
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_LOW
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_LOW
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_LOW
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_LOW
		End
		LodOptions	= MEDIUM
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_MED
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_MED
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_MED
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_MED
		End
		LodOptions	= HIGH
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_HIGH
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_HIGH
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_HIGH
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_HIGH
		End
		ParticlesAttachedToAnimatedBones = yes
		// --------- With Bow ------------
		DefaultModelConditionState
			Model						=	tumirkarch_m
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	TERTIARY ARROW
		End

		// --------- With Bow Upgrade  ------------
		ModelConditionState = WEAPONSET_PLAYER_UPGRADE
			Model						=	tumirkarch_m
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	TERTIARY ARROW
		End
		
		ModelConditionState = RIDER5
			Model						=	tumirkarch_mHA
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	TERTIARY ARROW
		End
		//-----------------
		IdleAnimationState
			StateName					=   STATE_Idle
			Animation = IdleA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			//*** Repeat IDLA because animation priorities will not choose same animation twice so it can alternate between first two mostly.
			Animation = IdleA	
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleH
				AnimationName			=	GUArcher_IDLH
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleI
				AnimationName			=	GUArcher_IDLI
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleJ
				AnimationName			=	GUArcher_IDLJ
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
			EndScript
		End
		AnimationState        = THROWN_PROJECTILE
			Animation           = FLYA
				AnimationName     = GUArcher_FLYA
				AnimationMode     = LOOP
			End
		End
		AnimationState        = PASSENGER FREEFALL
			Animation           = FLLA
				AnimationName     = GUArcher_FLLA
				AnimationMode     = LOOP
			End
		End
		AnimationState			= FREEFALL
			Animation			= Flying_1
				AnimationName	= GUARCHER_FLYA
				AnimationMode	= LOOP
				AnimationSpeedFactorRange = 0.35 0.35 //Very slow
				AnimationBlendTime		  = 10		//Very slow
			End
		End
		// --- stunned anims
		AnimationState					=	STUNNED_FLAILING 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_FLYA 
				AnimationMode			=	LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Flags						=	RANDOMSTART
		End
		AnimationState						= DYING DEATH_2
			Animation
				AnimationName				= GUArcher_IDLA 
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
			End
		End
		AnimationState					= DYING BURNINGDEATH
			Animation
				AnimationName			= GUArcher_DIEA
				AnimationMode			= ONCE
				AnimationBlendTime		= 10
			End
			Animation
				AnimationName			= GUArcher_DIEB
				AnimationMode			= ONCE
				AnimationBlendTime		= 10
			End
			Animation
				AnimationName			= GUArcher_DIED
				AnimationMode			= ONCE
				AnimationBlendTime		= 10
			End
		End
		AnimationState					=	DYING SPLATTED
			Animation					=	Fire
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
            EnteringStateFX = FX_SoldierHitGround
		End
		AnimationState					=	DYING AFLAME
			Animation					=	Fire
				AnimationName			=	GUArcher_MFDA 
				AnimationSpeedFactorRange = 0.9 1.1
			End
		End
		AnimationState					=	DYING
			Animation					=	Die1
				AnimationName			=	GUArcher_DIEA 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation					=	Die2
				AnimationName			=	GUArcher_DIEB 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End
		AnimationState						= BURNINGDEATH
			Animation
				AnimationName				= GUArcher_MFDA
				AnimationMode				= LOOP
				Distance					= 50
			End
		End
		AnimationState						= PARALYZED
			Animation
				AnimationName				= GUArcher_IDLA
				AnimationMode				= LOOP
			End
		End
		AnimationState					=	STUNNED_STANDING_UP 
			Animation					=	GTPA
				AnimationName			=	GUArcher_GTPA
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.1
			End
		End
		AnimationState					=	STUNNED 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
			End
            EnteringStateFX = FX_SoldierHitGround
		End
		AnimationState						= EMOTION_UNCONTROLLABLY_AFRAID
			ShareAnimation = Yes
			Animation						= FERA
				AnimationName				= GUArcher_FERA
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERB
				AnimationName				= GUArcher_FERB
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERC
				AnimationName				= GUArcher_FERC
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERD
				AnimationName				= GUArcher_FERD
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Flags							= RANDOMSTART			
		End
  		AnimationState					=	FIRING_OR_PREATTACK_B
  			Animation					=	BowPunchWhenClose
  				AnimationName			=	GUArcher_ATKD 
  				AnimationMode			=	ONCE
  				UseWeaponTiming			=	Yes
  			End
 		End
		//---------------------------------------------------
		//New style firing
		AnimationState					=	PREATTACK_A
			StateName					=	STATE_PreFiring
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End
		AnimationState					=	FIRING_OR_RELOADING_A
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKA
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationSpeedFactorRange = 1.2 1.3		// Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0
			End
			Flags = START_FRAME_FIRST
		End
		AnimationState					=	PREATTACK_C
			StateName					=	STATE_PreFiring
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End
		AnimationState					=	FIRING_OR_RELOADING_C
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKA
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationSpeedFactorRange = 1.2 1.3		// Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0
			End
			Flags = START_FRAME_FIRST
		End
		//End New style firing
		//---------------------------------------------------
		AnimationState					=	MOVING WANDER
			ShareAnimation = Yes
			;Animation					=	Wander1
			;	AnimationName			=	GUArcher_WLKA 
			;End
			Animation					=	Wander2
				AnimationName			=	GUArcher_WLKB //20
			End
			ParticleSysBone				= None InfantryDustTrails
			Flags						=	RANDOMSTART
		End
		AnimationState					= MOVING EMOTION_LOOK_TO_SKY
			ShareAnimation = Yes
			Animation					= TerrorFromTheSky
				AnimationName			= GUArcher_RUNC
				AnimationMode			= LOOP
			End
			ParticleSysBone				= None InfantryDustTrails
		End
		AnimationState				=	MOVING BACKING_UP
			ShareAnimation = Yes
			Animation				=	BackingUp
				AnimationName		=	GUArcher_BAKA
				AnimationMode		=	LOOP
			End
			ParticleSysBone				= None InfantryDustTrails
			Flags					=	RANDOMSTART
		End
		AnimationState					=	ATTACKING MOVING
			ShareAnimation = Yes
			Animation					=	Move2
				AnimationName			=	GUArcher_RUNB
			End
			ParticleSysBone				= None InfantryDustTrails
			Flags						=	RANDOMSTART
		End
		AnimationState					=	MOVING
			ShareAnimation = Yes
			;Animation					=	Move1
			;	AnimationName			=	GUArcher_WLKA 
			;End
			Animation					=	Move1
				AnimationName			=	GUArcher_WLKB 
			End
			Flags						=	RANDOMSTART
		End
		AnimationState					= RAISING_FLAG
			Animation					= CHRA
				AnimationName			= GUArcher_CHRA
				AnimationMode			= Once
				AnimationSpeedFactorRange	= 0.9 1.1
			End
			Animation					= CHRB
				AnimationName			= GUArcher_CHRB
				AnimationMode			= Once
				AnimationSpeedFactorRange	= 0.9 1.1
			End
			Animation					= CHRA
				AnimationName			= GUArcher_CHRC
				AnimationMode			= Once
				AnimationSpeedFactorRange	= 0.9 1.1
			End
			Flags						=	RESTART_ANIM_WHEN_COMPLETE
		End
		AnimationState					= CONTINUOUS_FIRE_MEAN
			StateName					=	STATE_Coasting
			Animation					=	HangFrameWhileCoasting
				AnimationName			=	GUArcher_ATKA
				AnimationMode			=	MANUAL
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Firing" then CurDrawableAllowToContinue() return end
			EndScript
		End
		AnimationState						= CONTINUOUS_FIRE_SLOW
			StateName						= STATE_Idle
			Animation						= PutAwayArrow
				AnimationName				= GUArcher_ATKF3
				AnimationMode				= ONCE
			End
		End
//------------ HIT REACTION -----------------------------------------------------
// --------- Click and Hit Reactions ------------	
//------------ EMOTIONS ---------------------------------------------------------
//======= AFRAID
		AnimationState						= EMOTION_AFRAID
			ShareAnimation = Yes
			Animation						= FERA
				AnimationName				= GUArcher_FERA
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERB
				AnimationName				= GUArcher_FERB
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERC
				AnimationName				= GUArcher_FERC
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERD
				AnimationName				= GUArcher_FERD
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Flags							= RANDOMSTART			
		End
//======= CELEBRATING
		AnimationState					= EMOTION_CELEBRATING
			Animation					= CHRB
				AnimationName			= GUArcher_CHRB
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= SLTA
				AnimationName			= GUArcher_SLTA
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= CHRA
				AnimationName			= GUArcher_CHRA
				AnimationMode			= Once
				AnimationBlendTime		= 15		
				AnimationPriority		= 1//Use least often of cheers (Eugene)
			End
			Flags						=	RESTART_ANIM_WHEN_COMPLETE
		End
//======== TAUNTING
		AnimationState					= EMOTION_TAUNTING
			Animation					= Taunting2
				AnimationName			= GUArcher_IDLE
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting3
				AnimationName			= GUArcher_IDLF
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting4
				AnimationName			= GUArcher_IDLG
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End
//======== POINTING
		AnimationState						= EMOTION_POINTING
			ShareAnimation					= Yes
			Animation						= pointing
				AnimationName				= GUArcher_PNTA
				AnimationPriority			= 2
				AnimationSpeedFactorRange	= 0.9 1.1
				AnimationMode				= LOOP
			End
		End
//======= ALERT
		AnimationState					= EMOTION_ALERT
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Point
				AnimationName			= GUArcher_PNTA
				AnimationMode			= LOOP
				AnimationPriority		= 1
				AnimationBlendTime		= 15
			End
		End

		AnimationState        = WEAPONSTATE_CLOSE_RANGE
			StateName					=   STATE_Idle
			Animation = IdleA	
				AnimationName			=	GUArcher_IDLS
				AnimationPriority		=	6
;				AnimationSpeedFactorRange = 0.7 1.3
			End
		End

//----------------- SELECTED --------------------------------------------
		AnimationState					=	SELECTED
			ShareAnimation = Yes
			StateName					=	STATE_Selected
			Animation					=	ATNB
				AnimationName			=	GUArcher_ATNB
				AnimationMode			=	LOOP
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					=	IDLA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	10
				AnimationSpeedFactorRange = 0.7 1.3
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" 
				then 
					CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected")
				end
				if CurDrawableModelcondition("ATTACKING")
				then
					return "IDLA"
				else
					return "ATNB"
				end
			EndScript
		End
//----------------- Transitions ------------------------------------------------------
		TransitionState	= TRANS_Idle_to_Selected
			Animation	= ATNA
				AnimationName			  =	GUArcher_ATNA
				AnimationMode			  =	ONCE
				AnimationSpeedFactorRange =	0.8	1.2
				AnimationPriority		  =	8
			End
			Animation					=	SLTA
				AnimationName			  =	GUArcher_SLTA
				AnimationMode			  =	ONCE
				AnimationSpeedFactorRange =	1.0	1.5
				AnimationPriority		  =	1
			End
		End
		TransitionState					=	TRANS_Selected_To_Idle
			Animation					=	ATNC
				AnimationName			=	GUArcher_ATNC
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.5 2.0
			End
		End
	End
	CommandPoints = 0
	EquivalentTo = MirkwoodRanger1

	WeaponSet
		Conditions = None 
		Weapon	   = PRIMARY GondorArcherEliteBow_Patrol
		Weapon	   = TERTIARY GondorArcherEliteBow_Patrol
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
	End

	Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 200.0
		GuardWanderRange	= 100.0
		DieOnMastersDeath		= Yes
		MarkUnselectable		= Yes
	End


  	Behavior = SubObjectsUpgrade MagicArrows_Upgrade
  		TriggeredBy		= Upgrade_TechnologyMirkwoodSilverthornArrows
  		ShowSubObjects	= FireArowTip ArrowNockU	QARROWSU
  		HideSubObjects	= ArrowNock QARROWS
  	End	
	
	// Fire arrow upgrade
	Behavior = WeaponSetUpgrade ModuleTag_FireArrowParticlesAndLegalityUpgrade
		TriggeredBy		= Upgrade_TechnologyMirkwoodSilverthornArrows
	End
	
	Behavior = SubObjectsUpgrade Armor_Upgrade
		TriggeredBy		= Upgrade_Evilboyos
		; UpgradeTexture	= tugreenwood.tga 0 tugreenwood_HA.tga
;		UpgradeTexture	= eulorien2.tga 0 eulorienHA2.tga
;		UpgradeTexture	= eulorien3.tga 0 eulorienHA3.tga
		RecolorHouse			= Yes
		ExcludeSubobjects		= Forged_Blade
		; ShowSubObjects	= BODYHA VAMBRACES
		; HideSubObjects	= BODY1 BODY2 BODY3
	End
  	
  	Behavior = SubObjectsUpgrade HeavyArmorVisual_Upgrade
  		TriggeredBy		= Upgrade_Evilboyos
  		; ShowSubObjects	= BODYMHOODHA LEGGUARDSM ARMSMHA HOODMHA BODYMHA HOODMDOWNHA BODYFHOODHA LEGGUARDSF ARMSFHA HOODFHA BODYFHA HOODFDOWNHA  
		; HideSubObjects	= ARMSF ARMSM BODYM1 BODYM2 BODYM3 HOODMDOWN1 HOODMDOWN2 HOODMDOWN3 BODYMHOOD1 BODYMHOOD2 BODYMHOOD3 HOODM1 HOODM2 HOODM3 BODYF1 BODYF2 BODYF3 HOODFDOWN1 HOODFDOWN2 HOODFDOWN3 BODYFHOOD1 BODYFHOOD2 BODYFHOOD3 HOODF1 HOODF2 HOODF3
  	End
	
	Behavior = AttributeModifierUpgrade ModuleTag_ElvenGiftBonus
		TriggeredBy = Upgrade_Evilboyos
		AttributeModifier = SilverandJewels
	End	

	LocomotorSet
		Locomotor = PatrolLocomotor
		Condition = SET_NORMAL
		Speed     = 16	
	End
	LocomotorSet
		Locomotor = HumanWanderLocomotor
		Condition = SET_WANDER 
		Speed     = 16	
	End
	LocomotorSet
		Locomotor = BurningDeathLocomotorInfantry
		Condition = SET_BURNINGDEATH
		Speed	  = BURNINGDEATH_WANDERSPEED_INFANTRY
	End	
End

//------------------------------------------------------------------------------
ChildObject MirkwoodRanger2_Patrol MirkwoodRanger2
	Scale = 1.06
	// *** ART Parameters ***
	Draw = W3DHordeModelDraw ModuleTag_01
		OkToChangeModelColor = Yes
		StaticModelLODMode = Yes
		// specify options for static LODs
		LodOptions	= LOW
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_LOW
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_LOW
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_LOW
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_LOW
		End
		LodOptions	= MEDIUM
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_MED
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_MED
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_MED
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_MED
		End
		LodOptions	= HIGH
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_HIGH
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_HIGH
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_HIGH
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_HIGH
		End
		ParticlesAttachedToAnimatedBones = yes
		// --------- With Bow ------------
		DefaultModelConditionState
			Model						=	tumirkarch_f
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	TERTIARY ARROW
		End

		// --------- With Bow Upgrade  ------------
		ModelConditionState = WEAPONSET_PLAYER_UPGRADE
			Model						=	tumirkarch_f
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	TERTIARY ARROW
		End
		
		ModelConditionState = RIDER5
			Model						=	tumirkarch_fHA
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	TERTIARY ARROW
		End
		//-----------------
		IdleAnimationState
			StateName					=   STATE_Idle
			Animation = IdleA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			//*** Repeat IDLA because animation priorities will not choose same animation twice so it can alternate between first two mostly.
			Animation = IdleA	
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleH
				AnimationName			=	GUArcher_IDLH
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleI
				AnimationName			=	GUArcher_IDLI
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleJ
				AnimationName			=	GUArcher_IDLJ
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
			EndScript
		End
		AnimationState        = THROWN_PROJECTILE
			Animation           = FLYA
				AnimationName     = GUArcher_FLYA
				AnimationMode     = LOOP
			End
		End
		AnimationState        = PASSENGER FREEFALL
			Animation           = FLLA
				AnimationName     = GUArcher_FLLA
				AnimationMode     = LOOP
			End
		End
		AnimationState			= FREEFALL
			Animation			= Flying_1
				AnimationName	= GUARCHER_FLYA
				AnimationMode	= LOOP
				AnimationSpeedFactorRange = 0.35 0.35 //Very slow
				AnimationBlendTime		  = 10		//Very slow
			End
		End
		// --- stunned anims
		AnimationState					=	STUNNED_FLAILING 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_FLYA 
				AnimationMode			=	LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Flags						=	RANDOMSTART
		End
		AnimationState						= DYING DEATH_2
			Animation
				AnimationName				= GUArcher_IDLA 
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
			End
		End
		AnimationState					= DYING BURNINGDEATH
			Animation
				AnimationName			= GUArcher_DIEA
				AnimationMode			= ONCE
				AnimationBlendTime		= 10
			End
			Animation
				AnimationName			= GUArcher_DIEB
				AnimationMode			= ONCE
				AnimationBlendTime		= 10
			End
			Animation
				AnimationName			= GUArcher_DIED
				AnimationMode			= ONCE
				AnimationBlendTime		= 10
			End
		End
		AnimationState					=	DYING SPLATTED
			Animation					=	Fire
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
            EnteringStateFX = FX_SoldierHitGround
		End
		AnimationState					=	DYING AFLAME
			Animation					=	Fire
				AnimationName			=	GUArcher_MFDA 
				AnimationSpeedFactorRange = 0.9 1.1
			End
		End
		AnimationState					=	DYING
			Animation					=	Die1
				AnimationName			=	GUArcher_DIEA 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation					=	Die2
				AnimationName			=	GUArcher_DIEB 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End
		AnimationState						= BURNINGDEATH
			Animation
				AnimationName				= GUArcher_MFDA
				AnimationMode				= LOOP
				Distance					= 50
			End
		End
		AnimationState						= PARALYZED
			Animation
				AnimationName				= GUArcher_IDLA
				AnimationMode				= LOOP
			End
		End
		AnimationState					=	STUNNED_STANDING_UP 
			Animation					=	GTPA
				AnimationName			=	GUArcher_GTPA
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.1
			End
		End
		AnimationState					=	STUNNED 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
			End
            EnteringStateFX = FX_SoldierHitGround
		End
		AnimationState						= EMOTION_UNCONTROLLABLY_AFRAID
			ShareAnimation = Yes
			Animation						= FERA
				AnimationName				= GUArcher_FERA
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERB
				AnimationName				= GUArcher_FERB
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERC
				AnimationName				= GUArcher_FERC
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERD
				AnimationName				= GUArcher_FERD
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Flags							= RANDOMSTART			
		End
  		AnimationState					=	FIRING_OR_PREATTACK_B
  			Animation					=	BowPunchWhenClose
  				AnimationName			=	GUArcher_ATKD 
  				AnimationMode			=	ONCE
  				UseWeaponTiming			=	Yes
  			End
 		End
		//---------------------------------------------------
		//New style firing
		AnimationState					=	PREATTACK_A
			StateName					=	STATE_PreFiring
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End
		AnimationState					=	FIRING_OR_RELOADING_A
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKA
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationSpeedFactorRange = 1.2 1.3		// Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0
			End
			Flags = START_FRAME_FIRST
		End
		AnimationState					=	PREATTACK_C
			StateName					=	STATE_PreFiring
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End
		AnimationState					=	FIRING_OR_RELOADING_C
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKA
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationSpeedFactorRange = 1.2 1.3		// Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0
			End
			Flags = START_FRAME_FIRST
		End
		//End New style firing
		//---------------------------------------------------
		AnimationState					=	MOVING WANDER
			ShareAnimation = Yes
			;Animation					=	Wander1
			;	AnimationName			=	GUArcher_WLKA 
			;End
			Animation					=	Wander2
				AnimationName			=	GUArcher_WLKB //20
			End
			ParticleSysBone				= None InfantryDustTrails
			Flags						=	RANDOMSTART
		End
		AnimationState					= MOVING EMOTION_LOOK_TO_SKY
			ShareAnimation = Yes
			Animation					= TerrorFromTheSky
				AnimationName			= GUArcher_RUNC
				AnimationMode			= LOOP
			End
			ParticleSysBone				= None InfantryDustTrails
		End
		AnimationState				=	MOVING BACKING_UP
			ShareAnimation = Yes
			Animation				=	BackingUp
				AnimationName		=	GUArcher_BAKA
				AnimationMode		=	LOOP
			End
			ParticleSysBone				= None InfantryDustTrails
			Flags					=	RANDOMSTART
		End
		AnimationState					=	ATTACKING MOVING
			ShareAnimation = Yes
			Animation					=	Move2
				AnimationName			=	GUArcher_RUNB
			End
			ParticleSysBone				= None InfantryDustTrails
			Flags						=	RANDOMSTART
		End
		AnimationState					=	MOVING
			ShareAnimation = Yes
			;Animation					=	Move1
			;	AnimationName			=	GUArcher_WLKA 
			;End
			Animation					=	Move1
				AnimationName			=	GUArcher_WLKB 
			End
			Flags						=	RANDOMSTART
		End
		AnimationState					= RAISING_FLAG
			Animation					= CHRA
				AnimationName			= GUArcher_CHRA
				AnimationMode			= Once
				AnimationSpeedFactorRange	= 0.9 1.1
			End
			Animation					= CHRB
				AnimationName			= GUArcher_CHRB
				AnimationMode			= Once
				AnimationSpeedFactorRange	= 0.9 1.1
			End
			Animation					= CHRA
				AnimationName			= GUArcher_CHRC
				AnimationMode			= Once
				AnimationSpeedFactorRange	= 0.9 1.1
			End
			Flags						=	RESTART_ANIM_WHEN_COMPLETE
		End
		AnimationState					= CONTINUOUS_FIRE_MEAN
			StateName					=	STATE_Coasting
			Animation					=	HangFrameWhileCoasting
				AnimationName			=	GUArcher_ATKA
				AnimationMode			=	MANUAL
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Firing" then CurDrawableAllowToContinue() return end
			EndScript
		End
		AnimationState						= CONTINUOUS_FIRE_SLOW
			StateName						= STATE_Idle
			Animation						= PutAwayArrow
				AnimationName				= GUArcher_ATKF3
				AnimationMode				= ONCE
			End
		End
//------------ HIT REACTION -----------------------------------------------------
// --------- Click and Hit Reactions ------------	
//------------ EMOTIONS ---------------------------------------------------------
//======= AFRAID
		AnimationState						= EMOTION_AFRAID
			ShareAnimation = Yes
			Animation						= FERA
				AnimationName				= GUArcher_FERA
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERB
				AnimationName				= GUArcher_FERB
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERC
				AnimationName				= GUArcher_FERC
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERD
				AnimationName				= GUArcher_FERD
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Flags							= RANDOMSTART			
		End
//======= CELEBRATING
		AnimationState					= EMOTION_CELEBRATING
			Animation					= CHRB
				AnimationName			= GUArcher_CHRB
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= SLTA
				AnimationName			= GUArcher_SLTA
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= CHRA
				AnimationName			= GUArcher_CHRA
				AnimationMode			= Once
				AnimationBlendTime		= 15		
				AnimationPriority		= 1//Use least often of cheers (Eugene)
			End
			Flags						=	RESTART_ANIM_WHEN_COMPLETE
		End
//======== TAUNTING
		AnimationState					= EMOTION_TAUNTING
			Animation					= Taunting2
				AnimationName			= GUArcher_IDLE
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting3
				AnimationName			= GUArcher_IDLF
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting4
				AnimationName			= GUArcher_IDLG
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End
//======== POINTING
		AnimationState						= EMOTION_POINTING
			ShareAnimation					= Yes
			Animation						= pointing
				AnimationName				= GUArcher_PNTA
				AnimationPriority			= 2
				AnimationSpeedFactorRange	= 0.9 1.1
				AnimationMode				= LOOP
			End
		End
//======= ALERT
		AnimationState					= EMOTION_ALERT
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Point
				AnimationName			= GUArcher_PNTA
				AnimationMode			= LOOP
				AnimationPriority		= 1
				AnimationBlendTime		= 15
			End
		End

		AnimationState        = WEAPONSTATE_CLOSE_RANGE
			StateName					=   STATE_Idle
			Animation = IdleA	
				AnimationName			=	GUArcher_IDLS
				AnimationPriority		=	6
;				AnimationSpeedFactorRange = 0.7 1.3
			End
		End

//----------------- SELECTED --------------------------------------------
		AnimationState					=	SELECTED
			ShareAnimation = Yes
			StateName					=	STATE_Selected
			Animation					=	ATNB
				AnimationName			=	GUArcher_ATNB
				AnimationMode			=	LOOP
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					=	IDLA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	10
				AnimationSpeedFactorRange = 0.7 1.3
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" 
				then 
					CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected")
				end
				if CurDrawableModelcondition("ATTACKING")
				then
					return "IDLA"
				else
					return "ATNB"
				end
			EndScript
		End
//----------------- Transitions ------------------------------------------------------
		TransitionState	= TRANS_Idle_to_Selected
			Animation	= ATNA
				AnimationName			  =	GUArcher_ATNA
				AnimationMode			  =	ONCE
				AnimationSpeedFactorRange =	0.8	1.2
				AnimationPriority		  =	8
			End
			Animation					=	SLTA
				AnimationName			  =	GUArcher_SLTA
				AnimationMode			  =	ONCE
				AnimationSpeedFactorRange =	1.0	1.5
				AnimationPriority		  =	1
			End
		End
		TransitionState					=	TRANS_Selected_To_Idle
			Animation					=	ATNC
				AnimationName			=	GUArcher_ATNC
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.5 2.0
			End
		End
	End
	CommandPoints = 0
	EquivalentTo = MirkwoodRanger1

	WeaponSet
		Conditions = None 
		Weapon	   = PRIMARY GondorArcherEliteBow_Patrol
		Weapon	   = TERTIARY GondorArcherEliteBow_Patrol
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
	End

	Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 200.0
		GuardWanderRange	= 100.0
		DieOnMastersDeath		= Yes
		MarkUnselectable		= Yes
	End

  	Behavior = SubObjectsUpgrade MagicArrows_Upgrade
  		TriggeredBy		= Upgrade_TechnologyMirkwoodSilverthornArrows
  		ShowSubObjects	= FireArowTip ArrowNockU	QARROWSU
  		HideSubObjects	= ArrowNock QARROWS
  	End	
	
	// Fire arrow upgrade
	Behavior = WeaponSetUpgrade ModuleTag_FireArrowParticlesAndLegalityUpgrade
		TriggeredBy		= Upgrade_TechnologyMirkwoodSilverthornArrows
	End
	
	Behavior = SubObjectsUpgrade Armor_Upgrade
		TriggeredBy		= Upgrade_Evilboyos
		; UpgradeTexture	= tugreenwood.tga 0 tugreenwood_HA.tga
;		UpgradeTexture	= eulorien2.tga 0 eulorienHA2.tga
;		UpgradeTexture	= eulorien3.tga 0 eulorienHA3.tga
		RecolorHouse			= Yes
		ExcludeSubobjects		= Forged_Blade
		; ShowSubObjects	= BODYHA VAMBRACES
		; HideSubObjects	= BODY1 BODY2 BODY3
	End
  	
  	Behavior = SubObjectsUpgrade HeavyArmorVisual_Upgrade
  		TriggeredBy		= Upgrade_Evilboyos
  		; ShowSubObjects	= BODYMHOODHA LEGGUARDSM ARMSMHA HOODMHA BODYMHA HOODMDOWNHA BODYFHOODHA LEGGUARDSF ARMSFHA HOODFHA BODYFHA HOODFDOWNHA  
		; HideSubObjects	= ARMSF ARMSM BODYM1 BODYM2 BODYM3 HOODMDOWN1 HOODMDOWN2 HOODMDOWN3 BODYMHOOD1 BODYMHOOD2 BODYMHOOD3 HOODM1 HOODM2 HOODM3 BODYF1 BODYF2 BODYF3 HOODFDOWN1 HOODFDOWN2 HOODFDOWN3 BODYFHOOD1 BODYFHOOD2 BODYFHOOD3 HOODF1 HOODF2 HOODF3
  	End
	
	Behavior = AttributeModifierUpgrade ModuleTag_ElvenGiftBonus
		TriggeredBy = Upgrade_Evilboyos
		AttributeModifier = SilverandJewels
	End	

	LocomotorSet
		Locomotor = PatrolLocomotor
		Condition = SET_NORMAL
		Speed     = 16	
	End
	LocomotorSet
		Locomotor = HumanWanderLocomotor
		Condition = SET_WANDER 
		Speed     = 16	
	End
	LocomotorSet
		Locomotor = BurningDeathLocomotorInfantry
		Condition = SET_BURNINGDEATH
		Speed	  = BURNINGDEATH_WANDERSPEED_INFANTRY
	End	
	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes = ALL
		SinkDelay = 3000
		SinkRate = 0.600     ; in Dist/Sec
		DestructionDelay = 12000
		Sound = INITIAL ElfGenericFemaleVoiceDie
	End	
End

Object MirkwoodRanger_Slaved

	SelectPortrait	= UPMirkwoodRangers

	Draw = W3DScriptedModelDraw ModuleTag_01  
		DefaultModelConditionState
			;Give it a model so it'll show up in WB
			Model               = tumirkarch_m  ;eugrnwdrngr_m1
		End
	End

	;***** IMPORTANT NOTE! ***************************************************************	
	;Certain Upgrades and costs may need to be propagated from here. One example was veterancy
	;overlays.
	;*************************************************************************************	

	Side = Mirkwood
	EditorSorting = UNIT
	BuildVariations = MirkwoodRanger1_Slaved MirkwoodRanger2_Slaved
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP IMMOBILE SUMMONED
	
  ;Shadow = SHADOW_DECAL
  ;ShadowSizeX = 24;
  ;ShadowSizeY = 24;
  ;ShadowTexture = ShadowI;

End

ChildObject MirkwoodRanger1_Slaved MirkwoodRanger1

	; make sure we can see all round.
	VisionSide			= 100%
	VisionRear			= 100%
	ShroudClearingRange	= 300
	ShockwaveResistance	= SHOCKWAVE_RESISTANCE_ALWAYS

	LocomotorSet
		Locomotor   = FloatingHumanLocomotor
		Condition   = SET_NORMAL
		Speed       = 0
	End

	VoiceCreated					  =	NoVoice	  
	VoiceFullyCreated				  =	NoVoice

	;//These guys are stuck in the barricade can't move and can't be attacked
	KindOf =  UNATTACKABLE NOT_AUTOACQUIRABLE

	Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 0
		GuardWanderRange	= 0
		UseSlaverAsControlForEvaObjectSightedEvents = No ; Not a creep
		DieOnMastersDeath	= Yes
		MarkUnselectable	= No
	End
	WeaponSet
		Conditions = None 
		Weapon	   = PRIMARY MirkwoodRangerBow_Patrol
		Weapon	   = TERTIARY MirkwoodRangerBow_Patrol
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
	End
	
  	Behavior = SubObjectsUpgrade MagicArrows_Upgrade
  		TriggeredBy		= Upgrade_TechnologyMirkwoodSilverthornArrows
  		ShowSubObjects	= FireArowTip ArrowNockU	QARROWSU
  		HideSubObjects	= ArrowNock QARROWS
  	End	
	
	// Fire arrow upgrade
	Behavior = WeaponSetUpgrade ModuleTag_FireArrowParticlesAndLegalityUpgrade
		TriggeredBy		= Upgrade_TechnologyMirkwoodSilverthornArrows
	End
	Behavior = SlowDeathBehavior ModuleTag_05				; overriden to be faster, so we fall with the barricade rubble.
		DeathTypes			= ALL -KNOCKBACK
		SinkDelay			= 10
		SinkRate			= 1.50							; in Dist/Sec
		DestructionDelay	= 10000
		Sound				= INITIAL SilvanElfGenericVoiceDie
	End
	
	Behavior = SubObjectsUpgrade Armor_Upgrade
		TriggeredBy		= Upgrade_Evilboyos
		; UpgradeTexture	= tugreenwood.tga 0 tugreenwood_HA.tga
;		UpgradeTexture	= eulorien2.tga 0 eulorienHA2.tga
;		UpgradeTexture	= eulorien3.tga 0 eulorienHA3.tga
		RecolorHouse			= Yes
		ExcludeSubobjects		= Forged_Blade
		; ShowSubObjects	= BODYHA VAMBRACES
		; HideSubObjects	= BODY1 BODY2 BODY3
	End
  	
  	Behavior = SubObjectsUpgrade HeavyArmorVisual_Upgrade
  		TriggeredBy		= Upgrade_Evilboyos
  		; ShowSubObjects	= BODYMHOODHA LEGGUARDSM ARMSMHA HOODMHA BODYMHA HOODMDOWNHA BODYFHOODHA LEGGUARDSF ARMSFHA HOODFHA BODYFHA HOODFDOWNHA  
		; HideSubObjects	= ARMSF ARMSM BODYM1 BODYM2 BODYM3 HOODMDOWN1 HOODMDOWN2 HOODMDOWN3 BODYMHOOD1 BODYMHOOD2 BODYMHOOD3 HOODM1 HOODM2 HOODM3 BODYF1 BODYF2 BODYF3 HOODFDOWN1 HOODFDOWN2 HOODFDOWN3 BODYFHOOD1 BODYFHOOD2 BODYFHOOD3 HOODF1 HOODF2 HOODF3
  	End
	
	Behavior = AttributeModifierUpgrade ModuleTag_ElvenGiftBonus
		TriggeredBy = Upgrade_Evilboyos
		AttributeModifier = SilverandJewels
	End
	
End

ChildObject MirkwoodRanger2_Slaved MirkwoodRanger2

	; make sure we can see all round.
	VisionSide			= 100%
	VisionRear			= 100%
	ShroudClearingRange	= 300
	ShockwaveResistance	= SHOCKWAVE_RESISTANCE_ALWAYS

	LocomotorSet
		Locomotor   = FloatingHumanLocomotor
		Condition   = SET_NORMAL
		Speed       = 0
	End

	VoiceCreated					  =	NoVoice	  
	VoiceFullyCreated				  =	NoVoice

	;//These guys are stuck in the barricade can't move and can't be attacked
	KindOf =  UNATTACKABLE NOT_AUTOACQUIRABLE

	Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 0
		GuardWanderRange	= 0
		UseSlaverAsControlForEvaObjectSightedEvents = No ; Not a creep
		DieOnMastersDeath	= Yes
		MarkUnselectable	= No
	End
	WeaponSet
		Conditions = None 
		Weapon	   = PRIMARY MirkwoodRangerBow_Patrol
		Weapon	   = TERTIARY MirkwoodRangerBow_Patrol
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
	End
	
  	Behavior = SubObjectsUpgrade MagicArrows_Upgrade
  		TriggeredBy		= Upgrade_TechnologyMirkwoodSilverthornArrows
  		ShowSubObjects	= FireArowTip ArrowNockU	QARROWSU
  		HideSubObjects	= ArrowNock QARROWS
  	End	
	
	// Fire arrow upgrade
	Behavior = WeaponSetUpgrade ModuleTag_FireArrowParticlesAndLegalityUpgrade
		TriggeredBy		= Upgrade_TechnologyMirkwoodSilverthornArrows
	End
	Behavior = SlowDeathBehavior ModuleTag_05				; overriden to be faster, so we fall with the barricade rubble.
		DeathTypes			= ALL -KNOCKBACK
		SinkDelay			= 10
		SinkRate			= 1.50							; in Dist/Sec
		DestructionDelay	= 10000
		Sound				= INITIAL ElfGenericFemaleVoiceDie
	End
	
	Behavior = SubObjectsUpgrade Armor_Upgrade
		TriggeredBy		= Upgrade_Evilboyos
		; UpgradeTexture	= tugreenwood.tga 0 tugreenwood_HA.tga
;		UpgradeTexture	= eulorien2.tga 0 eulorienHA2.tga
;		UpgradeTexture	= eulorien3.tga 0 eulorienHA3.tga
		RecolorHouse			= Yes
		ExcludeSubobjects		= Forged_Blade
		; ShowSubObjects	= BODYHA VAMBRACES
		; HideSubObjects	= BODY1 BODY2 BODY3
	End
  	
  	Behavior = SubObjectsUpgrade HeavyArmorVisual_Upgrade
  		TriggeredBy		= Upgrade_Evilboyos
  		; ShowSubObjects	= BODYMHOODHA LEGGUARDSM ARMSMHA HOODMHA BODYMHA HOODMDOWNHA BODYFHOODHA LEGGUARDSF ARMSFHA HOODFHA BODYFHA HOODFDOWNHA  
		; HideSubObjects	= ARMSF ARMSM BODYM1 BODYM2 BODYM3 HOODMDOWN1 HOODMDOWN2 HOODMDOWN3 BODYMHOOD1 BODYMHOOD2 BODYMHOOD3 HOODM1 HOODM2 HOODM3 BODYF1 BODYF2 BODYF3 HOODFDOWN1 HOODFDOWN2 HOODFDOWN3 BODYFHOOD1 BODYFHOOD2 BODYFHOOD3 HOODF1 HOODF2 HOODF3
  	End
	
	Behavior = AttributeModifierUpgrade ModuleTag_ElvenGiftBonus
		TriggeredBy = Upgrade_Evilboyos
		AttributeModifier = SilverandJewels
	End	
	
End

Object MirkwoodRanger_SlavedForLookout

	SelectPortrait	= UPMirkwoodRangers

	Draw = W3DScriptedModelDraw ModuleTag_01  
		DefaultModelConditionState
			;Give it a model so it'll show up in WB
			Model               = tumirkarch_m  ;eugrnwdrngr_m1
		End
	End

	;***** IMPORTANT NOTE! ***************************************************************	
	;Certain Upgrades and costs may need to be propagated from here. One example was veterancy
	;overlays.
	;*************************************************************************************	

	Side = Mirkwood
	EditorSorting = UNIT
	BuildVariations = MirkwoodRanger1_SlavedForLookout MirkwoodRanger2_SlavedForLookout
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP IMMOBILE SUMMONED
	
  ;Shadow = SHADOW_DECAL
  ;ShadowSizeX = 24;
  ;ShadowSizeY = 24;
  ;ShadowTexture = ShadowI;

End

ChildObject MirkwoodRanger1_SlavedForLookout MirkwoodRanger1

	; make sure we can see all round.
	VisionSide			= 100%
	VisionRear			= 100%
	ShroudClearingRange	= 300
	ShockwaveResistance	= SHOCKWAVE_RESISTANCE_ALWAYS

	LocomotorSet
		Locomotor   = FloatingHumanLocomotor
		Condition   = SET_NORMAL
		Speed       = 0
	End

	VoiceCreated					  =	NoVoice	  
	VoiceFullyCreated				  =	NoVoice

	;//These guys are stuck in the barricade can't move and can't be attacked
	KindOf =  UNATTACKABLE NOT_AUTOACQUIRABLE

	Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 0
		GuardWanderRange	= 0
		UseSlaverAsControlForEvaObjectSightedEvents = No ; Not a creep
		DieOnMastersDeath	= Yes
		MarkUnselectable	= No
	End
	WeaponSet
		Conditions = None 
		Weapon	   = PRIMARY MirkwoodRangerBow_Lookout
		Weapon	   = TERTIARY MirkwoodRangerBow_Lookout
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
	End
	
  	Behavior = SubObjectsUpgrade MagicArrows_Upgrade
  		TriggeredBy		= Upgrade_ElvenSilverthornArrowsTower
  		ShowSubObjects	= FireArowTip ArrowNockU	QARROWSU
  		HideSubObjects	= ArrowNock QARROWS
  	End	
	
	// Fire arrow upgrade
	Behavior = WeaponSetUpgrade ModuleTag_FireArrowParticlesAndLegalityUpgrade
		TriggeredBy		= Upgrade_ElvenSilverthornArrowsTower
	End
	Behavior = SlowDeathBehavior ModuleTag_05				; overriden to be faster, so we fall with the barricade rubble.
		DeathTypes			= ALL -KNOCKBACK
		SinkDelay			= 10
		SinkRate			= 1.50							; in Dist/Sec
		DestructionDelay	= 10000
		Sound				= INITIAL SilvanElfGenericVoiceDie
	End
End

ChildObject MirkwoodRanger2_SlavedForLookout MirkwoodRanger2

	; make sure we can see all round.
	VisionSide			= 100%
	VisionRear			= 100%
	ShroudClearingRange	= 300
	ShockwaveResistance	= SHOCKWAVE_RESISTANCE_ALWAYS

	LocomotorSet
		Locomotor   = FloatingHumanLocomotor
		Condition   = SET_NORMAL
		Speed       = 0
	End

	VoiceCreated					  =	NoVoice	  
	VoiceFullyCreated				  =	NoVoice

	;//These guys are stuck in the barricade can't move and can't be attacked
	KindOf =  UNATTACKABLE NOT_AUTOACQUIRABLE

	Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 0
		GuardWanderRange	= 0
		UseSlaverAsControlForEvaObjectSightedEvents = No ; Not a creep
		DieOnMastersDeath	= Yes
		MarkUnselectable	= No
	End
	WeaponSet
		Conditions = None 
		Weapon	   = PRIMARY MirkwoodRangerBow_Lookout
		Weapon	   = TERTIARY MirkwoodRangerBow_Lookout
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
	End
	
  	Behavior = SubObjectsUpgrade MagicArrows_Upgrade
  		TriggeredBy		= Upgrade_ElvenSilverthornArrowsTower
  		ShowSubObjects	= FireArowTip ArrowNockU	QARROWSU
  		HideSubObjects	= ArrowNock QARROWS
  	End	
	
	// Fire arrow upgrade
	Behavior = WeaponSetUpgrade ModuleTag_FireArrowParticlesAndLegalityUpgrade
		TriggeredBy		= Upgrade_ElvenSilverthornArrowsTower
	End
	Behavior = SlowDeathBehavior ModuleTag_05				; overriden to be faster, so we fall with the barricade rubble.
		DeathTypes			= ALL -KNOCKBACK
		SinkDelay			= 10
		SinkRate			= 1.50							; in Dist/Sec
		DestructionDelay	= 10000
		Sound				= INITIAL ElfGenericFemaleVoiceDie
	End
End

Object MirkwoodTaurielRanger_Summoned

	SelectPortrait	= UPMirkwoodRangers

	Draw = W3DScriptedModelDraw ModuleTag_01  
		DefaultModelConditionState
			;Give it a model so it'll show up in WB
			Model               = tumirkarch_m  ;eugrnwdrngr_m1
		End
	End

	;***** IMPORTANT NOTE! ***************************************************************	
	;Certain Upgrades and costs may need to be propagated from here. One example was veterancy
	;overlays.
	;*************************************************************************************	

	Side = Mirkwood
	EditorSorting = UNIT
	BuildVariations = MirkwoodTaurielRanger_Summoned1 MirkwoodTaurielRanger_Summoned2
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP IMMOBILE SUMMONED
	
  ;Shadow = SHADOW_DECAL
  ;ShadowSizeX = 24;
  ;ShadowSizeY = 24;
  ;ShadowTexture = ShadowI;

End

//------------------------------------------------------------------------------
ChildObject MirkwoodTaurielRanger_Summoned1 MirkwoodRanger1
	;EquivalentTo					= MirkwoodRanger
	IsTrainable						= No
	KindOf							= +SUMMONED +IMMOBILE
	CommandPoints = 0
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	// This one does the work, but the one in the horde displays the timer
		MinLifetime		= DUNEDAIN_ALLIES_LIFETIME
		MaxLifetime		= DUNEDAIN_ALLIES_LIFETIME
		DeathType		= FADED
	End
  	Behavior = SlowDeathBehavior ModuleTag_SlowDeathFaded
		DeathTypes			= NONE +FADED
		FadeDelay			= 0
		FadeTime			= 5000
		DestructionDelay	= 5000
        DeathFlags			= DEATH_2
        FX					= INITIAL FX_UnSummonElvenAllies
		Sound				= INITIAL SpellGenericUnsummonFasterMS
	End
	VoiceMove 									= NoVoice
	VoiceMoveToCamp 							= NoVoice
	VoiceMoveToHigherGround						= NoVoice
	VoiceMoveWhileAttacking 					= NoVoice
End

//------------------------------------------------------------------------------
ChildObject MirkwoodTaurielRanger_Summoned2 MirkwoodRanger2
	;EquivalentTo					= MirkwoodRanger
	IsTrainable						= No
	KindOf							= +SUMMONED +IMMOBILE
	CommandPoints = 0
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	// This one does the work, but the one in the horde displays the timer
		MinLifetime		= DUNEDAIN_ALLIES_LIFETIME
		MaxLifetime		= DUNEDAIN_ALLIES_LIFETIME
		DeathType		= FADED
	End
  	Behavior = SlowDeathBehavior ModuleTag_SlowDeathFaded
		DeathTypes			= NONE +FADED
		FadeDelay			= 0
		FadeTime			= 5000
		DestructionDelay	= 5000
        DeathFlags			= DEATH_2
        FX					= INITIAL FX_UnSummonElvenAllies
		Sound				= INITIAL SpellGenericUnsummonFasterMS
	End	
	VoiceMove 									= NoVoice
	VoiceMoveToCamp 							= NoVoice
	VoiceMoveToHigherGround						= NoVoice
	VoiceMoveWhileAttacking 					= NoVoice	
End

Object MirkwoodFerenRanger_Summoned

	SelectPortrait	= UPMirkwoodRangers

	Draw = W3DScriptedModelDraw ModuleTag_01  
		DefaultModelConditionState
			;Give it a model so it'll show up in WB
			Model               = tumirkarch_m  ;eugrnwdrngr_m1
		End
	End

	;***** IMPORTANT NOTE! ***************************************************************	
	;Certain Upgrades and costs may need to be propagated from here. One example was veterancy
	;overlays.
	;*************************************************************************************	

	Side = Mirkwood
	EditorSorting = UNIT
	BuildVariations = MirkwoodFerenRanger_Summoned1 MirkwoodFerenRanger_Summoned2
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP IMMOBILE SUMMONED
	
  ;Shadow = SHADOW_DECAL
  ;ShadowSizeX = 24;
  ;ShadowSizeY = 24;
  ;ShadowTexture = ShadowI;

End

//------------------------------------------------------------------------------
ChildObject MirkwoodFerenRanger_Summoned1 MirkwoodRanger1
	;EquivalentTo					= MirkwoodRanger
	IsTrainable						= No
	KindOf							= +SUMMONED
	CommandPoints = 0
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	// This one does the work, but the one in the horde displays the timer
		MinLifetime		= 60000 ;CREATE_A_HERO_REINFORCEMENT_LIFETIME
		MaxLifetime		= 60000 ;CREATE_A_HERO_REINFORCEMENT_LIFETIME
		DeathType		= FADED
	End
  	Behavior = SlowDeathBehavior ModuleTag_SlowDeathFaded
		DeathTypes			= NONE +FADED
		FadeDelay			= 0
		FadeTime			= 5000
		DestructionDelay	= 5000
        DeathFlags			= DEATH_2
        FX					= INITIAL FX_UnSummonElvenAllies
		Sound				= INITIAL SpellGenericUnsummonFasterMS
	End
End
//------------------------------------------------------------------------------
ChildObject MirkwoodFerenRanger_Summoned2 MirkwoodRanger2
	;EquivalentTo					= MirkwoodRanger
	IsTrainable						= No
	KindOf							= +SUMMONED
	CommandPoints = 0
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	// This one does the work, but the one in the horde displays the timer
		MinLifetime		= 60000 ;CREATE_A_HERO_REINFORCEMENT_LIFETIME
		MaxLifetime		= 60000 ;CREATE_A_HERO_REINFORCEMENT_LIFETIME
		DeathType		= FADED
	End
  	Behavior = SlowDeathBehavior ModuleTag_SlowDeathFaded
		DeathTypes			= NONE +FADED
		FadeDelay			= 0
		FadeTime			= 5000
		DestructionDelay	= 5000
        DeathFlags			= DEATH_2
        FX					= INITIAL FX_UnSummonElvenAllies
		Sound				= INITIAL SpellGenericUnsummonFasterMS
	End	
End
//------------------------------------------------------------------------------
Object MirkwoodLorienRanger_Summoned

	SelectPortrait	= UPLothlorienSummonedRangers

	Draw = W3DScriptedModelDraw ModuleTag_01a 
		DefaultModelConditionState
			;Give it a model so it'll show up in WB
			Model               = tumirkarch_m  ;eugrnwdrngr_m1
		End
	End

	;***** IMPORTANT NOTE! ***************************************************************	
	;Certain Upgrades and costs may need to be propagated from here. One example was veterancy
	;overlays.
	;*************************************************************************************	

	Side = Mirkwood
	EditorSorting = UNIT
	BuildVariations = MirkwoodLorienRanger_Summoned1 MirkwoodLorienRanger_Summoned2
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP IMMOBILE SUMMONED
	
  ;Shadow = SHADOW_DECAL
  ;ShadowSizeX = 24;
  ;ShadowSizeY = 24;
  ;ShadowTexture = ShadowI;

End
//------------------------------------------------------------------------------
ChildObject MirkwoodLorienRanger_Summoned1 MirkwoodRanger1
SelectPortrait	= UPLothlorienSummonedRangers
	;EquivalentTo					= MirkwoodRanger
	IsTrainable						= No
	KindOf							= +SUMMONED
	CommandPoints = 0
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	// This one does the work, but the one in the horde displays the timer
		MinLifetime		= 120000 ;CREATE_A_HERO_REINFORCEMENT_LIFETIME
		MaxLifetime		= 120000 ;CREATE_A_HERO_REINFORCEMENT_LIFETIME
		DeathType		= FADED
	End
  	Behavior = SlowDeathBehavior ModuleTag_SlowDeathFaded
		DeathTypes			= NONE +FADED
		FadeDelay			= 0
		FadeTime			= 5000
		DestructionDelay	= 5000
        DeathFlags			= DEATH_2
        FX					= INITIAL FX_UnSummonElvenAllies
		Sound				= INITIAL SpellGenericUnsummonFasterMS
	End
End
//----------------------------------------------------------------------------
ChildObject MirkwoodLorienRanger_Summoned2 MirkwoodRanger2
SelectPortrait	= UPLothlorienSummonedRangers
	;EquivalentTo					= MirkwoodRanger
	IsTrainable						= No
	KindOf							= +SUMMONED
	CommandPoints = 0
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	// This one does the work, but the one in the horde displays the timer
		MinLifetime		= 120000 ;CREATE_A_HERO_REINFORCEMENT_LIFETIME
		MaxLifetime		= 120000 ;CREATE_A_HERO_REINFORCEMENT_LIFETIME
		DeathType		= FADED
	End
  	Behavior = SlowDeathBehavior ModuleTag_SlowDeathFaded
		DeathTypes			= NONE +FADED
		FadeDelay			= 0
		FadeTime			= 5000
		DestructionDelay	= 5000
        DeathFlags			= DEATH_2
        FX					= INITIAL FX_UnSummonElvenAllies
		Sound				= INITIAL SpellGenericUnsummonFasterMS
	End	
End