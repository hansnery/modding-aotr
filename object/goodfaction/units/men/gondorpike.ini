Object GondorSpearmen
	;Scale		= 1.05
	SelectPortrait     = UPGondorPikemannew
	ButtonImage	   = UIAnorienSpearmen
	Draw = W3DScriptedModelDraw ModuleTag_01 
		OkToChangeModelColor = Yes
		StaticModelLODMode = yes
        DefaultModelConditionState
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        ModelConditionState WEAPONSET_PLAYER_UPGRADE
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        ModelConditionState WEAPONSET_TOGGLE_1
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        AnimationState        = THROWN_PROJECTILE
            Animation           = FLYA
                AnimationName     = GUTwrGrd_FLYA
                AnimationMode     = LOOP
            End
        End
        AnimationState                            = PASSENGER FREEFALL
            Animation                            = Grabbed
                AnimationName                    = GUTwrGrd_FLLA
                AnimationMode                    = LOOP
            End
        End
        AnimationState                            = FREEFALL
            Animation                            = Falling
                AnimationName                    = GUTwrGrd_FLYA
                AnimationMode                    = LOOP
                AnimationBlendTime                = 10
            End
        End
        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
        End
		AnimationState						= DYING DEATH_2
            Animation                    = IDLB
                AnimationName            = GUTwrGrd_IDLB
                AnimationMode            = ONCE
                AnimationBlendTime        = 15
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation                    = IDLC
                AnimationName            = GUTwrGrd_IDLC
                AnimationMode            = ONCE
                AnimationBlendTime        = 9
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation                    = IDLE
                AnimationName            = GUTwrGrd_IDLE
                AnimationMode            = ONCE
                AnimationBlendTime        = 9
                AnimationSpeedFactorRange = 0.8 1.2
            End
		End			
        AnimationState                = DYING BURNINGDEATH
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEA
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEB
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEC
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
        End
        AnimationState        = DYING SPLATTED
            Animation           = LNDA
                AnimationName     = GUTwrGrd_LNDA
                AnimationMode     = ONCE
            End
        End
        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End
        AnimationState                        = BURNINGDEATH
            Animation
                AnimationName                = GUTwrGrd_MFDA
                AnimationMode                = LOOP
                Distance                    = 60
            End
        End
        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUSPR_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART  
        End
//=======TERROR
        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            ShareAnimation                = Yes
            Animation                    = TerrorFromTheSky
                AnimationName            = GUSPR_RUNE
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            ShareAnimation                = Yes
            Animation                    = Terror
                AnimationName            = GUSPR_RUNE
                AnimationMode            = LOOP
            End
        End
//----------------
//=======BACK UP
        AnimationState                =    MOVING BACKING_UP
            ShareAnimation = Yes
            Animation                =    BackingUp
                AnimationName        =    GUTwrGrd_BAKA
                AnimationMode        =    LOOP
            End
            Animation                =    BackingUp
                AnimationName        =    GUTwrGrd_BAKB
                AnimationMode        =    LOOP
            End            
            Flags                    =    RANDOMSTART 
        End
//--------------------
	AnimationState  = COMING_OUT_OF_FACTORY
		Animation = Being_Built
			AnimationName		= GUTwrGrd_RUNC
			AnimationMode		= LOOP
			AnimationBlendTime	= 0
		End
	End
        AnimationState        = MOVING ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = guspr_phlnxb ;GUTwrGrd_WLKA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING ALTERNATE_FORMATION 
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = guspr_phlnxc
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING ATTACKING
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_RUNC
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING
            ShareAnimation = Yes
            Animation
                AnimationName     = GUTwrGrd_RUNB
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End

        AnimationState        =  FIRING_OR_PREATTACK_A ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            Animation           = ATKA
                AnimationName     = guspr_phlnxatk
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKA
                AnimationName     = guspr_phlnxatka
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            ParticleSysBone     = None MeleeDust
        End

        AnimationState        =  FIRING_OR_PREATTACK_A ALTERNATE_FORMATION
            Animation           = ATKA
                AnimationName     = guspr_phlnxatk
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKA
                AnimationName     = guspr_phlnxatka
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            ParticleSysBone     = None MeleeDust
        End

        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = GUTwrGrd_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKA
                AnimationName     = GUTwrGrd_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKC
                AnimationName     = GUTwrGrd_ATKC
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
;            ParticleSysBone     = None MeleeDust
        End
        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = GUTwrGrd_FLYA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
        End
        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = GUTwrGrd_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = GUTwrGrd_LNDA
                AnimationMode     = ONCE
            End
        End
;        TransitionState       = TRANS_Plant
;            Animation           = PLTA
;                AnimationName     = GUTwrGrd_PLTA
;                AnimationMode     = ONCE
;                AnimationSpeedFactorRange = 0.8 1.2
;            End
;        End
;        TransitionState       = TRANS_Unplant
;            Animation           = PLTB
;                AnimationName     = GUTwrGrd_PLTC
;                AnimationMode     = ONCE
;                AnimationSpeedFactorRange = 0.5 1.2
;            End
;        End
//------------------ Hit Reaction ---------------------------------------
        AnimationState                        = HIT_REACTION
            Animation                        = HIT REACTION
                AnimationName                = GUTwrGrd_HITA
                AnimationMode                = ONCE
            End
        End
//------------------ EMOTIONS -------------------------------------------
//======= APPREHENSIVE
        AnimationState                    = EMOTION_ALERT EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = Apprehensive
                AnimationName            = GUSPR_FERA
                AnimationMode            = LOOP    //Change this to ONCE if adding additional anims
            End
            Flags                        = RANDOMSTART
        End
//======= AFRAID
        AnimationState                    = EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = FERA
                AnimationName            = GUSPR_FERA
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End
//======= TAUNTING
        AnimationState                    = EMOTION_TAUNTING ALTERNATE_FORMATION
            Animation                    = TNTA
                AnimationName            = GUTwrGrd_TNTA
                AnimationMode            = LOOP
            End
            Animation                    = TNTA
                AnimationName            = GUTwrGrd_TNTB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = GUTwrGrd_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting2
                AnimationName            = GUTwrGrd_TNTB
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
//======= POINTING
        AnimationState                    = EMOTION_POINTING
            Animation                    = Pointing1
                AnimationName            = GUTwrGrd_PNTA
                AnimationMode            = LOOP
            End
            Animation                    = Pointing1
                AnimationName            = GUTwrGrd_PNTB
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End
//======= CELEBRATING
        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRA
                AnimationMode            = LOOP
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRB
                AnimationMode            = LOOP
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRC
                AnimationMode            = LOOP
            End
        End
//-------------- ALERT STATE ------------------------------------------------------------
        AnimationState                    = EMOTION_ALERT
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_IDLA
                AnimationMode            = LOOP
            End
        End
//-------------- SELECTED & IDLE --------------------------------------------------------
//======== SELECTED
        AnimationState                    = SELECTED ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            Animation
                AnimationName                = guspr_phlnxbi2 ;GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
            Animation
                AnimationName                = guspr_phlnxbi3 ;GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
			Flags							= RANDOMSTART
        End
        AnimationState                    = SELECTED ALTERNATE_FORMATION // PORCUPINE
            Animation
                AnimationName                = guspr_phlnxci2 ;GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
            Animation
                AnimationName                = guspr_phlnxci3 ;GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
			Flags							= RANDOMSTART
        End
        AnimationState                        = ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            Animation
                AnimationName                = guspr_phlnxbi2 ;GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
            Animation
                AnimationName                = guspr_phlnxbi3 ;GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
			Flags							= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRA
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRB
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRC
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                    = SELECTED
            StateName                    = STATE_Selected
            ShareAnimation                = Yes
            Animation                    = ATNB
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End
//======== IDLE
        AnimationState                    = ALTERNATE_FORMATION //PORCUPINE    //    aka Porcupine formation
            StateName                    = STATE_Planted
            //ShareAnimation                = Yes
            Animation
                AnimationName                = guspr_phlnxci ;GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
            Animation
                AnimationName                = guspr_phlnxci2 ;GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
            Animation
                AnimationName                = guspr_phlnxci3 ;GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
            Animation
                AnimationName                = guspr_phlnxci4 ;GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
			Flags							= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
;            BeginScript
;                Prev = CurDrawablePrevAnimationState()
;                if Prev ~= "STATE_SelectedAlternateFormation" and Prev ~= "STATE_Planted" and Prev ~= "TRANS_Plant" then CurDrawableSetTransitionAnimState("TRANS_Plant") end
;            EndScript
        End
        IdleAnimationState
            StateName                    = STATE_Idle
            Animation                    = IDLB
                AnimationName            = GUTwrGrd_IDLB
                AnimationMode            = ONCE
                AnimationBlendTime        = 15
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation                    = IDLC
                AnimationName            = GUTwrGrd_IDLC
                AnimationMode            = ONCE
                AnimationBlendTime        = 9
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation                    = IDLE
                AnimationName            = GUTwrGrd_IDLE
                AnimationMode            = ONCE
                AnimationBlendTime        = 9
                AnimationSpeedFactorRange = 0.8 1.2
            End
;            BeginScript
;                Prev = CurDrawablePrevAnimationState()
;                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
;            EndScript
        End
//-------------------------------------------------------------------------------------------------------------
    End
    #include "..\..\..\includes\StunDrawModuleSmall.inc"
	// ***DESIGN parameters ***
	Side 			= Men
	EditorSorting 		= UNIT
	ThreatLevel 		= 1.0
	ThingClass 		= HORDE_UNIT
	CommandPoints 		= 5				
	BountyValue 		= 10 ;GONDOR_SPEARMEN_BOUNTY_VALUE
	TransportSlotCount 	= TRANSPORTSLOTCOUNT_UNIT
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    MidEndPike
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	ArmorSet
		Conditions      = None
		Armor           = TowerGuardArmor
		DamageFX        = NormalDamageFX
	End
	ArmorSet
		Conditions	= PLAYER_UPGRADE
		Armor		= TowerGuardHeavyArmor
		DamageFX	= NormalDamageFX
	End
	VisionRange = GONDOR_SPEARMEN_VISION_RANGE
	ShroudClearingRange = SHROUD_CLEAR_STANDARD
	VisionSide = 35%
	VisionRear = 25%
	MaxVisionBonusPercent = 300%
	VisionBonusTestRadius = 200
	VisionBonusPercentPerFoot = 2.0%
	DisplayName 		= OBJECT:GondorSpearmen
	CrushableLevel 		= 0
	CrushRevengeWeapon 	= SuperInfantryCrushRevenge
	CommandSet = GondorPikeCommandSet
	VoiceAttack 				= SPGondorSoldierVoiceAttack
	VoiceAttackCharge 			= SPGondorSoldierVoiceAttackCharge
	VoiceAttackStructure 			= SPGondorSoldierVoiceAttackBuilding
	VoiceAttackMachine 			= SPGondorSoldierVoiceAttack
	VoiceCreated 				= SPGondorSoldierVoiceSalute
	VoiceFullyCreated 			= SPGondorSoldierVoiceSalute
	VoiceGuard				= SPGondorSoldierVoiceMove
	VoiceMove 				= SPGondorSoldierVoiceMove
	VoiceMoveToCamp 			= SPGondorSoldierVoiceMoveCamp
	VoiceMoveWhileAttacking 		= SPGondorSoldierVoiceDisengage
	VoicePriority				= 30
	VoiceRetreatToCastle 			= SPGondorSoldierVoiceRetreat
	VoiceSelect 				= SPGondorSoldierVoiceSelectMS
	VoiceSelectBattle  			= SPGondorSoldierVoiceSelectBattle
	VoiceEnterStateAttack 			= SPGondorSoldierVoiceEnterStateAttack
	VoiceEnterStateAttackCharge 		= SPGondorSoldierVoiceEnterStateAttackCharge
	VoiceEnterStateAttackStructure 		= SPGondorSoldierVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackMachine 		= SPGondorSoldierVoiceEnterStateAttackBuilding
	VoiceEnterStateMove 			= SPGondorSoldierVoiceEnterStateMove
	VoiceEnterStateMoveToCamp 		= SPGondorSoldierVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking 	= SPGondorSoldierVoiceEnterStateDisengage
	VoiceEnterStateRetreatToCastle		= SPGondorSoldierVoiceEnterStateRetreat
	SoundImpact				= ImpactHorse
	CrowdResponseKey = GoodMen
	UnitSpecificSounds
		VoiceGarrison			= SPGondorSoldierVoiceGarrison    
	End
    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
	ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
		ModelCondition = Required:RAISING_FLAG		Excluded:DYING ENGAGED	Sound:EmotionMenGoodCompilationBFME1and2VoxTauntSinglesLoop
	End
    // Tie into LargeGroupAudio system
    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Gondor_Guard
    End
    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:TauntHitShieldPitchShifted    Animation:GUTwrGrd_SKL.GUTwrGrd_TNTB    Frames: 23 43
        AnimationSound = Sound:BodyFallGeneric1        Animation:GUTWRGRD_SKL.GUTWRGRD_DIEA    Frames:30 51
        AnimationSound = Sound:BodyFallGeneric1        Animation:GUTWRGRD_SKL.GUTWRGRD_DIEB    Frames:57
        AnimationSound = Sound:BodyFallGeneric1        Animation:GUTWRGRD_SKL.GUTWRGRD_DIEC    Frames:38
        AnimationSound = Sound:BodyFallSoldier        Animation:GUTWRGRD_SKL.GUTWRGRD_LNDA    Frames:4
        AnimationSound = Sound:BodyFallSoldier        Animation:GUTwrGrd_SKL.GUTwrGrd_LNDB    Frames:2
    End
	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP PIKE
	Body					=	PorcupineFormationBodyModule ModuleTag_porcupineFormation
		MaxHealth			=	275 ;250 ;GONDOR_SPEARMEN_HEALTH
		MaxHealthDamaged		=	GONDOR_SPEARMEN_HEALTH_DAMAGED
		DamageWeaponTemplate		=	PikemenPorcupineDamage
		CrushDamageWeaponTemplate	=	PikemenPorcupineCrushDamage
		CrusherLevelResisted		=	2
		BurningDeathBehavior = Yes
		BurningDeathFX       = FX_InfantryBurningFlame
		CheerRadius = EMOTION_CHEER_RADIUS
	End
	
	;Wambly's Notes - Updated AI Preferences
	Behavior = AIUpdateInterface ModuleTag_03
		;AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
		AutoAcquireEnemiesWhenIdle	= Yes 
		MoodAttackCheckRate			= 500
		AILuaEventsList				= GondorFighterFunctions
		;AttackPriority				= AttackPriority_Spearman
		AttackPriority				= AttackPriority_PIKEMAN
		BurningDeathTime			= BURNINGDEATH_DURATION_INFANTRY
	End
	
	LocomotorSet
		Locomotor = HumanLocomotor
		Condition = SET_NORMAL 
		Speed     = NORMAL_FOOT_MED_MEMBER_SPEED	
	End
	LocomotorSet
		Locomotor = BurningDeathLocomotorInfantry
		Condition = SET_BURNINGDEATH
		Speed     = BURNINGDEATH_WANDERSPEED_INFANTRY	
	End 
	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult 		= 1.0
		ShockStunnedTimeLow	= 1400		//msec
		ShockStunnedTimeHigh	= 2400		//msec
		ShockStandingTime	= 1333		//msec
	End
	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes 	= ALL -KNOCKBACK -FADED
		SinkDelay 	= 3000
		SinkRate 	= 0.60
		DestructionDelay = 8000
            Sound = INITIAL GondorianHumanVoiceDie
	End
	Behavior = SlowDeathBehavior ModuleTag_FadeDeath
		DeathTypes = NONE +FADED
		FadeDelay = 0
		FadeTime = 5000
		DestructionDelay = 5000
		DeathFlags = DEATH_2
		Sound = INITIAL SpellGenericUnsummonFasterMS
	End
	
 	Behavior = ArmorUpgrade ModuleTag_ArmorUpgradeDrafted
		TriggeredBy = Upgrade_Drafted
		IgnoreArmorUpgrade = Yes
	End
	Behavior = RepairSpecialPower ModuleTag_RepairSPecialPower
		SpecialPowerTemplate      = SpecialRepairStructure
	End		
 	Behavior = WeaponSetUpgrade ModuleTag_Weaponpgrade
		TriggeredBy = Upgrade_GondorForgedBlades
	End
 	Behavior = ArmorUpgrade ModuleTag_ArmorUpgrade
		TriggeredBy 	= Upgrade_GondorHeavyArmor
		ArmorSetFlag	= PLAYER_UPGRADE
	End
	Behavior = SubObjectsUpgrade Armor_Upgrade
		TriggeredBy	= Upgrade_GondorHeavyArmor
	        ; UpgradeTexture	= gugondorian.tga 0 gugondorian_HA.tga
	        ; UpgradeTexture	= gugondorian2.tga 0 gugondorian2_HA.tga
	        ; UpgradeTexture	= gugondorian3.tga 0 gugondorian3_HA.tga
	        ; UpgradeTexture	= gugondorian4.tga 0 gugondorian4_HA.tga
	        ; UpgradeTexture	= gugondorian5.tga 0 gugondorian5_HA.tga
		RecolorHouse	= Yes
		ShowSubObjects	= HIPS SPAULDERS ;SHLDR BRACERS BODYHA
		;HideSubObjects	= BODYLA
		ExcludeSubobjects = Forged_Blade
	End
	Behavior = SubObjectsUpgrade ForgedBlade_Upgrade
		TriggeredBy	= Upgrade_GondorForgedBlades
		ShowSubObjects	= FORGED_BLADE
	End
	Behavior = SubObjectsUpgrade Drafted_Upgrade
		TriggeredBy	= Upgrade_Drafted
	End
	Behavior = SquishCollide ModuleTag_06
	End
	Behavior = HordeMemberCollide ModuleTag_HMC
	End
	Behavior = SlowDeathBehavior ModuleTag_07
		// Same as normal death, but no sound (sound already played by SoundImpact = ... )
		DeathTypes = NONE +KNOCKBACK
		SinkDelay = 3000
		SinkRate = 0.40     // in Dist/Sec
		DestructionDelay = 8000
	End

	Behavior = BezierProjectileBehavior ModuleTag_08
		FirstHeight = 24
		SecondHeight = 24
		FirstPercentIndent = 30%
		SecondPercentIndent = 70%
		TumbleRandomly = Yes
		CrushStyle = Yes
		DieOnImpact = Yes
		BounceCount = 1
		BounceDistance = 40
		BounceFirstHeight = 16
		BounceSecondHeight = 16
		BounceFirstPercentIndent = 20%
		BounceSecondPercentIndent = 80%
		GroundHitFX       = FX_ThrownRockGroundHit
		GroundBounceFX    = FX_ThrownRockBounceHit
	End
	Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
		HitReactionLifeTimer1 = 2333
		HitReactionLifeTimer2 = 2333
		HitReactionLifeTimer3 = 2333
		HitReactionThreshold1 = 5.0
		HitReactionThreshold2 = 25.0
		HitReactionThreshold3 = 50.0
		FastHitsResetReaction = Yes
	End
	Geometry 	= CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight 	= 19.2
	GeometryIsSmall = Yes
  	Shadow 		= SHADOW_DECAL
  	ShadowSizeX 	= 19
  	ShadowSizeY 	= 19
  	ShadowTexture 	= ShadowI
End

ChildObject GondorSpearmen_Patrol GondorSpearmen
	;Scale		= 1.05
	SelectPortrait     = UPGondor_Pike
	ButtonImage	   = BGBarracks_Pikemen
	Draw = W3DScriptedModelDraw ModuleTag_01  
		OkToChangeModelColor = Yes
		StaticModelLODMode = yes
        DefaultModelConditionState
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        ModelConditionState WEAPONSET_PLAYER_UPGRADE
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        ModelConditionState WEAPONSET_TOGGLE_1
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        AnimationState        = THROWN_PROJECTILE
            Animation           = FLYA
                AnimationName     = GUTwrGrd_FLYA
                AnimationMode     = LOOP
            End
        End
        AnimationState                            = PASSENGER FREEFALL
            Animation                            = Grabbed
                AnimationName                    = GUTwrGrd_FLLA
                AnimationMode                    = LOOP
            End
        End
        AnimationState                            = FREEFALL
            Animation                            = Falling
                AnimationName                    = GUTwrGrd_FLYA
                AnimationMode                    = LOOP
                AnimationBlendTime                = 10
            End
        End
        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
        End		
        AnimationState                = DYING BURNINGDEATH
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEA
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEB
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEC
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
        End
        AnimationState        = DYING SPLATTED
            Animation           = LNDA
                AnimationName     = GUTwrGrd_LNDA
                AnimationMode     = ONCE
            End
        End	
        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End
        AnimationState                        = BURNINGDEATH
            Animation
                AnimationName                = GUTwrGrd_MFDA
                AnimationMode                = LOOP
                Distance                    = 60
            End
        End
        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUTwrGrd_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART  
        End
//=======TERROR
        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            ShareAnimation                = Yes
            Animation                    = TerrorFromTheSky
                AnimationName            = GUTwrGrd_RUNE
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            ShareAnimation                = Yes
            Animation                    = Terror
                AnimationName            = GUTwrGrd_RUNE
                AnimationMode            = LOOP
            End
        End
//----------------
//=======BACK UP
        AnimationState                =    MOVING BACKING_UP
            ShareAnimation = Yes
            Animation                =    BackingUp
                AnimationName        =    GUTwrGrd_BAKA
                AnimationMode        =    LOOP
            End
            Animation                =    BackingUp
                AnimationName        =    GUTwrGrd_BAKB
                AnimationMode        =    LOOP
            End            
            Flags                    =    RANDOMSTART 
        End
//--------------------
	AnimationState  = COMING_OUT_OF_FACTORY
		Animation = Being_Built
			AnimationName		= GUTwrGrd_RUNC
			AnimationMode		= LOOP
			AnimationBlendTime	= 0
		End
            ParticleSysBone     = None InfantryDustTrails
	End
        AnimationState        = MOVING ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_WLKA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING ALTERNATE_FORMATION 
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_WLKB
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING ATTACKING
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_RUNC
                AnimationMode     = LOOP
            End
            Animation
                AnimationName     = GUTwrGrd_RUND
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING
            ShareAnimation = Yes
            Animation           = RUNA
                AnimationName     = GUTwrGrd_WLKA
                AnimationMode     = LOOP
            End
            Animation           = RUNB
                AnimationName     = guspr_wlka
                AnimationMode     = LOOP
            End
            Animation           = RUNC
                AnimationName     = guspr_wlkb
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = GUTwrGrd_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKA
                AnimationName     = GUTwrGrd_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            //ParticleSysBone     = None MeleeDust
        End
        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = GUTwrGrd_FLYA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
        End
        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = GUTwrGrd_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = GUTwrGrd_LNDA
                AnimationMode     = ONCE
            End
        End
        TransitionState       = TRANS_Plant
            Animation           = PLTA
                AnimationName     = GUTwrGrd_PLTA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End
        TransitionState       = TRANS_Unplant
            Animation           = PLTB
                AnimationName     = GUTwrGrd_PLTC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.5 1.2
            End
        End
//------------------ Hit Reaction ---------------------------------------
        AnimationState                        = HIT_REACTION
            Animation                        = HIT REACTION
                AnimationName                = GUTwrGrd_HITA
                AnimationMode                = ONCE
            End
        End
//------------------ EMOTIONS -------------------------------------------
//======= APPREHENSIVE
        AnimationState                    = EMOTION_ALERT EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = Apprehensive
                AnimationName            = GUTwrGrd_FERA
                AnimationMode            = LOOP    //Change this to ONCE if adding additional anims
            End
            Flags                        = RANDOMSTART
        End
//======= AFRAID
        AnimationState                    = EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = FERA
                AnimationName            = GUTwrGrd_FERA
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End
//======= TAUNTING
        AnimationState                    = EMOTION_TAUNTING ALTERNATE_FORMATION
            Animation                    = TNTA
                AnimationName            = GUTwrGrd_TNTA
                AnimationMode            = LOOP
            End
            Animation                    = TNTA
                AnimationName            = GUTwrGrd_TNTB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = GUTwrGrd_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting2
                AnimationName            = GUTwrGrd_TNTB
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
//======= POINTING
        AnimationState                    = EMOTION_POINTING
            Animation                    = Pointing1
                AnimationName            = GUTwrGrd_PNTA
                AnimationMode            = LOOP
            End
            Animation                    = Pointing1
                AnimationName            = GUTwrGrd_PNTB
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End
//======= CELEBRATING
        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRA
                AnimationMode            = LOOP
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRB
                AnimationMode            = LOOP
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRC
                AnimationMode            = LOOP
            End
        End
//-------------- ALERT STATE ------------------------------------------------------------
        AnimationState                    = EMOTION_ALERT
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_IDLA
                AnimationMode            = LOOP
            End
        End
//-------------- SELECTED & IDLE --------------------------------------------------------
//======== SELECTED
        AnimationState                    = SELECTED ALTERNATE_FORMATION // PORCUPINE
            //ShareAnimation                = Yes
            StateName                    = STATE_SelectedAlternateFormation
            Animation
                AnimationName            = GUTwrGrd_PLTB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev ~= "STATE_SelectedAlternateFormation" and Prev ~= "STATE_Planted" and Prev ~= "TRANS_Plant" then CurDrawableSetTransitionAnimState("TRANS_Plant") end
            EndScript
        End
        AnimationState                    = SELECTED ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            //ShareAnimation                = Yes 
            StateName                    = STATE_SelectedAlternateFormation
            Animation
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                        = ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            Animation
                AnimationName                = GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRA
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRB
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRC
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                    = SELECTED
            StateName                    = STATE_Selected
            ShareAnimation                = Yes
            Animation                    = ATNB
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End
//======== IDLE
        AnimationState                    = ALTERNATE_FORMATION //PORCUPINE    //    aka Porcupine formation
            StateName                    = STATE_Planted
            //ShareAnimation                = Yes
            Animation                    = IDLB
                AnimationName            = GUTwrGrd_PLTB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev ~= "STATE_SelectedAlternateFormation" and Prev ~= "STATE_Planted" and Prev ~= "TRANS_Plant" then CurDrawableSetTransitionAnimState("TRANS_Plant") end
            EndScript
        End
        IdleAnimationState
            StateName                    = STATE_Idle
            Animation                    = IDLB
                AnimationName            = GUTwrGrd_IDLB
                AnimationMode            = ONCE
                AnimationBlendTime        = 15
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation                    = IDLC
                AnimationName            = GUTwrGrd_IDLC
                AnimationMode            = ONCE
                AnimationBlendTime        = 9
                AnimationSpeedFactorRange = 0.8 1.2
            End
//            Animation                    = IDLD
//                AnimationName            = GUTwrGrd_IDLD
//                AnimationMode            = ONCE
//                AnimationBlendTime        = 9
//                AnimationSpeedFactorRange = 0.8 1.2
//            End
            Animation                    = IDLE
                AnimationName            = GUTwrGrd_IDLE
                AnimationMode            = ONCE
                AnimationBlendTime        = 9
                AnimationSpeedFactorRange = 0.8 1.2
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End
//-------------------------------------------------------------------------------------------------------------
    End
	CommandPoints = 0

	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    MidEndPike_Patrol
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End

	Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 100.0
		GuardWanderRange	= 100.0
		DieOnMastersDeath	= Yes
		MarkUnselectable	= Yes
	End

 	Behavior = WeaponSetUpgrade ModuleTag_Weaponpgrade
		TriggeredBy = Upgrade_TechnologyGondorForgedBlades
	End
 	Behavior = ArmorUpgrade ModuleTag_ArmorUpgrade
		TriggeredBy 	= Upgrade_TechnologyGondorHeavyArmor
		ArmorSetFlag	= PLAYER_UPGRADE
	End
	Behavior = SubObjectsUpgrade Armor_Upgrade
		TriggeredBy	= Upgrade_TechnologyGondorHeavyArmor
	        ; UpgradeTexture	= gugondorian.tga 0 gugondorian_HA.tga
	        ; UpgradeTexture	= gugondorian2.tga 0 gugondorian2_HA.tga
	        ; UpgradeTexture	= gugondorian3.tga 0 gugondorian3_HA.tga
	        ; UpgradeTexture	= gugondorian4.tga 0 gugondorian4_HA.tga
	        ; UpgradeTexture	= gugondorian5.tga 0 gugondorian5_HA.tga
		RecolorHouse	= Yes
		ShowSubObjects	= HIPS SPAULDERS ;SHLDR BRACERS
		ExcludeSubobjects = Forged_Blade
	End
	Behavior = SubObjectsUpgrade ForgedBlade_Upgrade
		TriggeredBy	= Upgrade_TechnologyGondorForgedBlades
		ShowSubObjects	= FORGED_BLADE
	End

	LocomotorSet
		Locomotor = PatrolLocomotor ; HumanLocomotor
		Condition = SET_NORMAL 
		Speed     = 16 ;NORMAL_FOOT_MED_MEMBER_SPEED
	End

	LocomotorSet
		Locomotor = BurningDeathLocomotorInfantry
		Condition = SET_BURNINGDEATH
		Speed	  = BURNINGDEATH_WANDERSPEED_INFANTRY
	End

End

ChildObject GondorSpearmen_Tower GondorSpearmen
	;Scale		= 1.05
	SelectPortrait     = UPGondor_Pike
	ButtonImage	   = BGBarracks_Pikemen
	Draw = W3DScriptedModelDraw ModuleTag_01  
		OkToChangeModelColor = Yes
		StaticModelLODMode = yes
        DefaultModelConditionState
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        ModelConditionState WEAPONSET_PLAYER_UPGRADE
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        ModelConditionState WEAPONSET_TOGGLE_1
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        AnimationState        = THROWN_PROJECTILE
            Animation           = FLYA
                AnimationName     = GUTwrGrd_FLYA
                AnimationMode     = LOOP
            End
        End
        AnimationState                            = PASSENGER FREEFALL
            Animation                            = Grabbed
                AnimationName                    = GUTwrGrd_FLLA
                AnimationMode                    = LOOP
            End
        End
        AnimationState                            = FREEFALL
            Animation                            = Falling
                AnimationName                    = GUTwrGrd_FLYA
                AnimationMode                    = LOOP
                AnimationBlendTime                = 10
            End
        End
        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                = DYING BURNINGDEATH
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEA
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEB
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEC
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
        End
        AnimationState        = DYING SPLATTED
            Animation           = LNDA
                AnimationName     = GUTwrGrd_LNDA
                AnimationMode     = ONCE
            End
        End
        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End
        AnimationState                        = BURNINGDEATH
            Animation
                AnimationName                = GUTwrGrd_MFDA
                AnimationMode                = LOOP
                Distance                    = 60
            End
        End
        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUTwrGrd_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART  
        End
//=======TERROR
        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            ShareAnimation                = Yes
            Animation                    = TerrorFromTheSky
                AnimationName            = GUTwrGrd_RUNE
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            ShareAnimation                = Yes
            Animation                    = Terror
                AnimationName            = GUTwrGrd_RUNE
                AnimationMode            = LOOP
            End
        End
//----------------
//=======BACK UP
        AnimationState                =    MOVING BACKING_UP
            ShareAnimation = Yes
            Animation                =    BackingUp
                AnimationName        =    GUTwrGrd_BAKA
                AnimationMode        =    LOOP
            End
            Animation                =    BackingUp
                AnimationName        =    GUTwrGrd_BAKB
                AnimationMode        =    LOOP
            End            
            Flags                    =    RANDOMSTART 
        End
//--------------------
	AnimationState  = COMING_OUT_OF_FACTORY
		Animation = Being_Built
			AnimationName		= GUTwrGrd_RUNC
			AnimationMode		= LOOP
			AnimationBlendTime	= 0
		End
            ParticleSysBone     = None InfantryDustTrails
	End
        AnimationState        = MOVING ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_WLKA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING ALTERNATE_FORMATION 
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_WLKB
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING ATTACKING
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_RUNC
                AnimationMode     = LOOP
            End
            Animation
                AnimationName     = GUTwrGrd_RUND
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING
            ShareAnimation = Yes
            Animation           = RUNA
                AnimationName     = GUTwrGrd_WLKA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
        End
        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = GUTwrGrd_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKA
                AnimationName     = GUTwrGrd_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            //ParticleSysBone     = None MeleeDust
        End
        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = GUTwrGrd_FLYA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
        End
        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = GUTwrGrd_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = GUTwrGrd_LNDA
                AnimationMode     = ONCE
            End
        End
        TransitionState       = TRANS_Plant
            Animation           = PLTA
                AnimationName     = GUTwrGrd_PLTA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End
        TransitionState       = TRANS_Unplant
            Animation           = PLTB
                AnimationName     = GUTwrGrd_PLTC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.5 1.2
            End
        End
//------------------ Hit Reaction ---------------------------------------
        AnimationState                        = HIT_REACTION
            Animation                        = HIT REACTION
                AnimationName                = GUTwrGrd_HITA
                AnimationMode                = ONCE
            End
        End
//------------------ EMOTIONS -------------------------------------------
//======= APPREHENSIVE
        AnimationState                    = EMOTION_ALERT EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = Apprehensive
                AnimationName            = GUTwrGrd_FERA
                AnimationMode            = LOOP    //Change this to ONCE if adding additional anims
            End
            Flags                        = RANDOMSTART
        End
//======= AFRAID
        AnimationState                    = EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = FERA
                AnimationName            = GUTwrGrd_FERA
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End
//======= TAUNTING
        AnimationState                    = EMOTION_TAUNTING ALTERNATE_FORMATION
            Animation                    = TNTA
                AnimationName            = GUTwrGrd_TNTA
                AnimationMode            = LOOP
            End
            Animation                    = TNTA
                AnimationName            = GUTwrGrd_TNTB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = GUTwrGrd_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting2
                AnimationName            = GUTwrGrd_TNTB
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
//======= POINTING
        AnimationState                    = EMOTION_POINTING
            Animation                    = Pointing1
                AnimationName            = GUTwrGrd_PNTA
                AnimationMode            = LOOP
            End
            Animation                    = Pointing1
                AnimationName            = GUTwrGrd_PNTB
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End
//======= CELEBRATING
        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRA
                AnimationMode            = LOOP
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRB
                AnimationMode            = LOOP
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRC
                AnimationMode            = LOOP
            End
        End
//-------------- ALERT STATE ------------------------------------------------------------
        AnimationState                    = EMOTION_ALERT
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_IDLA
                AnimationMode            = LOOP
            End
        End
//-------------- SELECTED & IDLE --------------------------------------------------------
//======== SELECTED
        AnimationState                    = SELECTED ALTERNATE_FORMATION // PORCUPINE
            //ShareAnimation                = Yes
            StateName                    = STATE_SelectedAlternateFormation
            Animation
                AnimationName            = GUTwrGrd_PLTB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev ~= "STATE_SelectedAlternateFormation" and Prev ~= "STATE_Planted" and Prev ~= "TRANS_Plant" then CurDrawableSetTransitionAnimState("TRANS_Plant") end
            EndScript
        End
        AnimationState                    = SELECTED ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            //ShareAnimation                = Yes 
            StateName                    = STATE_SelectedAlternateFormation
            Animation
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                        = ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            Animation
                AnimationName                = GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRA
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRB
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRC
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                    = SELECTED
            StateName                    = STATE_Selected
            ShareAnimation                = Yes
            Animation                    = ATNB
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End
//======== IDLE
        AnimationState                    = ALTERNATE_FORMATION //PORCUPINE    //    aka Porcupine formation
            StateName                    = STATE_Planted
            //ShareAnimation                = Yes
            Animation
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev ~= "STATE_SelectedAlternateFormation" and Prev ~= "STATE_Planted" and Prev ~= "TRANS_Plant" then CurDrawableSetTransitionAnimState("TRANS_Plant") end
            EndScript
        End
        IdleAnimationState
            StateName                    = STATE_Idle
            Animation
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End
//-------------------------------------------------------------------------------------------------------------
    End
	VisionSide			= 100%
	VisionRear			= 100%
	ShroudClearingRange	= 300
	ShockwaveResistance	= SHOCKWAVE_RESISTANCE_ALWAYS
	Body					=	PorcupineFormationBodyModule ModuleTag_porcupineFormation
		MaxHealth			=	800 ;GONDOR_SPEARMEN_HEALTH
		MaxHealthDamaged		=	GONDOR_SPEARMEN_HEALTH_DAMAGED
		DamageWeaponTemplate		=	PikemenPorcupineDamage
		CrushDamageWeaponTemplate	=	PikemenPorcupineCrushDamage
		CrusherLevelResisted		=	2
		BurningDeathBehavior = Yes
		BurningDeathFX       = FX_InfantryBurningFlame
		CheerRadius = EMOTION_CHEER_RADIUS
	End
	LocomotorSet
		Locomotor   = HumanLocomotor
		Condition   = SET_NORMAL
		Speed       = 0
	End
	VoiceAttack						  =	GondorArcherVoiceAttack
	VoiceAttackAir					  =	GondorArcherVoiceAttack
	VoiceAttackCharge				  =	GondorArcherVoiceAttackCharge
	VoiceAttackMachine				  =	GondorArcherVoiceAttack	  
	VoiceAttackStructure			  =	GondorArcherVoiceAttackBuilding
	VoiceEnterStateAttack			  =	GondorArcherVoiceEnterStateAttack
	VoiceEnterStateAttackCharge		  =	GondorArcherVoiceEnterStateAttackCharge
	VoiceEnterStateAttackMachine	  =	GondorArcherVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackStructure	  =	GondorArcherVoiceEnterStateAttackBuilding
	VoiceCreated					  =	GondorSoldierVoiceDesperateCharge	  
	VoiceFullyCreated				  =	GondorSoldierVoiceDesperateCharge	  
	VoiceMove						  =	GondorArcherVoiceMove
	VoiceMoveToCamp					  =	GondorArcherVoiceMoveCamp
	VoiceMoveWhileAttacking			  =	GondorArcherVoiceDisengage			  
	VoiceEnterStateMove				  =	GondorArcherVoiceEnterStateMove
	VoiceEnterStateMoveToCamp		  =	GondorArcherVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking =	GondorArcherVoiceEnterStateDisengage  
	VoicePriority					  =	47
	VoiceRetreatToCastle			  =	GondorArcherVoiceRetreat
	VoiceEnterStateRetreatToCastle	  =	GondorArcherVoiceEnterStateRetreat
	VoiceSelect						  =	GondorArcherVoiceSelectMS
	VoiceSelectBattle				  =	GondorArcherVoiceSelectBattle
	VoiceGuard						  =	GondorArcherVoiceMove
	MinZIncreaseForVoiceMoveToHigherGround = 45
	SoundImpact				= ImpactHorse
	UnitSpecificSounds
		VoiceGarrison						= GondorArcherVoiceGarrison      
		VoiceAttackUnitWebbedHumanoidWithGondorFighterInside	= GondorArcherVoiceAttackWebbedSoldier
		VoiceAttackUnitWebbedHumanoidWithGondorArcherInside	= GondorArcherVoiceAttackWebbedSoldier
		VoiceEnterUnitElvenTransportShip	= GondorArcherVoiceMove
		VoiceInitiateCaptureBuilding		= GondorArcherVoiceMove
	End
	KindOf =  CAN_CAST_REFLECTIONS INFANTRY UNATTACKABLE NOT_AUTOACQUIRABLE
	CommandPoints = 0
	Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 0
		GuardWanderRange	= 0
		UseSlaverAsControlForEvaObjectSightedEvents = No ; Not a creep
		DieOnMastersDeath	= Yes
		MarkUnselectable	= No
	End
	Behavior = GrantUpgradeCreate ModuleTag_GrantMithrilMail
		UpgradeToGrant = Upgrade_GondorHeavyArmor
	End
	Behavior = SlowDeathBehavior ModuleTag_05				; overriden to be faster, so we fall with the barricade rubble.
		DeathTypes			= ALL -KNOCKBACK -FADED
		SinkDelay			= 10
		SinkRate			= 1.50							; in Dist/Sec
		DestructionDelay	= 10000
		Sound				= INITIAL GondorianHumanVoiceDie
	End
End

ChildObject GondorSpearmen_TowerRange GondorSpearmen
	;Scale		= 1.05
	SelectPortrait     = UPGondor_Pike
	ButtonImage	   = BGBarracks_Pikemen
	Draw = W3DScriptedModelDraw ModuleTag_01  
		OkToChangeModelColor = Yes
		StaticModelLODMode = yes
        DefaultModelConditionState
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        ModelConditionState WEAPONSET_PLAYER_UPGRADE
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        ModelConditionState WEAPONSET_TOGGLE_1
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        AnimationState        = THROWN_PROJECTILE
            Animation           = FLYA
                AnimationName     = GUTwrGrd_FLYA
                AnimationMode     = LOOP
            End
        End
        AnimationState                            = PASSENGER FREEFALL
            Animation                            = Grabbed
                AnimationName                    = GUTwrGrd_FLLA
                AnimationMode                    = LOOP
            End
        End
        AnimationState                            = FREEFALL
            Animation                            = Falling
                AnimationName                    = GUTwrGrd_FLYA
                AnimationMode                    = LOOP
                AnimationBlendTime                = 10
            End
        End
        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                = DYING BURNINGDEATH
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEA
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEB
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEC
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
        End
        AnimationState        = DYING SPLATTED
            Animation           = LNDA
                AnimationName     = GUTwrGrd_LNDA
                AnimationMode     = ONCE
            End
        End
        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End
        AnimationState                        = BURNINGDEATH
            Animation
                AnimationName                = GUTwrGrd_MFDA
                AnimationMode                = LOOP
                Distance                    = 60
            End
        End
        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUTwrGrd_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART  
        End
//=======TERROR
        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            ShareAnimation                = Yes
            Animation                    = TerrorFromTheSky
                AnimationName            = GUTwrGrd_RUNE
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            ShareAnimation                = Yes
            Animation                    = Terror
                AnimationName            = GUTwrGrd_RUNE
                AnimationMode            = LOOP
            End
        End
//----------------
//=======BACK UP
        AnimationState                =    MOVING BACKING_UP
            ShareAnimation = Yes
            Animation                =    BackingUp
                AnimationName        =    GUTwrGrd_BAKA
                AnimationMode        =    LOOP
            End
            Animation                =    BackingUp
                AnimationName        =    GUTwrGrd_BAKB
                AnimationMode        =    LOOP
            End            
            Flags                    =    RANDOMSTART 
        End
//--------------------
	AnimationState  = COMING_OUT_OF_FACTORY
		Animation = Being_Built
			AnimationName		= GUTwrGrd_RUNC
			AnimationMode		= LOOP
			AnimationBlendTime	= 0
		End
            ParticleSysBone     = None InfantryDustTrails
	End
        AnimationState        = MOVING ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_WLKA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING ALTERNATE_FORMATION 
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_WLKB
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING ATTACKING
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_RUNC
                AnimationMode     = LOOP
            End
            Animation
                AnimationName     = GUTwrGrd_RUND
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING
            ShareAnimation = Yes
            Animation           = RUNA
                AnimationName     = GUTwrGrd_WLKA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
        End
        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = GUTwrGrd_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKA
                AnimationName     = GUTwrGrd_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            //ParticleSysBone     = None MeleeDust
        End
        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = GUTwrGrd_FLYA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
        End
        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = GUTwrGrd_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = GUTwrGrd_LNDA
                AnimationMode     = ONCE
            End
        End
        TransitionState       = TRANS_Plant
            Animation           = PLTA
                AnimationName     = GUTwrGrd_PLTA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End
        TransitionState       = TRANS_Unplant
            Animation           = PLTB
                AnimationName     = GUTwrGrd_PLTC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.5 1.2
            End
        End
//------------------ Hit Reaction ---------------------------------------
        AnimationState                        = HIT_REACTION
            Animation                        = HIT REACTION
                AnimationName                = GUTwrGrd_HITA
                AnimationMode                = ONCE
            End
        End
//------------------ EMOTIONS -------------------------------------------
//======= APPREHENSIVE
        AnimationState                    = EMOTION_ALERT EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = Apprehensive
                AnimationName            = GUTwrGrd_FERA
                AnimationMode            = LOOP    //Change this to ONCE if adding additional anims
            End
            Flags                        = RANDOMSTART
        End
//======= AFRAID
        AnimationState                    = EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = FERA
                AnimationName            = GUTwrGrd_FERA
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End
//======= TAUNTING
        AnimationState                    = EMOTION_TAUNTING ALTERNATE_FORMATION
            Animation                    = TNTA
                AnimationName            = GUTwrGrd_TNTA
                AnimationMode            = LOOP
            End
            Animation                    = TNTA
                AnimationName            = GUTwrGrd_TNTB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = GUTwrGrd_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting2
                AnimationName            = GUTwrGrd_TNTB
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
//======= POINTING
        AnimationState                    = EMOTION_POINTING
            Animation                    = Pointing1
                AnimationName            = GUTwrGrd_PNTA
                AnimationMode            = LOOP
            End
            Animation                    = Pointing1
                AnimationName            = GUTwrGrd_PNTB
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End
//======= CELEBRATING
        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRA
                AnimationMode            = LOOP
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRB
                AnimationMode            = LOOP
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRC
                AnimationMode            = LOOP
            End
        End
//-------------- ALERT STATE ------------------------------------------------------------
        AnimationState                    = EMOTION_ALERT
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_IDLA
                AnimationMode            = LOOP
            End
        End
//-------------- SELECTED & IDLE --------------------------------------------------------
//======== SELECTED
        AnimationState                    = SELECTED ALTERNATE_FORMATION // PORCUPINE
            //ShareAnimation                = Yes
            StateName                    = STATE_SelectedAlternateFormation
            Animation
                AnimationName            = GUTwrGrd_PLTB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev ~= "STATE_SelectedAlternateFormation" and Prev ~= "STATE_Planted" and Prev ~= "TRANS_Plant" then CurDrawableSetTransitionAnimState("TRANS_Plant") end
            EndScript
        End
        AnimationState                    = SELECTED ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            //ShareAnimation                = Yes 
            StateName                    = STATE_SelectedAlternateFormation
            Animation
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                        = ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            Animation
                AnimationName                = GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRA
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRB
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRC
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                    = SELECTED
            StateName                    = STATE_Selected
            ShareAnimation                = Yes
            Animation                    = ATNB
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End
//======== IDLE
        AnimationState                    = ALTERNATE_FORMATION //PORCUPINE    //    aka Porcupine formation
            StateName                    = STATE_Planted
            //ShareAnimation                = Yes
            Animation
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev ~= "STATE_SelectedAlternateFormation" and Prev ~= "STATE_Planted" and Prev ~= "TRANS_Plant" then CurDrawableSetTransitionAnimState("TRANS_Plant") end
            EndScript
        End
        IdleAnimationState
            StateName                    = STATE_Idle
            Animation
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End
//-------------------------------------------------------------------------------------------------------------
    End

;  PlacementViewAngle  = 180

	VisionSide			= 100%
	VisionRear			= 100%
	ShroudClearingRange	= 300
	ShockwaveResistance	= SHOCKWAVE_RESISTANCE_ALWAYS

	LocomotorSet
		Locomotor   = HumanLocomotor
		Condition   = SET_NORMAL
		Speed       = 0
	End
	VoiceAttack						  =	GondorArcherVoiceAttack
	VoiceAttackAir					  =	GondorArcherVoiceAttack
	VoiceAttackCharge				  =	GondorArcherVoiceAttackCharge
	VoiceAttackMachine				  =	GondorArcherVoiceAttack	  
	VoiceAttackStructure			  =	GondorArcherVoiceAttackBuilding
	VoiceEnterStateAttack			  =	GondorArcherVoiceEnterStateAttack
	VoiceEnterStateAttackCharge		  =	GondorArcherVoiceEnterStateAttackCharge
	VoiceEnterStateAttackMachine	  =	GondorArcherVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackStructure	  =	GondorArcherVoiceEnterStateAttackBuilding
	VoiceCreated					  =	GondorSoldierVoiceDesperateCharge	  
	VoiceFullyCreated				  =	GondorSoldierVoiceDesperateCharge	  
	VoiceMove						  =	GondorArcherVoiceMove
	VoiceMoveToCamp					  =	GondorArcherVoiceMoveCamp
	VoiceMoveWhileAttacking			  =	GondorArcherVoiceDisengage			  
	VoiceEnterStateMove				  =	GondorArcherVoiceEnterStateMove
	VoiceEnterStateMoveToCamp		  =	GondorArcherVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking =	GondorArcherVoiceEnterStateDisengage  
	VoicePriority					  =	47
	VoiceRetreatToCastle			  =	GondorArcherVoiceRetreat
	VoiceEnterStateRetreatToCastle	  =	GondorArcherVoiceEnterStateRetreat
	VoiceSelect						  =	GondorArcherVoiceSelectMS
	VoiceSelectBattle				  =	GondorArcherVoiceSelectBattle
	VoiceGuard						  =	GondorArcherVoiceMove
	MinZIncreaseForVoiceMoveToHigherGround = 45
	SoundImpact				= ImpactHorse
	UnitSpecificSounds
		VoiceGarrison						= GondorArcherVoiceGarrison      
		VoiceAttackUnitWebbedHumanoidWithGondorFighterInside	= GondorArcherVoiceAttackWebbedSoldier
		VoiceAttackUnitWebbedHumanoidWithGondorArcherInside	= GondorArcherVoiceAttackWebbedSoldier
		VoiceEnterUnitElvenTransportShip	= GondorArcherVoiceMove
		VoiceInitiateCaptureBuilding		= GondorArcherVoiceMove
	End
	;//These guys are stuck in the barricade  can't move and can't be attacked UNATTACKABLE 
	KindOf = PRELOAD CAN_CAST_REFLECTIONS INFANTRY SCORE PIKE NOT_AUTOACQUIRABLE UNATTACKABLE 
;	KindOf =  NOT_AUTOACQUIRABLE UNATTACKABLE
	CommandPoints = 0
	Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 0
		GuardWanderRange	= 0
		UseSlaverAsControlForEvaObjectSightedEvents = No ; Not a creep
		DieOnMastersDeath	= Yes
		MarkUnselectable	= No
	End
	Behavior = GrantUpgradeCreate ModuleTag_GrantMithrilMail
		UpgradeToGrant = Upgrade_GondorHeavyArmor
	End
	Behavior = SlowDeathBehavior ModuleTag_05				; overriden to be faster, so we fall with the barricade rubble.
		DeathTypes			= ALL -KNOCKBACK -FADED
		SinkDelay			= 10
		SinkRate			= 1.50							; in Dist/Sec
		DestructionDelay	= 10000
		Sound				= INITIAL GondorianHumanVoiceDie
	End
End

Object SpawnArcheryGuardsEgg
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None
		End
	End
	KindOf = INERT IMMOBILE UNATTACKABLE
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End
	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 0.0
		MaxLifetime = 0.0
	End
	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay = 10
		OCL = FINAL OCL_SpawnArcheryGuard
	End
End

//------------------------------------------------------------------------------
ChildObject GondorSpearmen_Summoned GondorSpearmen
	IsTrainable = No
	CommandPoints = 0
	EquivalentTo = GondorSpearmen
	KindOf	= +SUMMONED ;;,;;	
	;Behavior = GrantUpgradeCreate ModuleTag_GrantMithrilMail
	;	UpgradeToGrant = Upgrade_GondorHeavyArmor
	;End	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	// This one does the work, but the one in the horde displays the timer
		MinLifetime		= CREATE_A_HERO_REINFORCEMENT_LIFETIME
		MaxLifetime		= CREATE_A_HERO_REINFORCEMENT_LIFETIME
		DeathType		= FADED
	End	

End

ChildObject GondorSpearmen_Trebuchet GondorSpearmen
	;Scale		= 1.05
	SelectPortrait     = UPGondor_Pike
	ButtonImage	   = BGBarracks_Pikemen
	Draw = W3DScriptedModelDraw ModuleTag_01  
		OkToChangeModelColor = Yes
		StaticModelLODMode = yes
        DefaultModelConditionState
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        ModelConditionState WEAPONSET_PLAYER_UPGRADE
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        ModelConditionState WEAPONSET_TOGGLE_1
            Model               = guanorienp_skn
            Skeleton            = GUTwrGrd_SKL
        End
        AnimationState        = THROWN_PROJECTILE
            Animation           = FLYA
                AnimationName     = GUTwrGrd_FLYA
                AnimationMode     = LOOP
            End
        End
        AnimationState                            = PASSENGER FREEFALL
            Animation                            = Grabbed
                AnimationName                    = GUTwrGrd_FLLA
                AnimationMode                    = LOOP
            End
        End
        AnimationState                            = FREEFALL
            Animation                            = Falling
                AnimationName                    = GUTwrGrd_FLYA
                AnimationMode                    = LOOP
                AnimationBlendTime                = 10
            End
        End
        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = DYING DEATH_2
		    Animation
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                = DYING BURNINGDEATH
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEA
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEB
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEC
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
        End
        AnimationState        = DYING SPLATTED
            Animation           = LNDA
                AnimationName     = GUTwrGrd_LNDA
                AnimationMode     = ONCE
            End
        End
        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End
        AnimationState                        = BURNINGDEATH
            Animation
                AnimationName                = GUTwrGrd_MFDA
                AnimationMode                = LOOP
                Distance                    = 60
            End
        End
        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUTwrGrd_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART  
        End
//=======TERROR
        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            ShareAnimation                = Yes
            Animation                    = TerrorFromTheSky
                AnimationName            = GUTwrGrd_RUNE
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            ShareAnimation                = Yes
            Animation                    = Terror
                AnimationName            = GUTwrGrd_RUNE
                AnimationMode            = LOOP
            End
        End
//----------------
//=======BACK UP
        AnimationState                =    MOVING BACKING_UP
            ShareAnimation = Yes
            Animation                =    BackingUp
                AnimationName        =    GUTwrGrd_BAKA
                AnimationMode        =    LOOP
            End
            Animation                =    BackingUp
                AnimationName        =    GUTwrGrd_BAKB
                AnimationMode        =    LOOP
            End            
            Flags                    =    RANDOMSTART 
        End
//--------------------
	AnimationState  = COMING_OUT_OF_FACTORY
		Animation = Being_Built
			AnimationName		= GUTwrGrd_RUNC
			AnimationMode		= LOOP
			AnimationBlendTime	= 0
		End
            ParticleSysBone     = None InfantryDustTrails
	End
        AnimationState        = MOVING ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_WLKA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING ALTERNATE_FORMATION 
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_WLKB
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING ATTACKING
            //ShareAnimation = Yes
            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_RUNC
                AnimationMode     = LOOP
            End
            Animation
                AnimationName     = GUTwrGrd_RUND
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
            ParticleSysBone     = None InfantryDustTrails
        End
        AnimationState        = MOVING
            ShareAnimation = Yes
            Animation           = RUNA
                AnimationName     = GUTwrGrd_WLKA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
        End
        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = GUTwrGrd_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKA
                AnimationName     = GUTwrGrd_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            //ParticleSysBone     = None MeleeDust
        End
        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = GUTwrGrd_FLYA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
        End
        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = GUTwrGrd_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = GUTwrGrd_LNDA
                AnimationMode     = ONCE
            End
        End
        TransitionState       = TRANS_Plant
            Animation           = PLTA
                AnimationName     = GUTwrGrd_PLTA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End
        TransitionState       = TRANS_Unplant
            Animation           = PLTB
                AnimationName     = GUTwrGrd_PLTC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.5 1.2
            End
        End
//------------------ Hit Reaction ---------------------------------------
        AnimationState                        = HIT_REACTION
            Animation                        = HIT REACTION
                AnimationName                = GUTwrGrd_HITA
                AnimationMode                = ONCE
            End
        End
//------------------ EMOTIONS -------------------------------------------
//======= APPREHENSIVE
        AnimationState                    = EMOTION_ALERT EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = Apprehensive
                AnimationName            = GUTwrGrd_FERA
                AnimationMode            = LOOP    //Change this to ONCE if adding additional anims
            End
            Flags                        = RANDOMSTART
        End
//======= AFRAID
        AnimationState                    = EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = FERA
                AnimationName            = GUTwrGrd_FERA
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End
//======= TAUNTING
        AnimationState                    = EMOTION_TAUNTING ALTERNATE_FORMATION
            Animation                    = TNTA
                AnimationName            = GUTwrGrd_TNTA
                AnimationMode            = LOOP
            End
            Animation                    = TNTA
                AnimationName            = GUTwrGrd_TNTB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = GUTwrGrd_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting2
                AnimationName            = GUTwrGrd_TNTB
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
//======= POINTING
        AnimationState                    = EMOTION_POINTING
            Animation                    = Pointing1
                AnimationName            = GUTwrGrd_PNTA
                AnimationMode            = LOOP
            End
            Animation                    = Pointing1
                AnimationName            = GUTwrGrd_PNTB
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End
//======= CELEBRATING
        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRA
                AnimationMode            = LOOP
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRB
                AnimationMode            = LOOP
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRC
                AnimationMode            = LOOP
            End
        End
//-------------- ALERT STATE ------------------------------------------------------------
        AnimationState                    = EMOTION_ALERT
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_IDLA
                AnimationMode            = LOOP
            End
        End
//-------------- SELECTED & IDLE --------------------------------------------------------
//======== SELECTED
        AnimationState                    = SELECTED ALTERNATE_FORMATION // PORCUPINE
            //ShareAnimation                = Yes
            StateName                    = STATE_SelectedAlternateFormation
            Animation
                AnimationName            = GUTwrGrd_PLTB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev ~= "STATE_SelectedAlternateFormation" and Prev ~= "STATE_Planted" and Prev ~= "TRANS_Plant" then CurDrawableSetTransitionAnimState("TRANS_Plant") end
            EndScript
        End
        AnimationState                    = SELECTED ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            //ShareAnimation                = Yes 
            StateName                    = STATE_SelectedAlternateFormation
            Animation
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                        = ALTERNATE_FORMATION WEAPONSET_TOGGLE_1
            Animation
                AnimationName                = GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRA
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRB
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRC
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                    = SELECTED
            StateName                    = STATE_Selected
            ShareAnimation                = Yes
            Animation                    = ATNB
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End
//======== IDLE
        AnimationState                    = ALTERNATE_FORMATION //PORCUPINE    //    aka Porcupine formation
            StateName                    = STATE_Planted
            //ShareAnimation                = Yes
            Animation
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev ~= "STATE_SelectedAlternateFormation" and Prev ~= "STATE_Planted" and Prev ~= "TRANS_Plant" then CurDrawableSetTransitionAnimState("TRANS_Plant") end
            EndScript
        End
        IdleAnimationState
            StateName                    = STATE_Idle
            Animation
                AnimationName            = GUSPR_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End
//-------------------------------------------------------------------------------------------------------------
    End
	VisionSide			= 100%
	VisionRear			= 100%
	ShroudClearingRange	= 300
	ShockwaveResistance	= SHOCKWAVE_RESISTANCE_ALWAYS
	Body					=	PorcupineFormationBodyModule ModuleTag_porcupineFormation
		MaxHealth			=	800 ;GONDOR_SPEARMEN_HEALTH
		MaxHealthDamaged		=	GONDOR_SPEARMEN_HEALTH_DAMAGED
		DamageWeaponTemplate		=	PikemenPorcupineDamage
		CrushDamageWeaponTemplate	=	PikemenPorcupineCrushDamage
		CrusherLevelResisted		=	2
		BurningDeathBehavior = Yes
		BurningDeathFX       = FX_InfantryBurningFlame
		CheerRadius = EMOTION_CHEER_RADIUS
	End
	LocomotorSet
		Locomotor   = HumanLocomotor
		Condition   = SET_NORMAL
		Speed       = 0
	End
	VoiceAttack						  =	GondorArcherVoiceAttack
	VoiceAttackAir					  =	GondorArcherVoiceAttack
	VoiceAttackCharge				  =	GondorArcherVoiceAttackCharge
	VoiceAttackMachine				  =	GondorArcherVoiceAttack	  
	VoiceAttackStructure			  =	GondorArcherVoiceAttackBuilding
	VoiceEnterStateAttack			  =	GondorArcherVoiceEnterStateAttack
	VoiceEnterStateAttackCharge		  =	GondorArcherVoiceEnterStateAttackCharge
	VoiceEnterStateAttackMachine	  =	GondorArcherVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackStructure	  =	GondorArcherVoiceEnterStateAttackBuilding
	VoiceCreated					  =	GondorSoldierVoiceDesperateCharge	  
	VoiceFullyCreated				  =	GondorSoldierVoiceDesperateCharge	  
	VoiceMove						  =	GondorArcherVoiceMove
	VoiceMoveToCamp					  =	GondorArcherVoiceMoveCamp
	VoiceMoveWhileAttacking			  =	GondorArcherVoiceDisengage			  
	VoiceEnterStateMove				  =	GondorArcherVoiceEnterStateMove
	VoiceEnterStateMoveToCamp		  =	GondorArcherVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking =	GondorArcherVoiceEnterStateDisengage  
	VoicePriority					  =	47
	VoiceRetreatToCastle			  =	GondorArcherVoiceRetreat
	VoiceEnterStateRetreatToCastle	  =	GondorArcherVoiceEnterStateRetreat
	VoiceSelect						  =	GondorArcherVoiceSelectMS
	VoiceSelectBattle				  =	GondorArcherVoiceSelectBattle
	VoiceGuard						  =	GondorArcherVoiceMove
	MinZIncreaseForVoiceMoveToHigherGround = 45
	SoundImpact				= ImpactHorse
	UnitSpecificSounds
		VoiceGarrison						= GondorArcherVoiceGarrison      
		VoiceAttackUnitWebbedHumanoidWithGondorFighterInside	= GondorArcherVoiceAttackWebbedSoldier
		VoiceAttackUnitWebbedHumanoidWithGondorArcherInside	= GondorArcherVoiceAttackWebbedSoldier
		VoiceEnterUnitElvenTransportShip	= GondorArcherVoiceMove
		VoiceInitiateCaptureBuilding		= GondorArcherVoiceMove
	End
	KindOf =  CAN_CAST_REFLECTIONS INFANTRY UNATTACKABLE NOT_AUTOACQUIRABLE SUMMONED
	CommandPoints = 0
	Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 0
		GuardWanderRange	= 0
		UseSlaverAsControlForEvaObjectSightedEvents = Yes ; Not a creep
		DieOnMastersDeath	= Yes
		MarkUnselectable	= No
	End
	Behavior = GrantUpgradeCreate ModuleTag_GrantMithrilMail
		UpgradeToGrant = Upgrade_GondorHeavyArmor
	End
	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes = ALL -KNOCKBACK
		FadeDelay = 0
		FadeTime = 4000
		DestructionDelay = 4000
        DeathFlags = DEATH_2
        ;FX = INITIAL FX_RohirrimAlliesUnsummon
		;Sound = INITIAL SpellGenericUnsummonFasterMS
	End
End
