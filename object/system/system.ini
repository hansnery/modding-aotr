///////////////////////////////////////////////////////////
; This file contains only objects that are of use to the game code from
; an engineering standpoint.  They are not general objects that a designer
; would place in a map.
;
; EVERYTHING in this file should use "EditorSorting = SYSTEM".
; If it doesn't, it shouldn't be in this file.
;
;//////////////////////////////////////////////////////////////////////////////

#define SPELL_BOOK_REQUIREMENTS_FILTER NONE +COMMANDCENTER
#define SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC NONE

;------------------------------------------------------------------------------


; Any SpecialPowers tied to the spellbook have a behavior put here.

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;; EVIL SPELLS ;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Object EvilSpellBook
	EditorSorting = SYSTEM
    
	; *** ART Parameters ***
	Draw                = W3DDefaultDraw ModuleTag_01
	;nothing		
	End  ; Never drawn

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; CAMERA SYSTEM ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

    Behavior = SpecialPowerModule ModuleTag_SpellBookGeneralView
        SpecialPowerTemplate            = SpellBookGeneralView
        AvailableAtStart                = No
    End

    Behavior = SpecialPowerModule ModuleTag_SpellBookCommanderView
        SpecialPowerTemplate            = SpellBookCommanderView
        AvailableAtStart                = No
    End

    Behavior = SpecialPowerModule ModuleTag_SpellBookUnitView
        SpecialPowerTemplate            = SpellBookUnitView
        AvailableAtStart                = No
    End

    Behavior = SpecialPowerModule ModuleTag_SpellBookGroundView
        SpecialPowerTemplate            = SpellBookGroundView
        AvailableAtStart                = No
    End

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; CAMERA SYSTEM END ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    
 	Behavior   = TaintSpecialPower ModuleTag_GuldurCorruption
		SpecialPowerTemplate	= SpellBookGuldurForestOfFear
		TaintObject				= GuldurCorruptionLand
		TaintRadius				= 150
		TaintFX					= FX_GuldurCorruptionLandFX
		TaintOCL				= OCL_GuldurCorruptionTaint
		;CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
 	Behavior   = TaintSpecialPower ModuleTag_IsengardTaint
		SpecialPowerTemplate	= SpellBookIsengardTaint
		TaintObject				= IsengardTaintLand
		TaintRadius				= SPELLBOOK_TAINT_RADIUS
		TaintFX					= FX_TaintSpellFX
		TaintOCL				= OCL_TaintSeed	
;		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = DevastateSpecialPower	ModuleTag_GuldurDevastateSpecialPower
		SpecialPowerTemplate		= SpellBookGuldurDevastation
		Radius				= SPECIALPOWER_DEVASTATION_RADIUS
		TreeValueMultiplier	= 50%	;The value sqeezed out of each tree is multiplied by this compared to what a worker would have gotten for it
		TreeValueTotalCap	= 1500 ;1750 ;1500 ;;,;; 2000 ;;.;; 1500	;And the most you can get for the enitre spell is this, so you can't find the one map that has a 20000 patch of trees in the corner
		TriggerFX			= FX_DevastationFlare
		FX					= FX_Devastation
		AvailableAtStart	= No
		FireWeapon			= DevastationEntWeapon
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
 	Behavior   = TaintSpecialPower ModuleTag_Taint
		SpecialPowerTemplate	= SpellBookTaint
		TaintObject				= TaintLand
		TaintRadius				= SPELLBOOK_TAINT_RADIUS
		TaintFX					= FX_TaintSpellFX
		TaintOCL				= OCL_TaintSeed
;		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
 	Behavior   = TaintSpecialPower ModuleTag_GuldurMarsh
		SpecialPowerTemplate	= SpellBookGuldurMarsh
		TaintObject				= GuldurMarsh
		TaintRadius				= SPELLBOOK_TAINT_RADIUS
		TaintFX					= FX_TaintSpellFX
		TaintOCL				= OCL_GuldurMarshSeed
;		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_GuldurConcealment
		SpecialPowerTemplate = SpellBookGuldurConcealment
		OCL                  = OCL_SpecialPowerGuldurConcealment
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
 	Behavior   = OCLSpecialPower ModuleTag_Blight ;;.;; Added
		SpecialPowerTemplate		= SpellBookBlight
		OCL				= OCL_BlightCompromiseWeapon
		TriggerFX			 	= FX_BlightSpellFX
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish 		= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 		= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = SpecialPowerModule		ModuleTag_DrySpell
		SpecialPowerTemplate		= SpellBookDrySpell
		AttributeModifier			= SpellBookBlight
		AttributeModifierRange		= BLIGHT_EFFECT_RADIUS
		AttributeModifierAffects	= BLIGHT_TYPE_SPELL_OBJECT_FILTER
		TriggerFX					= FX_BlightSpellFX
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
		TargetEnemy 		= Yes	//This is VERY important because it defaults to false and overrides the AttributeModifier filter above!!!
	End

;;.;; Changed to Devastate
	Behavior = DevastateSpecialPower		ModuleTag_Blight2 ;;;SpecialPowerModule		ModuleTag_Blight
		SpecialPowerTemplate		= SpellBookBlight
		AttributeModifier			= SpellBookBlight
		AttributeModifierRange		= BLIGHT_EFFECT_RADIUS
		AttributeModifierAffects	= BLIGHT_TYPE_SPELL_OBJECT_FILTER
		TriggerFX					= FX_BlightSpellFX
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
		TargetEnemy 		= Yes	//This is VERY important because it defaults to false and overrides the AttributeModifier filter above!!!
	End

 	Behavior   = OCLSpecialPower ModuleTag_ChillWind
		SpecialPowerTemplate	= SpellBookChillWind
		OCL				= OCL_SpellBookChillWind
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower	ModuleTag_OCLEyeOfSauron
		SpecialPowerTemplate	= SpellBookEyeofSauron
		OCL						= SUPERWEAPON_SpawnEyeOfSauron
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower	ModuleTag_OCLEvilEyeOfSauron
		SpecialPowerTemplate	= SpellBookEvilEyeofSauron
		OCL						= SUPERWEAPON_SpawnEyeOfSauron
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower	ModuleTag_OCLNEWEyeOfSauron
		SpecialPowerTemplate	= SpellBookEyeofSauronNew
		OCL						= SUPERWEAPON_SpawnEyeOfSauronNew
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower	ModuleTag_MordorGenericLeadershipSummon
		SpecialPowerTemplate			= SpellBookMordorGenericLeadership
		OCL								= OCL_SpellBookMordorGenericLeadership
		CreateLocation					= CREATE_AT_LOCATION
		TriggerFX					= FX_SummonWightsMordor
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic		= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
   
   	Behavior = OCLSpecialPower	ModuleTag_Barricade
		SpecialPowerTemplate			= SpellBookBarricade
		OCL								= OCL_SpellBookBarricade
		CreateLocation					= CREATE_AT_LOCATION
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic		= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
		//UseDistanceFromCommandCenter	= Yes
		//DistanceFromCommandCenter		= BARRICADE_EFFECTIVE_RADIUS
	End

	Behavior = SpecialPowerModule		SpellBookWarChant_ModuleTagMordor
		SpecialPowerTemplate		= SpellBookWarChantMordor
		AttributeModifier			= SpellBookWarChant
		AttributeModifierRange		= 100
		AttributeModifierAffects	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
		TriggerFX					= FX_SpellWarChantMordor
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
		Behavior = SpecialPowerModule		SpellBookWarChant_ModuleTagHarad
		SpecialPowerTemplate		= SpellBookWarChantHarad
		AttributeModifier			= SpellBookWarChant
		AttributeModifierRange		= 100
		AttributeModifierAffects	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
		TriggerFX					= FX_SpellWarChantMordor
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
   
	Behavior = SpecialPowerModule		SpellBookWarChant_ModuleTag
		SpecialPowerTemplate		= SpellBookWarChant
		AttributeModifier			= SpellBookWarChant
		AttributeModifierRange		= 100
		AttributeModifierAffects	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
		TriggerFX					= FX_SpellWarChantIsengard
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = SpecialPowerModule		SpellBookWarChant_ModuleTagGuldur
		SpecialPowerTemplate		= SpellBookGuldurCarnage
		AttributeModifier			= SpellBookGuldurCarnage
		AttributeModifierRange		= 100
		AttributeModifierAffects	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
		TriggerFX					= FX_SpellWarChantDolGuldur
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
   
	Behavior				 = OCLSpecialPower ModuleTag_PalantirVision
		SpecialPowerTemplate = SpellBookPalantirVision
		AttributeModifier	= PalantirVision ; ;
		AttributeModifierRange	= 120 ; ;
		AttributeModifierAffects = ANY +CAVALRY +MACHINE +HERO +INFANTRY +HORDE -STRUCTURE -BASE_FOUNDATION ; ;
		OCL                  = SpecialPowerPalantirVision
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
   
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
; try three :)
   Behavior = OCLSpecialPower		ModuleTag_FrozenLand
		SpecialPowerTemplate		= SpellBookFrozenLand
		TriggerFX					= FX_FrozenLandFX
		OCL							= OCL_SpecialPowerFrozenLand
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
 	Behavior   = SpecialPowerModule ModuleTag_Snowbind
		SpecialPowerTemplate		= SpellBookSnowbind
		AttributeModifier		= SpellBookSnowbind
		AttributeModifierRange		= SNOWBIND_EFFECT_RADIUS
		AttributeModifierAffects	= SNOWBIND_TYPE_SPELL_OBJECT_FILTER
		TriggerFX			= FX_SnowbindSpellFX
		UpdateModuleStartsAttack	= No
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
		;TargetEnemy 		= Yes	//This is VERY important because it defaults to false and overrides the AttributeModifier filter above!!!
		TargetAllSides = Yes
	End 

	Behavior = SpecialPowerModule		SpellBookIndustry_ModuleTag
		SpecialPowerTemplate		= SpellBookIndustry
		AttributeModifier			= SpellBookIndustry
		AttributeModifierRange		= INDUSTRY_EFFECT_RADIUS
		AttributeModifierAffects	= AOTR_ISEN_INDUSTRY_TYPE_SPELL_OBJECT_FILTER
		TriggerFX					= FX_Industry
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = SpecialPowerModule		SpellBookIndustryMordor_ModuleTag
		SpecialPowerTemplate		= SpellBookIndustryMordor
		AttributeModifier			= SpellBookIndustry
		AttributeModifierRange		= INDUSTRY_EFFECT_RADIUS
		AttributeModifierAffects	= AOTR_MORDOR_INDUSTRY_TYPE_SPELL_OBJECT_FILTER
		TriggerFX					= FX_Industry
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = SpecialPowerModule	SpellBookRebuild_ModuleTag2
		SpecialPowerTemplate		= SpellBookRebuild
		AttributeModifier			= SpellBookBuildingHeal
		AttributeModifierRange		= 200 ;75
		AttributeModifierAffects	= ANY +STRUCTURE
		TriggerFX					= FX_Industry
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = SpecialPowerModule	SpellBookCampaignRebuild_ModuleTag2
		SpecialPowerTemplate		= SpellBookCampaignRebuild
		AttributeModifier			= SpellBookBuildingHeal
		AttributeModifierRange		= 200 ;75
		AttributeModifierAffects	= ANY +STRUCTURE
		TriggerFX					= FX_Industry
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	

	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookEvilBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_SummonOrcs
		SpecialPowerTemplate = SpellBookSummonOrcs
		OCL                  = OCL_SpellBookSummonOrcs
		TriggerFX			 = FX_SummonWildmen
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = DevastateSpecialPower	ModuleTag_DevastateSpecialPower
		SpecialPowerTemplate		= SpellBookDevastation
		Radius				= SPECIALPOWER_DEVASTATION_RADIUS
		TreeValueMultiplier	= 50%	;The value sqeezed out of each tree is multiplied by this compared to what a worker would have gotten for it
		TreeValueTotalCap	= 1500 ;1750 ;1500 ;;,;; 2000 ;;.;; 1500	;And the most you can get for the enitre spell is this, so you can't find the one map that has a 20000 patch of trees in the corner
		TriggerFX			= FX_DevastationFlare
		FX					= FX_Devastation
		AvailableAtStart	= No
		FireWeapon			= DevastationEntWeapon
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = UntamedAllegianceSpecialPower ModuleTag_UntamedAllegiance  		;;.;;Original UA behavior
		SpecialPowerTemplate		= SpellBookUntamedAllegiance
		TargetEnemy					= Yes
		AttributeModifierAffects	= AOTR_CREEP_OBJECTFILTER ;CREEP_OBJECTFILTER
		AttributeModifierRange		= 60 ;,; 100 ;,; 60
		TriggerFX					= FX_SarumanDominateTrigger
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	;Behavior = UntamedAllegianceSpecialPower ModuleTag_GuldurEnsnare
	;	SpecialPowerTemplate		= SpellBookGuldurEnsnare
	;	TargetEnemy					= Yes
	;	AttributeModifierAffects	= ANY +HORDE ENEMIES NEUTRAL
	;	AttributeModifierRange		= 100
	;	TriggerFX					= FX_SarumanDominateTrigger
	;	RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
	;	RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	;End
	
	Behavior = SpecialPowerModule ModuleTag_GuldurDarkHysteria
		SpecialPowerTemplate		= SpellBookGuldurDarkHysteria
		AttributeModifier			= GuldurDarkHysteriaModifier
		AttributeModifierRange		= 60 	;120 ;MOUTH_OF_SAURON_DISSENT_RADIUS
		AttributeModifierAffects	= ANY +HORDE ENEMIES NEUTRAL
		TriggerFX					= FX_DarkHysteria
		UpdateModuleStartsAttack	= No
		StartsPaused				= No
		TargetAllSides				= Yes
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC		
	End

	Behavior = SpecialPowerModule ModuleTag_UAProductionEnhancement ;,;
        SpecialPowerTemplate    = SpellBookUAProductionEnhancement
        AttributeModifier            = UAProductionEnhancement
        AttributeModifierRange        = 60
        AttributeModifierAffects    = NONE ALLIES +AngmarDen +MordorMumakilPen +MordorTrollCage +GoblinFissure +WildSpiderPit +IsengardWargPit +WildLodge
        TargetEnemy = No
        AffectAllies                = Yes
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
;	Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
;		SpecialPowerTemplate			= SpellBookLightningStrike
;		StartAbilityRange				= 200
;		;TriggerSpecialPower				= ModuleTag_MightyRageBuff		TARGETPOS
;		TriggerSpecialPower				= ModuleTag_ShootLightningBolts	TARGETPOS
;		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
;		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
;	End
	
;	Behavior = SpecialPowerModule ModuleTag_LightningStrike                      
;		SpecialPowerTemplate		= SpellBookLightningStrike
;		UpdateModuleStartsAttack	= Yes
;		StartsPaused				= No ;Yes
;		InitiateSound				= WizardTowerLightningStrikeRumbleMS
;
;	End

	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyLorien
		SpecialPowerTemplate = SpellBookLightningStrike
		OCL                  = OCL_SpellbookFellstorm ;OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonWildMen
		SpecialPowerTemplate = SpellBookWildMenAllies
		OCL                  = OCL_SpellBookWildMenAllies
		TriggerFX			 = FX_SummonWildmen
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_SummonMordorOrcs
		SpecialPowerTemplate = SpellBookMordorAllies
		OCL                  = OCL_SpellBookMordorAllies
		TriggerFX			 = FX_SummonWildmen
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonMordorOrcs_WOTR
		SpecialPowerTemplate = SpellBookMordorAllies_WOTR
		OCL                  = OCL_SpellBookMordorAllies_WOTR
		TriggerFX			 = FX_SummonWildmen
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	;Behavior = ScavengerSpecialPower ModuleTag_Scavenger ;;,;; Original 2.01 Scavenger removed for 2.1
	;	SpecialPowerTemplate	= SpellBookScavenger
	;	BountyPercent			= 0.8 ;;,;; 1.0
	;	AvailableAtStart		= No
	;	RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
	;	RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	;End
	
	Behavior = SpecialPowerModule		SpellBookAOTRScavenger_ModuleTag
		SpecialPowerTemplate		= SpellBookAOTRScavenger
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No		
		AttributeModifier			= SpellBookAOTRScavenger
		AttributeModifierRange		= 999999
		AttributeModifierAffects	= ANY +INFANTRY +CAVALRY +HERO +WildFireDrake_Buildable -STRUCTURE -BASE_FOUNDATION -DOZER
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
;	Behavior = PlayerUpgradeSpecialPower	ModuleTag_NewScavenger	;;,;; added for 2.1, now works for AI and affects teammates
;		SpecialPowerTemplate		= SpellBookScavenger
;		UpgradeName 			= Upgrade_GrantScavenger
;		UpdateModuleStartsAttack	= No
;		AffectAllies			= No
;		AvailableAtStart		= No
;		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
;		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
;	End
   
	Behavior = ProductionSpeedBonus ModuleTag_CalltheHorde
		SpecialPowerTemplate	= SpellBookCalltheHorde
		NumberOfFrames			= 180 ;1800
		SpeedMulitplier			= 20.0  ; 12x speedup BALANCE
		Type					= GoblinTownFighterHorde MordorFighterHorde MordorPikemanHorde MordorArcherHorde MordorBlackOrcHorde GoblinFighterHorde GoblinArcherHorde GoblinFighterHorde_FromDefectedLair GoblinArcherHorde_FromDefectedLair
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = ProductionSpeedBonus ModuleTag_MordorCalltheHorde
		SpecialPowerTemplate	= SpellBookMordorCalltheHorde
		NumberOfFrames			= 160 ;1800
		SpeedMulitplier			= 20.0  ; 12x speedup BALANCE
		Type					= GoblinTownFighterHorde MordorFighterHorde MordorPikemanHorde MordorArcherHorde MordorBlackOrcHorde MordorMorgulOrcHorde GoblinFighterHorde GoblinArcherHorde GoblinFighterHorde_FromDefectedLair GoblinArcherHorde_FromDefectedLair 
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = ProductionSpeedBonus ModuleTag_WildCalltheHorde
		SpecialPowerTemplate	= SpellBookWildCalltheHorde
		NumberOfFrames			= 160 ;1800
		SpeedMulitplier			= 20.0  ; 12x speedup BALANCE
		Type					= GoblinTownFighterHorde MordorFighterHorde MordorPikemanHorde MordorArcherHorde MordorBlackOrcHorde MordorMorgulOrcHorde GoblinFighterHorde GoblinArcherHorde GoblinFighterHorde_FromDefectedLair GoblinArcherHorde_FromDefectedLair 
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonSpiderlings
		SpecialPowerTemplate = SpellBookSpiderlingAllies
		OCL                  = OCL_SpawnSpiderlingsEgg
        TriggerFX			 = FX_SpiderlingsSummonStart
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_Spiderlings
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonShelob
		SpecialPowerTemplate = SpellBookShelobSummon
		OCL                  = OCL_MordorShelobSummonEgg
        TriggerFX			 = FX_MordorShelobSummon
		CreateLocation       = CREATE_AT_LOCATION
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_SummonBlackWarg
		SpecialPowerTemplate = SpellBookGuldurBlackWarg
		OCL                  = OCL_GuldurBlackWarg
        TriggerFX			 = FX_GenericGoodSummon
		CreateLocation       = CREATE_AT_LOCATION
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End		
	
	Behavior = OCLSpecialPower ModuleTag_CrackOfDoom
		SpecialPowerTemplate = SpellBookCrackOfDoom
		OCL                  = OCL_SpawnCrackOfDoom ;OCL_SpellBookArrowVolley
		TriggerFX			 = FX_CrackOfDoom
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

;	Behavior   = DarknessSpecialPower ModuleTag_Darkness ;;,;; original 2.01 Darkness
;		SpecialPowerTemplate			= SpellBookDarkness
;		AttributeModifier				= SpellBookDarkness
;		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO -HORDE -MordorBlackRider -MordorBlackRiderHorde -DwarvenZerker -NoldorWarrior -GondorKnightsofDol -GondorKnightsofDolHorde -WildBabyDrake -WildBabyDrakeHorde -IsengardFanatic ALLIES ;;.;; Removed MHH Horde objects
;		AttributeModifierWeatherBased	= Yes			
;		WeatherDuration					= SPELL_DARKNESS_DURATION
;		ChangeWeather					= CLOUDY
;		AvailableAtStart				= No
;		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
;		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
;	End

	Behavior = OCLSpecialPower ModuleTag_Darkness ;;,;; 2.02e Darkness
		SpecialPowerTemplate		= SpellBookDarkness
		OCL				= OCL_DarknessWeatherChanger ;OCL_DarknessCaster
		CreateLocation			= CREATE_AT_LOCATION
		AttributeModifierWeatherBased	= Yes
		WeatherDuration			= SPELL_DARKNESS_DURATION
		ChangeWeather			= CLOUDY
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_GuldurDarkness
		SpecialPowerTemplate		= SpellBookGuldurDarkness
		OCL				= OCL_DarknessWeatherChanger ;OCL_DarknessCaster
		CreateLocation			= CREATE_AT_LOCATION
		AttributeModifierWeatherBased	= Yes
		WeatherDuration			= SPELL_DARKNESS_DURATION
		ChangeWeather			= CLOUDY
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	

	Behavior = OCLSpecialPower ModuleTag_AwakenWyrm
		SpecialPowerTemplate = SpellBookAwakenWyrm
		OCL                  = OCL_Wyrm
		TriggerFX			 = FX_WrymSummonStart
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_SummonGiants
		SpecialPowerTemplate 		= SpellBookSummonGiants
		OCL                  		= OCL_SpellBookSummonGiants
		TriggerFX	 		= FX_SummonWildmen
		CreateLocation       		= CREATE_AT_LOCATION
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonKhandishCharioteers
		SpecialPowerTemplate 		= SpellBookSummonKhandishCharioteers
		OCL                  		= OCL_SpellBookSummonKhandishCharioteers
		TriggerFX	 		= FX_SummonWildmen
		CreateLocation       		= CREATE_AT_LOCATION
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
		Behavior = OCLSpecialPower ModuleTag_SummonForthMenDarknessHarad
		SpecialPowerTemplate 		= SpellBookEasterlingAllies
		OCL                  		= OCL_SpellBookSummonHaradEasterlings
		TriggerFX	 		= FX_SummonHaradEasterlings
		CreateLocation       		= CREATE_AT_LOCATION
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_SpawnHaradrimRaiders
		SpecialPowerTemplate 		= SpellBookHaradrimRaiders
		OCL                  		= OCL_SpawnHaradrimRaiderEgg
		TriggerFX	 		= FX_SummonHaradrimRaiders
		UpgradeName			 = Upgrade_Evilboyos
		CreateLocation       		= CREATE_AT_LOCATION
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_SpawnWraith
		SpecialPowerTemplate 		= SpellBookWraith
		OCL                  		= OCL_SpawnWraithEgg
		TriggerFX	 		= FX_SummonWildmen
		CreateLocation       		= CREATE_AT_LOCATION
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_SpawnDolGuldurAllies
		SpecialPowerTemplate 		= SpellBookDolGuldurAllies
		OCL                  		= OCL_DolGuldurAlliesEgg
		CreateLocation       		= CREATE_AT_LOCATION
		TriggerFX	 		= FX_TaintSpellFX
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SpawnGuldurUndeadTroll
		SpecialPowerTemplate 			= SpellBookGuldurUndeadTroll
		OCL                  			= OCL_SpawnUndeadTrollEgg
		CreateLocation       			= CREATE_AT_LOCATION
		TriggerFX	 					= FX_UndeadTrollSummon
		AvailableAtStart	 			= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_SpawnGuldurShadeDecoy
		SpecialPowerTemplate 			= SpellBookGuldurShadeDecoy
		OCL                  			= OCL_GuldurShadeDecoyEgg
		CreateLocation       			= CREATE_AT_LOCATION
		;TriggerFX	 					= FX_SummonWildmen
		AvailableAtStart	 			= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End		
	
	Behavior = OCLSpecialPower ModuleTag_SpawnGuldurShadeAI
		SpecialPowerTemplate 			= SpellBookGuldurShadeAI
		OCL                  			= OCL_GuldurShadeAIEgg
		CreateLocation       			= CREATE_AT_LOCATION
		;TriggerFX	 					= FX_SummonWildmen
		AvailableAtStart	 			= Yes
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_GuldurChillOfGrave
		SpecialPowerTemplate 			= SpellBookChillOfGrave
		OCL                  			= OCL_GuldurChillOfGrave
		CreateLocation       			= CREATE_AT_LOCATION
		TriggerFX	 					= FX_ChilloftheGraveFX
		AvailableAtStart	 			= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_GuldurWither
		SpecialPowerTemplate 			= SpellBookGuldurWither
		OCL                  			= OCL_GuldurWither
		CreateLocation       			= CREATE_AT_LOCATION
		TriggerFX	 					= FX_WitherFX
		AvailableAtStart	 			= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End		
	
	Behavior = OCLSpecialPower ModuleTag_SpawnAngmarCitadel
		SpecialPowerTemplate 		= SpellBookAngmarCitadel
		OCL                  		= OCL_AngmarCitadelEgg
		CreateLocation       		= CREATE_AT_LOCATION
		TriggerFX	 				= FX_AngmarCitadelFX
		AvailableAtStart	 		= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
		Behavior = OCLSpecialPower ModuleTag_SpawnTribesofHarad
		SpecialPowerTemplate 		= SpellBookTribesOfHarad
		OCL                  		= OCL_TribalCampEgg
		CreateLocation       		= CREATE_AT_LOCATION
		TriggerFX	 				= FX_AngmarCitadelFX
		AvailableAtStart	 		= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_SpawnLonghouse
		SpecialPowerTemplate 		= SpellBookLonghouse
		OCL                  		= OCL_LonghouseEgg
		CreateLocation       		= CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_Evilboyos		
		TriggerFX	 		= FX_SummonLonghouseSmoke
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
;	Behavior = FreezingRainSpecialPower ModuleTag_FreezingRain ;;,;; this is the old 2.01 Freezing Rain
;		SpecialPowerTemplate			= SpellBookFreezingRain
;		AttributeModifier				= RainDebuff ;;.;; Added
;		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO -HORDE -MordorBlackRider -MordorBlackRiderHorde -DwarvenZerker -NoldorWarrior -GondorKnightsofDol -GondorKnightsofDolHorde -WildBabyDrake -WildBabyDrakeHorde -IsengardFanatic ENEMIES ;;.;; ALL ENEMIES
;		AntiCategory					= BUFF LEADERSHIP ;;,;; added BUFF
;		AntiFX							= FX_AntiLeadership ; FX for anti category
;		AttributeModifierWeatherBased	= Yes
;		WeatherDuration					= SPELL_FREEZINGRAIN_DURATION
;		ChangeWeather					= RAINY
;		AvailableAtStart				= No
;		BurnRateModifier				= -100
;		BurnDecayModifier				= 20
;		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
;		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
;	End

 	; Behavior = OCLSpecialPower ModuleTag_FreezingRain ;;,;; new 2.02e Freezing Rain
		; SpecialPowerTemplate		= SpellBookFreezingRain
		; OCL				= OCL_FreezingRainWeatherChanger ; OCL_FreezingRainCaster
		; CreateLocation			= CREATE_AT_LOCATION
		; AttributeModifierWeatherBased	= Yes
		; WeatherDuration			= SPELL_FREEZINGRAIN_DURATION
		; ChangeWeather			= RAINY
		; AvailableAtStart		= No
; ;		BurnRateModifier		= -100 ; removing these two lines...
; ;		BurnDecayModifier		= 20 ; ...because they're not allowed in an OCLSpecialPower =(
		; RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		; RequirementsFilterStrategic	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	; End
	
	Behavior = OCLSpecialPower ModuleTag_FreezingRain 
        SpecialPowerTemplate        = SpellBookFreezingRain
        OCL                = OCL_FreezingRainWeatherChanger 
        CreateLocation            = CREATE_AT_LOCATION
        AttributeModifierWeatherBased    = Yes
        WeatherDuration            = SPELL_FREEZINGRAIN_DURATION
        ChangeWeather            = CLOUDY
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish     = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic    = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = CloudBreakSpecialPower    ModuleTag_RainFX 
        SpecialPowerTemplate            = SpellBookRainFX
        SunbeamObject                    = RainFX
        ObjectSpacing                    = 300            
        WeatherDuration                    = SPELL_FREEZINGRAIN_DURATION
        AvailableAtStart                = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End
	
	Behavior = OCLSpecialPower ModuleTag_WhiteWinter 
        SpecialPowerTemplate        = SpellBookWhiteWinter
        OCL                = OCL_WhiteWinterWeatherChanger 
        CreateLocation            = CREATE_AT_LOCATION
        AttributeModifierWeatherBased    = Yes
        WeatherDuration            = SPELL_FREEZINGRAIN_DURATION
        ChangeWeather            = CLOUDY
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish     = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic    = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = CloudBreakSpecialPower    ModuleTag_WhiteWinterFX 
        SpecialPowerTemplate            = SpellBookWhiteWinterFX
        SunbeamObject                    = WhiteWinterFX
        ObjectSpacing                    = 300            
        WeatherDuration                    = SPELL_FREEZINGRAIN_DURATION
        AvailableAtStart                = No		
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

;	Behavior = SpecialPowerModule		SpellBookFuelTheFires_ModuleTag ;;,;; original 2.01 Fuel the Fires, removed for 2.02e
;		SpecialPowerTemplate		= SpellBookFueltheFires
;		; Done in science check on the lumber mill, so that this global effect will work on future lumber mills
;;		AttributeModifier			= SpellBookFueltheFires
;;		AttributeModifierRange		= 999999
;;		AttributeModifierAffects	= ANY +SUPPLY_GATHERING_CENTER
;		UpdateModuleStartsAttack	= No
;		AvailableAtStart			= No
;		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
;		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
;	End

	Behavior = PlayerUpgradeSpecialPower	SpellBookFuelTheFires_ModuleTag	;;,;; added for 2.02e
		SpecialPowerTemplate		= SpellBookFueltheFires
		UpgradeName 			= Upgrade_GrantFueltheFires
		UpdateModuleStartsAttack	= No
		AffectAllies			= No
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonWatcher
		SpecialPowerTemplate = SpellBookWatcherAlly
		OCL                  = OCL_WatcherSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonWights
		SpecialPowerTemplate 		= SpellBookSummonWights
		OCL                  		= OCL_SpellBookSummonBarrowWights
		TriggerFX	 		= FX_SummonWights ;FX_SummonWildmen
		CreateLocation       		= CREATE_AT_LOCATION
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
 
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
 
	Behavior = OCLSpecialPower ModuleTag_SummonShadeOfWolf
		SpecialPowerTemplate = SpellBookSummonShadeOfWolf
		OCL                  = OCL_ShadeofWolfSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower	ModuleTag_SummonGuldurGreenMist
		SpecialPowerTemplate	= SpellBookGuldurGreenMist
		OCL						= OCL_GuldurGreenMist
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End		
	
	Behavior = OCLSpecialPower ModuleTag_SummonGwanthaur
		SpecialPowerTemplate 			= SpellBookSummonGwanthaur
		OCL                  			= OCL_GwanthaurSummoning
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
 
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_RainOfFire02
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_DragonAlly
		SpecialPowerTemplate = SpellBookDragonAlly
		OCL                  = OCL_SummonedDragon
		TriggerFX			 = FX_SummonDragon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
 
	Behavior = OCLSpecialPower ModuleTag_DragonStrike
		SpecialPowerTemplate = SpellBookDragonStrike
		OCL                  = OCL_SpellBookDragonStrike
		CreateLocation       = CREATE_AT_EDGE_NEAR_TARGET_AND_MOVE_TO_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_Avalanche
		SpecialPowerTemplate 		= SpellBookAvalanche
		OCL                  		= OCL_SpellBookAvalancheEgg
		CreateLocation       		= CREATE_AT_LOCATION
		TriggerFX			 = FX_Avalanche
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SouthronTowerHarad
		SpecialPowerTemplate = SpellBookSpawnHaradSentryTower
		OCL                  = OCL_SpellBookSouthronBarricade ;OCL_GondorSpellBookSpawnLoneTower
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
		//UseDistanceFromCommandCenter	= Yes
		//DistanceFromCommandCenter		= LONE_TOWER_EFFECTIVE_RADIUS
	End	
	
	Behavior = OCLSpecialPower ModuleTag_Oasis
		SpecialPowerTemplate			= SpellBookHaradOasis
		OCL                  			= OCL_SpellBookOasis
		TriggerFX			 			= FX_StartThrorHoard
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonAicanaroc
		SpecialPowerTemplate = SpellBookAicanaroc
		OCL                  = OCL_SpawnAicanaroc
		CreateLocation       = CREATE_ABOVE_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_BurningSands
		SpecialPowerTemplate 			= SpellBookHaradSunstroke
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
		; Behavior = OCLSpecialPower	ModuleTag_OCLCurseWindDemon
		; SpecialPowerTemplate	= SpellBookWindDemon
		; OCL						= OCL_BreezeofManwe
		; CreateLocation			= CREATE_AT_LOCATION
		; UpdateModuleStartsAttack	= No
		; AvailableAtStart	 = No
		; RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		; RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	; End
	Behavior = OCLSpecialPower ModuleTag_WindDemon
		SpecialPowerTemplate 		= SpellBookWindDemon
		OCL                  		= OCL_SpellBookWindDemon
		CreateLocation       		= CREATE_AT_LOCATION
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
    	Behavior = AISpecialPowerUpdate Command_SpecialPowerHaradCurseWindDemonAI
       		CommandButtonName = Command_SpecialPowerHaradCurseWindDemon
        	SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    	End
		
	Behavior = CloudBreakSpecialPower	ModuleTag_HaradUnrelentingSun
		SpecialPowerTemplate			= SpellBookUnrelentingSun
		SunbeamObject					= WesternWindsSunbeam
		ObjectSpacing					= 300
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes ; cancel negative effects on good guys
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_CLOUDBREAK_DURATION
		ChangeWeather					= SUNNY
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
		Behavior = AISpecialPowerUpdate SpellBookUnrelentingSunAngmarAI  
		CommandButtonName = Command_SpellBookHaradUnrelentingSun
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ; wait for an opportune moment to fire? ;;,;; AI_SPELLBOOK_ALWAYS_FIRE
		SpecialPowerRadius = 100
	End
	
	Behavior = ProductionSpeedBonus ModuleTag_HaradCalltheHorde
		SpecialPowerTemplate	= SpellBookThreatOfMordor
		NumberOfFrames			= 160 ;1800
		SpeedMulitplier			= 20.0  ; 12x speedup BALANCE
		Type					= HaradBlackNumenoranWarriorsHorde HaradBlackNumenoreanVanguardHorde HaradCorsairsOfUmbarHorde HaradGuardsoftheSerpentHorde HaradHalfTrollMarauderHorde HaradHaradrimSpearmenHorde HaradWaithHaradrimRaiderHorde HarondorArcherHorde HaradMahudWarriorHorde HaradMahudHeadhunterHorde      ;GoblinTownFighterHorde MordorFighterHorde MordorPikemanHorde MordorArcherHorde MordorBlackOrcHorde MordorMorgulOrcHorde GoblinFighterHorde GoblinArcherHorde GoblinFighterHorde_FromDefectedLair GoblinArcherHorde_FromDefectedLair 
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = AISpecialPowerUpdate SpellHaradCalltheHordeAI
		CommandButtonName = Command_SpellBookHaradThreatofMordor
		SpecialPowerAIType = AI_SPELLBOOK_CALLTHEHORDE
		SpecialPowerRadius = 100
	End

	Behavior = BuildableHeroListUpgrade BitsUpgrade
		TriggeredBy = Upgrade_RingHero
	End
	
	;///////////////////////////////////////////
	;// AI Heuristics for SkirmishAI
	;///////////////////////////////////////////

	Behavior = AISpecialPowerUpdate SpellBookBlightAI
		CommandButtonName = Command_SpellBookBlight
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;;,;; note - wait to use for when allies are around to cause extra damage? ;;.;; AI_SPELLBOOK_DEBUFFECONOMYBUILDING
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 750 ;;,;; Added for 3.0.1
	End

	Behavior = AISpecialPowerUpdate SpellBookFrozenLandAI
		CommandButtonName = Command_SpellBookFrozenLand
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; AI_SPELLBOOK_BUFFTERRAIN ;;,;; Changed for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1 
	End

	Behavior = AISpecialPowerUpdate SpellBookChillWindAI
		CommandButtonName = Command_SpellBookChillWind
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookChillOfGraveAI
		CommandButtonName = Command_SpellBookGuldurChillOfGrave
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
	End	

	Behavior = AISpecialPowerUpdate SpellBookSnowbindAI
		CommandButtonName = Command_SpellBookSnowbind
		SpecialPowerAIType = AI_SPELLBOOK_REBUILD ; use on own structures when low in health ;;,;; AI_SPELLBOOK_DEBUFFPRODUCTIONBUILDING
;;,;;	SpecialPowerAIType = AI_SPELLBOOK_DEBUFFPRODUCTIONBUILDING ;;,;; Removed for 2.5
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookSummonGiantsAI
		CommandButtonName = Command_SpellBookSummonGiants
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS ; just in case of a camper ;;,;; AI_SPELLBOOK_STRUCTURE_BREAKER
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerRadius = 200 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 250 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookSummonWightsAI
		CommandButtonName = Command_SpellBookSummonWights
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;;,;; AI_SPELLBOOK_CITADEL ; use on enemy hordes ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;;,;; Changed for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;;,;; Added for 2.4
		SpecialPowerRadius = 150 ;;,;; 200 ;;,;; Changed for 3.0.1
;;,;;	RandomizeTargetLocation = Yes
		SpecialPowerRange = 900 ;;,;; 600 ;;,;; 250 ;;,;; added	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookShadeOfWolfAI
		CommandButtonName = Command_SpellBookSummonShadeOfWolf
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS ;,; AI_SPELLBOOK_ARMY_BREAKER ; center summon on enemy army for summon damage ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;,; AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS ;;,;; AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Changed for 2.5
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
;;,;;		RandomizeTargetLocation = Yes
		SpecialPowerRange = 1500 ;;,;; 1000 ;;,;; 300 ;;,;; added	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookFellStorm
		CommandButtonName = Command_SpellBookFellStorm
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 1500 ;;,;; 1000	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
						//this power can be used on ;;,;; Changed for 3.0.0
		RandomizeTargetLocation = Yes
	End

	Behavior = AISpecialPowerUpdate SpellBookAvalancheAI
		CommandButtonName = Command_SpellBookAvalanche
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;;,;; Added for 2.5
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 1500 ;;,;; 1000	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End

	Behavior = AISpecialPowerUpdate SpellBookWarChantAI
		CommandButtonName = Command_SpellBookWarChant
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookCarnageAI
		CommandButtonName = Command_SpellBookGuldurCarnage
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End	
	
	Behavior = AISpecialPowerUpdate SpellBookConcealmentAI
		CommandButtonName = Command_SpellBookGuldurConcealment
		;SpecialPowerAIType = AI_SPELLBOOK_ENSHROUDINGMIST
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 150
		SpecialPowerRange = 250
	End

	Behavior = AISpecialPowerUpdate SpellBookDarkHysteriaAI
		CommandButtonName = Command_SpellBookGuldurDarkHysteria
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
	End	
	
	Behavior = AISpecialPowerUpdate SpellBookGuldurForestAI
		CommandButtonName = Command_SpellBookGuldurForestOfFear
		;SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF		
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookGuldurWitherAI
		CommandButtonName = Command_SpellBookGuldurWither
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER
		SpecialPowerRadius = 200
		RandomizeTargetLocation = Yes
	End	
	
	Behavior = AISpecialPowerUpdate SpellBookUndeadTrollAI
		CommandButtonName = Command_SpellBookGuldurUndeadTroll
		;SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerRadius = 150
		;SpecialPowerRange = 900
	End	

	Behavior = AISpecialPowerUpdate SpellBookWarChantAIMordor
		CommandButtonName = Command_SpellBookWarChantMordor
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookBarricadeAI
		CommandButtonName = Command_SpellBookBarricade
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
		SpellMakesAStructure = Yes
		RandomizeTargetLocation = Yes
	End

	Behavior = AISpecialPowerUpdate SpellBookDolGulAlliesAI
		CommandButtonName = Command_SpellBookDolGuldurAllies
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
		SpellMakesAStructure = Yes
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookArrowVolleyEvilAI
		CommandButtonName = Command_SpellBookArrowVolleyEvil ;Command_SpellBookFellStorm
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;;,;; Added for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 900 ;;,;; 600 ;;,;; 250	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End

	Behavior = AISpecialPowerUpdate SpellBookHaradAlliesAI
		CommandButtonName = Command_SpellBookHaradrimRaiders
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; Added for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End

	Behavior = AISpecialPowerUpdate SpellBookShelobSummonAI
		CommandButtonName = Command_SpellBookShelobSummon
		;SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 150
		SpecialPowerRange = 800
		RandomizeTargetLocation = Yes
	End

	Behavior = AISpecialPowerUpdate SpellBookFellbeastAlliesAI
		CommandButtonName = Command_SpellBookWraith
		;SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; Added for 2.4
		;SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookGuldurBlackWargAI
		CommandButtonName = Command_SpellBookGuldurBlackWarg
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 150
		RandomizeTargetLocation = Yes
	End	
	
	Behavior = AISpecialPowerUpdate SpellBookWildMenAlliesAI
		CommandButtonName = Command_SpellBookWildMenAllies
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS ;,; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;,; AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS ;;,;; AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Changed for 2.5
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; ;;,;; Changed for 3.0.1
		RandomizeTargetLocation = Yes
	End

	Behavior = AISpecialPowerUpdate SpellBookMordorAlliesAI
		CommandButtonName = Command_SpellBookMordorAllies
		;SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS ;,; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;,; AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS ;;,;; AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Changed for 2.5
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; ;;,;; Changed for 3.0.1
		RandomizeTargetLocation = Yes
	End

	Behavior = AISpecialPowerUpdate SpellBookSummonOrcsAI ;;,;; added for 2.0
		CommandButtonName = Command_SpellBookSummonOrcs
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;;,;; AI_SPELLBOOK_CITADEL ; use on enemy hordes ;;,;; Changed for 2.4
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
	End

	Behavior = AISpecialPowerUpdate SpellBookCrackOfDoomAI ;;,;; added for 2.0
		CommandButtonName = Command_SpellBookCrackOfDoom
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;;,;; AI_SPELLBOOK_CITADEL ; use on enemy hordes ;;,;; Changed for 2.4
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
	End

	Behavior = AISpecialPowerUpdate SpellBookMordorGenericLeadershipAI ;;,;; added for 2.0
		CommandButtonName = Command_SpellBookMordorGenericLeadership
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;;,;; AI_SPELLBOOK_CITADEL ; use on enemy hordes ;;,;; Changed for 2.4
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookGuldurShadeDecoyAI
		CommandButtonName = Command_SpellBookGuldurShadeDecoy
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;;,;; AI_SPELLBOOK_CITADEL ; use on enemy hordes ;;,;; Changed for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
	End	
	
	Behavior = AISpecialPowerUpdate SpellBookGuldurShadeAI
		CommandButtonName = Command_SpellBookGuldurShadeAI
		SpecialPowerAIType = AI_SPELLBOOK_TREE_KILLER
		SpecialPowerAIType = AI_SPELLBOOK_CITADEL
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; AI_SPELLBOOK_CITADEL ; use on enemy hordes ;;,;; Changed for 2.4
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
	End	
	
	Behavior = AISpecialPowerUpdate SpellBookSpiderlingAlliesAI
		CommandButtonName = Command_SpellBookSpiderlingAllies
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookWatcherAllyAI
		CommandButtonName = Command_SpellBookWatcherAlly
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ; use only on really big armies ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
;		RandomizeTargetLocation = Yes ;;,;; Removed for 2.1 - should have been removed when first switched to Army Breaker
		SpecialPowerRange = 1500 ;;,;; 1000 ;;,;; 600 ;;,;; added	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookEvilBombard ;;,;; added for 2.0, was missing
		CommandButtonName = Command_SpellBookEvilBombard ;;,;; Command_SpellBookBombard
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;,; AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL ;;,;; Added for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;,; AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 1500 ;;,;; 1000 ;;,;; 600	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End

	Behavior = AISpecialPowerUpdate SpellBookRainOfFireAI
		CommandButtonName = Command_SpellBookRainOfFire
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;,; AI_SPELLBOOK_ARMY_BREAKER ;;,;; Added for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;,; AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 1500 ;;,;; 1000 ;;,;;	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookDragonStrikeAI
		CommandButtonName = Command_SpellBookDragonStrike
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL 
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
	End
	
	Behavior = AISpecialPowerUpdate SpellBookBalrogAllyAI
		CommandButtonName = Command_SpellBookBalrogAlly
	;	SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS ;,; AI_SPELLBOOK_ARMY_BREAKER ; center summon on enemy army for summon damage ;;,;; AI_SPELLBOOK_STRUCTURE_BASEKILL
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;,; AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS ;;,;; AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Changed for 2.5
		SpecialPowerRadius = 200 ;;,;; 100 ;;,;; Changed for 3.0.1
;;,;;		RandomizeTargetLocation = Yes
		SpecialPowerRange = 1500 ;;,;; 1000 ;;,;; 600 ;;,;; 300 ;;,;; added	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookGwanthaurAI
		CommandButtonName = Command_SpellBookSummonGwanthaur
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS		
		SpecialPowerRadius = 200
		SpecialPowerRange = 1500
	End

	Behavior = AISpecialPowerUpdate SpellBookGreenMistAI
		CommandButtonName = Command_SpellBookGuldurGreenMist
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF	
		SpecialPowerRadius = 200
		SpecialPowerRange = 800
	End		
	
	Behavior = AISpecialPowerUpdate SpellBookDragonAllyAI
		CommandButtonName = Command_SpellBookDragonAlly
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;,; AI_SPELLBOOK_ARMY_BREAKER ; center summon on enemy army for summon damage ;;,;; AI_SPELLBOOK_STRUCTURE_BREAKER
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;,; AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerRadius = 200 ;;,;; 100 ;;,;; Changed for 3.0.1
;;,;;		RandomizeTargetLocation = Yes
		SpecialPowerRange = 1500 ;;,;; 1000 ;;,;; 600 ;;,;; 300 ;;,;; added	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookAwakenWyrmAI
		CommandButtonName = Command_SpellBookAwakenWyrm
		;SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS
		;SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;;,;; Added for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		RandomizeTargetLocation = Yes
		SpecialPowerRange = 900 ;;,;; 600	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookEyeofSauronAI
		CommandButtonName = Command_SpellBookEyeofSauron
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ; use for the Leadership, scouting doesn't help AI anyway ;;,;; AI_SPELLBOOK_SHROUD_REVEAL
		SpecialPowerRadius = 100
		RandomizeTargetLocation	= Yes ;;,;; added
	End
	
	Behavior = AISpecialPowerUpdate SpellBookPalantirVisionAI	;;.;; Added for 2.02 - this replaces an entry for Farsight, which in turn was moved to the FoL Spell Book
		CommandButtonName = Command_SpellBookPalantirVision
		SpecialPowerAIType = AI_SPELLBOOK_SHROUD_REVEAL
		SpecialPowerRadius = 100
	End

	Behavior = AISpecialPowerUpdate SpellBookEvilEyeofSauronAI
		CommandButtonName = Command_SpellBookEvilEyeofSauron
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ; use for the Leadership, scouting doesn't help AI anyway ;;,;; AI_SPELLBOOK_SHROUD_REVEAL
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes ;;,;; added
	End
	
	Behavior = AISpecialPowerUpdate SpellBookCrebainAI
		CommandButtonName = Command_SpellBookCrebain ;Command_SpellBookRavens
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookCaveBatsAI
		CommandButtonName = Command_SpellBookCaveBats
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookDarknessAI
		CommandButtonName = Command_SpellBookDarkness
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookGuldurDarknessAI
		CommandButtonName = Command_SpellBookGuldurDarkness
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
		SpecialPowerRadius = 100
	End	
	
	Behavior = AISpecialPowerUpdate SpellBookFreezingRainAI
		CommandButtonName = Command_SpellBookFreezingRain
		;CommandButtonName = Command_SpecialAbilityFreezingRainFX
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
		SpecialPowerRadius = 100
	End
	
	; Behavior = AISpecialPowerUpdate SpellBookFreezingRainFXAI
		; CommandButtonName = Command_SpecialAbilityFreezingRainFX
		; SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
		; SpecialPowerRadius = 100
	; End
	
	Behavior = AISpecialPowerUpdate SpellBookWhiteWinterAI
		CommandButtonName = Command_SpellBookWhiteWinter
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
		SpecialPowerRadius = 100
	End
	
	; Behavior = AISpecialPowerUpdate SpellBookWhiteWinterFXAI
		; CommandButtonName = Command_SpecialAbilityWhiteWinterFX
		; SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
		; SpecialPowerRadius = 100
	; End
	
	Behavior = AISpecialPowerUpdate SpellBookUntamedAllegianceAI
		CommandButtonName = Command_SpellBookUntamedAllegiance
		SpecialPowerAIType = AI_SPELLBOOK_CAPTURE_CREEP
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookDevastationAI
		CommandButtonName = Command_SpellBookDevastation ;Command_SpellBookLorienTrap
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ; AI_SPELLBOOK_TREE_KILLER Was this but battle buffs are better for AI Anyways.
		SpecialPowerRadius = 100
	End

	Behavior = AISpecialPowerUpdate SpellBookEyeofSauronNewAI
		CommandButtonName = Command_SpellBookEyeofSauronNew ;Command_SpellBookLorienTrap
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ; AI_SPELLBOOK_TREE_KILLER Was this but battle buffs are better for AI Anyways.
		SpecialPowerRadius = 100
	End

	Behavior = AISpecialPowerUpdate SpellBookTaintAI
		CommandButtonName = Command_SpellBookTaint
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; AI_SPELLBOOK_BUFFTERRAIN ;;,;; Changed for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	End	
	
	Behavior = AISpecialPowerUpdate SpellBookIsengardTaintAI ;;,;; added for 2.0, was missing
		CommandButtonName = Command_SpellBookIsengardTaint
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; AI_SPELLBOOK_BUFFTERRAIN ;;,;; Changed for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	End
	
	Behavior = AISpecialPowerUpdate SpellBookRebuildAI
		CommandButtonName = Command_SpellBookRebuild
		SpecialPowerAIType = AI_SPELLBOOK_REBUILD
		SpecialPowerRadius = 100
	End	
	Behavior = AISpecialPowerUpdate SpellBookGondorRebuildAI
		CommandButtonName = Command_SpellBookGondorRebuild
		SpecialPowerAIType = AI_SPELLBOOK_REBUILD
		SpecialPowerRadius = 100
	End

	Behavior = AISpecialPowerUpdate SpellBookIndustryAI
		CommandButtonName = Command_SpellBookIndustry
		SpecialPowerAIType = AI_SPELLBOOK_BUFFECONOMYBUILDING
		SpecialPowerRadius = 100
	End

	Behavior = AISpecialPowerUpdate SpellBookIndustryAIMordor
		CommandButtonName = Command_SpellBookIndustryMordor
		SpecialPowerAIType = AI_SPELLBOOK_BUFFECONOMYBUILDING
		SpecialPowerRadius = 100
	End

	Behavior = AISpecialPowerUpdate SpellCalltheHordeAI
		CommandButtonName = Command_SpellBookMordorCalltheHorde ;Command_SpellBookMustertheDwarves
		;SpecialPowerAIType = AI_SPELLBOOK_CALLTHEHORDE
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellAngmarCitadelAI
		CommandButtonName = Command_SpellBookAngmarCitadel 
		SpecialPowerAIType = AI_SPELLBOOK_CITADEL
		SpecialPowerRadius = 800
		RandomizeTargetLocation = Yes
		SpellMakesAStructure = Yes
	End

	Behavior = AISpecialPowerUpdate SpellLonghouseAI
		CommandButtonName = Command_SpellBookLonghouse 
		SpecialPowerAIType = AI_SPELLBOOK_CITADEL
		SpecialPowerRadius = 800
		RandomizeTargetLocation = Yes
		SpellMakesAStructure = Yes
	End

	Behavior = AISpecialPowerUpdate SpellWildCalltheHordeAI
		CommandButtonName = Command_SpellBookMordorCalltheHordeWild ;Command_SpellBookMustertheDwarves
		;SpecialPowerAIType = AI_SPELLBOOK_CALLTHEHORDE
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookUntamedAllegiancedAI
		CommandButtonName = Command_SpellBookUntamedAllegiance ;Command_SpellBookMustertheDwarves
		SpecialPowerAIType = AI_SPELLBOOK_CAPTURE_CREEP
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookFueltheFiresAI ;,; Added in v5.1
        CommandButtonName = Command_SpellBookFueltheFires
        SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate SpellBookScavengerAI ;,; Added in v5.1
        CommandButtonName = Command_SpellBookScavenger
        SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
        SpecialPowerRadius = 100
    End
	
	CommandSet          = EvilSpellBookCommandSet
	RadarPriority       = NOT_ON_RADAR
	KindOf              = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject MordorSpellBook EvilSpellBook
	CommandSet          = MordorSpellBookCommandSet
End

ChildObject MordorSpellBook_WOTR EvilSpellBook
	CommandSet          = MordorSpellBookCommandSet_WOTR
End

ChildObject IsengardSpellBook EvilSpellBook
	CommandSet          = IsengardSpellBookCommandSet
End

ChildObject IsengardSpellBook_WOTR EvilSpellBook
	CommandSet          = IsengardSpellBookCommandSet_WOTR
End

ChildObject WildSpellBook EvilSpellBook
	CommandSet          = WildSpellBookCommandSet
End

ChildObject WildSpellBook_WOTR EvilSpellBook
	CommandSet          = WildSpellBookCommandSet_WOTR
End

ChildObject GuldurSpellBook EvilSpellBook
	CommandSet          = GuldurSpellBookCommandSet
End

ChildObject GuldurSpellBook_WOTR EvilSpellBook
	CommandSet          = GuldurSpellBookCommandSet_WOTR
End

ChildObject AngmarSpellBook EvilSpellBook
	CommandSet          = AngmarSpellBookCommandSet
End

ChildObject AngmarSpellBook_WOTR EvilSpellBook
	CommandSet          = AngmarSpellBookCommandSet
End

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;; GOOD SPELLS ;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Object GoodSpellBook
	EditorSorting = SYSTEM
    
	; *** ART Parameters ***
	Draw                = W3DDefaultDraw ModuleTag_01
	;nothing
	End  ; Never drawn

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; CAMERA SYSTEM ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

    Behavior = SpecialPowerModule ModuleTag_SpellBookGeneralView
        SpecialPowerTemplate            = SpellBookGeneralView
        AvailableAtStart                = No
    End

    Behavior = SpecialPowerModule ModuleTag_SpellBookCommanderView
        SpecialPowerTemplate            = SpellBookCommanderView
        AvailableAtStart                = No
    End

    Behavior = SpecialPowerModule ModuleTag_SpellBookUnitView
        SpecialPowerTemplate            = SpellBookUnitView
        AvailableAtStart                = No
    End

    Behavior = SpecialPowerModule ModuleTag_SpellBookGroundView
        SpecialPowerTemplate            = SpellBookGroundView
        AvailableAtStart                = No
    End

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; CAMERA SYSTEM END ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

    
  	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY DOZER ;;,;; Removed SHIP ; RotWK originally had these as well MONSTER MACHINE
		HealAmount			  = 0.5 ;;,;; 0.6 ;1.0	; 0.5 = 50% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
  	Behavior = SpecialPowerModule	SpellBookDraft_Draft
		SpecialPowerTemplate		= SpellBookDraft
		AttributeModifier			= SpellBookDraft
		AttributeModifierRange		= 999999
		AttributeModifierAffects	= ANY +RohanPeasant +RohanPeasant1 +RohanPeasantHorde -RohanPeasant_Patrol -RohanPeasant_Drafted -RohanPeasant_Summoned
		AffectAllies				= No ; Should not try to affect ally units
		AttributeModifierFX			= FX_Draft now in SubObjectsUpgrade in the unit
		UpdateModuleStartsAttack	= No
		;AttributeModifierFX			= FX_PeasantVoiceDraftUpgrade	;voice only
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC		
	End		

	Behavior = PlayerUpgradeSpecialPower	SpellBookElvenGifts_ModuleTag
		SpecialPowerTemplate		= SpellBookElvenGifts
		UpgradeName 				= Upgrade_ElvenGift ;Upgrade_ArmorofOld
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = PlayerUpgradeSpecialPower	SpellBookArmorofOld_ModuleTag
		SpecialPowerTemplate		= SpellBookArmorofOld
		UpgradeName 				= Upgrade_ArmorofOld
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_SpawnLoneTower
		SpecialPowerTemplate = SpellBookSpawnLoneTower
		OCL                  = OCL_GondorSpellBookSpawnLoneTower
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
		//UseDistanceFromCommandCenter	= Yes
		//DistanceFromCommandCenter		= LONE_TOWER_EFFECTIVE_RADIUS
	End	
	
	Behavior = OCLSpecialPower ModuleTag_CampaignSpawnLoneTower
		SpecialPowerTemplate = SpellBookCampaignSpawnLoneTower
		OCL                  = OCL_CampaignSpellBookSpawnLoneTower
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
		//UseDistanceFromCommandCenter	= Yes
		//DistanceFromCommandCenter		= LONE_TOWER_EFFECTIVE_RADIUS
	End		

	Behavior = OCLSpecialPower ModuleTag_SpawnLoneTowerDwarf
		SpecialPowerTemplate = SpellBookSpawnLoneTowerDwarf
		OCL                  = OCL_DwarfSpellBookSpawnLoneTower
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
		//UseDistanceFromCommandCenter	= Yes
		//DistanceFromCommandCenter		= LONE_TOWER_EFFECTIVE_RADIUS
	End	

	Behavior = OCLSpecialPower ModuleTag_EnshroudingMist
		SpecialPowerTemplate = SpellBookEnshroudingMist
		OCL                  = OCL_SpecialPowerEnshroudingMist
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_CampaignEnshroudingMist
		SpecialPowerTemplate = SpellBookCampaignEnshroudingMist
		OCL                  = OCL_SpecialPowerEnshroudingMist
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_EnshroudingMistLorien
		SpecialPowerTemplate = SpellBookEnshroudingMistLorien
		OCL                  = OCL_SpecialPowerEnshroudingMistLorien
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = SpecialPowerModule ModuleTag_RallyingCall
		SpecialPowerTemplate		= SpellBookRallyingCall
		AttributeModifier			= SpellBookRallyingCallModifier
		AttributeModifierRange		= 100
		AttributeModifierAffects	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER ;;,;; ANY +HORDE +INFANTRY -HERO -MordorBlackRiderHorde -MordorBlackRider -GondorKnightsofDol -GondorKnightsofDolHorde -IsengardFanatic -IsengardBerserkerHorde  -DwarvenZerker -DwarvenZerkerHorde -NoldorWarrior -NoldorWarriorHorde -WildBabyDrakeHorde -WildBabyDrake ;;.;; Added rest of MHH
		TriggerFX					= FX_SpellRallyingCall
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = SpecialPowerModule ModuleTag_CampaignGloriousCharge
		SpecialPowerTemplate		= SpellBookCampaignGloriousCharge
		AttributeModifier			= SpellBookGloriousCharge
		AttributeModifierRange		= 150
		AttributeModifierAffects	= ANY +CAVALRY +HERO
		;TriggerFX					= FX_SpellRallyingCall
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = SpecialPowerModule ModuleTag_RallyingCallErebor
		SpecialPowerTemplate		= SpellBookRallyingCallErebor
		AttributeModifier			= SpellBookRallyingCallModifier
		AttributeModifierRange		= 100
		AttributeModifierAffects	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER ;;,;; ANY +HORDE +INFANTRY -HERO -MordorBlackRiderHorde -MordorBlackRider -GondorKnightsofDol -GondorKnightsofDolHorde -IsengardFanatic -IsengardBerserkerHorde  -DwarvenZerker -DwarvenZerkerHorde -NoldorWarrior -NoldorWarriorHorde -WildBabyDrakeHorde -WildBabyDrake ;;.;; Added rest of MHH
		TriggerFX					= FX_EreborHorn
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower	ModuleTag_OCLRavens
		SpecialPowerTemplate	= SpellBookRavens
		OCL						= SUPERWEAPON_SpawnRavens
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = SpecialPowerModule ModuleTag_RallyingCallGondor
		SpecialPowerTemplate		= SpellBookRallyingCallGondor
		AttributeModifier			= SpellBookRallyingCallModifier
		AttributeModifierRange		= 100
		AttributeModifierAffects	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER ;;,;; ANY +HORDE +INFANTRY -HERO -MordorBlackRiderHorde -MordorBlackRider -GondorKnightsofDol -GondorKnightsofDolHorde -IsengardFanatic -IsengardBerserkerHorde  -DwarvenZerker -DwarvenZerkerHorde -NoldorWarrior -NoldorWarriorHorde -WildBabyDrakeHorde -WildBabyDrake ;;.;; Added rest of MHH
		TriggerFX					= FX_GondorRallyCall
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = SpecialPowerModule ModuleTag_RallyingCallLorien
		SpecialPowerTemplate		= SpellBookRallyingCallElves
		AttributeModifier			= SpellBookRallyingCallModifier
		AttributeModifierRange		= 100
		AttributeModifierAffects	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER ;;,;; ANY +HORDE +INFANTRY -HERO -MordorBlackRiderHorde -MordorBlackRider -GondorKnightsofDol -GondorKnightsofDolHorde -IsengardFanatic -IsengardBerserkerHorde  -DwarvenZerker -DwarvenZerkerHorde -NoldorWarrior -NoldorWarriorHorde -WildBabyDrakeHorde -WildBabyDrake ;;.;; Added rest of MHH
		TriggerFX					= FX_LorienHorn
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = SpecialPowerModule ModuleTag_RallyingCallMirkwood
		SpecialPowerTemplate		= SpellBookRallyingCallMirkwood
		AttributeModifier			= SpellBookRallyingCallModifier
		AttributeModifierRange		= 100
		AttributeModifierAffects	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
		TriggerFX					= FX_SpellMirkwoodRallyingCall
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_ElvenkingRoad
		SpecialPowerTemplate			= SpellBookElvenkingRoad
		OCL                  			= OCL_SpellBookElvenkingRoad
		TriggerFX			 			= FX_CAHTeleport
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_ElvenkingFeast
		SpecialPowerTemplate			= SpellBookElvenkingFeast
		OCL                  			= OCL_SpellBookElvenkingFeast
		TriggerFX			 			= FX_CAHTeleport
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_ElvenkingPatience
		SpecialPowerTemplate 			= SpellBookElvenkingPatience
		OCL                  			= OCL_SpellBookElvenkingPatience
		CreateLocation       			= CREATE_AT_LOCATION
		TriggerFX	 					= FX_ElvenkingPatience
		AvailableAtStart	 			= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End		
	
	Behavior = SpecialPowerModule	SpellBookMirkwoodScavenger_ModuleTag
		SpecialPowerTemplate		= SpellBookMirkwoodScavenger
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No		
		AttributeModifier			= SpellBookElvenkingDecree
		AttributeModifierRange		= 999999
		AttributeModifierAffects	= ANY +INFANTRY +CAVALRY +HERO -STRUCTURE -BASE_FOUNDATION -DOZER
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	

	Behavior = OCLSpecialPower ModuleTag_SummonEotheod
		SpecialPowerTemplate = SpellBookEotheodAllies
		OCL                  = OCL_SpawnEotheodEgg
       	TriggerFX			 = FX_RohirimSummon
		CreateLocation       = CREATE_AT_LOCATION
		;UpgradeName			 = 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_SummonEotheod_WOTR
		SpecialPowerTemplate = SpellBookEotheodAllies_WOTR
		OCL                  = OCL_SpawnEotheodEgg_WOTR
       	TriggerFX			 = FX_RohirimSummon
		CreateLocation       = CREATE_AT_LOCATION
		;UpgradeName			 = 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	

	Behavior = OCLSpecialPower ModuleTag_HuntOfOrome
		SpecialPowerTemplate 			= SpellBookHuntOfOrome
		OCL                  			= OCL_SpellBookHuntOfOrome
		CreateLocation       			= CREATE_AT_LOCATION
		TriggerFX	 					= FX_SpellGreatHuntofOrome
		AvailableAtStart	 			= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End			

	Behavior = OCLSpecialPower ModuleTag_TomBombadil
		SpecialPowerTemplate = SpellBookTomBombadil
		OCL                  = OCL_SpawnTomBombadilEgg
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
Behavior = OCLSpecialPower ModuleTag_LorienTrapSpecialPower
		SpecialPowerTemplate = SpellBookLorienTrap
		OCL                  = OCL_SpellBookLorienTrap
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	Behavior = PlayerUpgradeSpecialPower	SpellBookAmrothKnights_ModuleTag
		SpecialPowerTemplate		= SpellBookAmrothKnights
		UpgradeName 				= Upgrade_AmrothKnights ;Upgrade_ArmorofOld
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_CampaignRadagast
		SpecialPowerTemplate = SpellBookCampaignRadagast
		OCL                  = OCL_SpawnRadagastEggCampaign
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_Radagast
		SpecialPowerTemplate = SpellBookRadagast
		OCL                  = OCL_SpawnRadagastEgg
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonHobbits
		SpecialPowerTemplate = SpellBookHobbitAllies
		OCL                  = OCL_SpawnHobbitsEgg
        TriggerFX			 = FX_HobbitSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_HobbitFriends
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_Farsight
		SpecialPowerTemplate = SpellBookFarsight
		AttributeModifier	= PalantirVision ; ;
		AttributeModifierRange	= 120 ; ;
		AttributeModifierAffects = ANY +CAVALRY +MACHINE +HERO +INFANTRY +HORDE -STRUCTURE -BASE_FOUNDATION ; ;
		OCL                  = OCL_SpecialPowerFarSeeing
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	; Behavior				 = OCLSpecialPower ModuleTag_PalantirVision
		; SpecialPowerTemplate = SpellBookPalantirVision
		; AttributeModifier	= PalantirVision ; ;
		; AttributeModifierRange	= 120 ; ;
		; AttributeModifierAffects = ANY +CAVALRY +MACHINE +HERO +INFANTRY +HORDE -STRUCTURE -BASE_FOUNDATION ; ;
		; OCL                  = SpecialPowerPalantirVision
		; CreateLocation       = CREATE_AT_LOCATION
		; AvailableAtStart	 = No
		; RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		; RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	; End
	
	Behavior = PlayerHealSpecialPower ModuleTag_Rebuild
		SpecialPowerTemplate = SpellBookRebuild
		HealAffects			 = STRUCTURE
		HealAsPercent		 	 = No
		HealAmount			 = 4000
		HealRadius			 = SPELL_REBUILD_RADIUS_STRUCTURE_SCAN
		HealFX				 = FX_SpellRebuild
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = PlayerHealSpecialPower ModuleTag_RebuildErebor
		SpecialPowerTemplate = SpellBookRebuildErebor
		HealAffects			 = STRUCTURE
		HealAsPercent		 	 = No
		HealAmount			 = 4000
		HealRadius			 = SPELL_REBUILD_RADIUS_STRUCTURE_SCAN
		HealFX				 = FX_SpellRebuild
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = PlayerHealSpecialPower ModuleTag_RebuildRohan
		SpecialPowerTemplate = SpellBookRohanRebuild
		HealAffects			 = STRUCTURE
		HealAsPercent		 	 = No
		HealAmount			 = 4000
		HealRadius			 = SPELL_REBUILD_RADIUS_STRUCTURE_SCAN
		HealFX				 = FX_SpellRebuild
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	

	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_CampaignArrowVolley
		SpecialPowerTemplate = SpellBookCampaignArrowVolley
		OCL                  = OCL_SpellBookCampaignArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyLorien
		SpecialPowerTemplate = SpellBookArrowVolleyLorien
		OCL                  = OCL_SpellBookArrowVolleyLorien ;OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyMirkwood
		SpecialPowerTemplate = SpellBookMirkwoodArrowVolley
		OCL                  = OCL_SpellBookArrowVolleyMirkwood
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower		ModuleTag_MallornLand
		SpecialPowerTemplate		= SpellBookElvenWood
		TriggerFX					= FX_MallornWoodSpellFX
		OCL							= OCL_MallornWoodSeed
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower		ModuleTag_IthilienGarden
		SpecialPowerTemplate		= SpellBookIthilienGarden
		TriggerFX					= FX_IthilienGardenSpellFX
		OCL							= OCL_IthilienGardenSeed
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower		ModuleTag_AdamantWoodLand
		SpecialPowerTemplate		= SpellBookAdamantWood
		TriggerFX					= FX_AdamantWoodSpellFX
		OCL							= OCL_AdamantWoodSeed
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_CampaignElvenWood
		SpecialPowerTemplate	= SpellBookCampaignElvenWood		
		TriggerFX					= FX_ElvenWoodSpellFX
		OCL							= OCL_LorienWoodSeed
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No		
		AvailableAtStart			= No	
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	;Behavior = ElvenWoodSpecialPower ModuleTag_ElvenWood
	;	SpecialPowerTemplate	= SpellBookElvenWood
	;	ElvenGroveObject		= ElvenGrove
	;	ElvenWoodRadius			= SPELLBOOK_TAINT_RADIUS
	;	ElvenWoodFX				= FX_ElvenWoodSpellFX
	;	ElvenWoodOCL			= OCL_LorienWoodSeed
;		CreateLocation			= CREATE_AT_LOCATION
	;	AvailableAtStart		= No
	;	RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
	;	RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	;End
	
	;Behavior = ElvenWoodSpecialPower ModuleTag_ElvenWoodAdamant
	;	SpecialPowerTemplate	= SpellBookAdamantWood
	;	ElvenGroveObject		= ElvenGroveAdamant
	;	ElvenWoodRadius			= 300 ;SPELLBOOK_TAINT_RADIUS
	;	ElvenWoodFX				= FX_ElvenWoodSpellFX
	;	ElvenWoodOCL			= OCL_ElvenWoodSeed
;		CreateLocation			= CREATE_AT_LOCATION
	;	AvailableAtStart		= No
	;	RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
	;	RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	;End

;;,;; original 2.01 Dwarven Riches, removed for 2.02e
;	Behavior = SpecialPowerModule ModuleTag_DwarvenRiches
;		SpecialPowerTemplate		= SpellBookDwarvenRiches		
;		AttributeModifier			= SpellBookDwarvenRiches
;		AttributeModifierRange		= DWARVENRICHES_EFFECT_RADIUS
;		AttributeModifierAffects	= INDUSTRY_TYPE_SPELL_OBJECT_FILTER
;		TriggerFX					= FX_DwarvenRiches
;		UpdateModuleStartsAttack	= No
;		AvailableAtStart			= No
;		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
;		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
;	End
;;,;;

    ; Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FavorUpdate   
        ; SpecialPowerTemplate       = SpellBookFullyArmed
        ; ; SkipContinue               = Yes
        ; ; FreezeAfterTriggerDuration = 100 ; Hold AI for this long after we fire.
         ; UnpackTime                 = 1
         ; PreparationTime            = 1   
         ; PackTime                   = 1
        ; ; AwardXPForTriggering       = 0        
        ; ; StartAbilityRange          = 80        
        ; SpecialWeapon              = FullyArmedandFilthy
		; RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		; RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    ; End
	
	Behavior = SpecialPowerModule ModuleTag_FullyArmed1
		SpecialPowerTemplate		= SpellBookFullyArmed
		AttributeModifier			= FullyArmed1
		AttributeModifierRange		= 50
		AttributeModifierAffects	= NONE +HORDE -DwarvenGrimHammerHorde -DwarvenVWHorde -DwarvenEredLuinTraderHorde -IronHillsWarriorHorde -IronHillsCrossbowHorde -IronHillRiderHorde -DwarvenZerkerHorde -DwarvenZerkerHorde_WOTR -DorwinionFighterHorde -SUMMONED SAME_PLAYER
		TriggerFX					= FX_FullyArmedInitial
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	; Behavior = SpecialPowerModule ModuleTag_FullyArmed2
		; SpecialPowerTemplate		= SpellBookFullyArmed
		; AttributeModifier			= FullyArmed2
		; AttributeModifierRange		= 50
		; AttributeModifierAffects	= ANY +HORDE +INFANTRY -HERO
		; TriggerFX					= FX_SpellRallyingCall
		; UpdateModuleStartsAttack	= No
		; AvailableAtStart			= No
		; RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		; RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	; End

	Behavior = ProductionSpeedBonus ModuleTag_MustertheDwarves
		SpecialPowerTemplate	= SpellBookMustertheDwarves
		NumberOfFrames			= 160 ;1800
		SpeedMulitplier			= 20.0  ; 12x speedup BALANCE
		Type					= DwarvenPhalanxHorde DwarvenGuardianHorde DwarvenArcherHorde DwarvenGrimHammerHorde DwarvenVWHorde DwarvenEredLuinTraderHorde IronHillsWarriorHorde IronHillsCrossbowHorde IronHillRiderHorde DwarvenZerkerHorde DwarvenEredLuinRangerHorde KhazadUzbadulHorde
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = ProductionSpeedBonus ModuleTag_MusterRohirrim
		SpecialPowerTemplate	= SpellBookMusterRohirrim
		NumberOfFrames			= 160 ;1800
		SpeedMulitplier			= 20.0  ; 12x speedup BALANCE
		Type					= RohanHorsemenHorde RohanRohirrimHorde RohanRohirrimArcherHorde RohanSnowbournRiderHorde RohanRoyalGuardMountedHorde
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	

	Behavior = PlayerUpgradeSpecialPower	ModuleTag_PassiveDwarvenRiches	;;,;; added for 2.02e
		SpecialPowerTemplate		= SpellBookPassiveDwarvenRiches
		UpgradeName 			= Upgrade_GrantDwarvenRiches
		UpdateModuleStartsAttack	= No
		AffectAllies			= No
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = PlayerUpgradeSpecialPower	ModuleTag_PassiveDeepDelving	;;,;; added for 2.02e
		SpecialPowerTemplate		= SpellBookPassiveDeepDelving
		UpgradeName 			= Upgrade_GrantDwarvenRiches
		UpdateModuleStartsAttack	= No
		AffectAllies			= No
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_MenOfDaleAllies
		SpecialPowerTemplate = SpellBookMenOfDaleAllies
		OCL                  = OCL_SpawnMenOfDaleEgg
       	TriggerFX			 = FX_DunedainSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_MenOfDaleAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SilvanAllies
		SpecialPowerTemplate = SpellBookSilvanAllies
		OCL                  = OCL_SpawnSilvanAlliesEgg
       	TriggerFX			 = FX_MirkwoodElvesSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_ElvenAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_KhazadAllies
		SpecialPowerTemplate = SpellBookKhazadAllies
		OCL                  = OCL_SpawnKhazadAlliesEgg
       	;TriggerFX			 = FX_DunedainSummon
		CreateLocation       = CREATE_AT_LOCATION
		;UpgradeName			 = Upgrade_ElvenAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_RohanPukelStatue
		SpecialPowerTemplate = SpellBookRohanPukelStatue
		OCL                  = OCL_SpawnRohanPukelStatueEgg
       	;TriggerFX			 = FX_DunedainSummon
		CreateLocation       = CREATE_AT_LOCATION
		;UpgradeName			 = Upgrade_ElvenAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	

	Behavior = CloudBreakSpecialPower	ModuleTag_CloudBreak
		SpecialPowerTemplate			= SpellBookCloudBreak
		SunbeamObject					= CloudBreakSunbeam
		ObjectSpacing					= 300
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes ; cancel negative effects on good guys
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_CLOUDBREAK_DURATION
		ChangeWeather					= SUNNY
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = CloudBreakSpecialPower	ModuleTag_CampaignCloudBreak
		SpecialPowerTemplate			= SpellBookCampaignCloudBreak
		SunbeamObject					= CloudBreakSunbeam
		ObjectSpacing					= 300
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes ; cancel negative effects on good guys
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_CLOUDBREAK_DURATION
		ChangeWeather					= SUNNY
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = CloudBreakSpecialPower	ModuleTag_GondorWesternWinds
		SpecialPowerTemplate			= SpellBookGondorWesternWinds
		SunbeamObject					= WesternWindsSunbeam
		ObjectSpacing					= 300
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes ; cancel negative effects on good guys
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_CLOUDBREAK_DURATION
		ChangeWeather					= SUNNY
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = CloudBreakSpecialPower	ModuleTag_RohanCloudBreak
		SpecialPowerTemplate			= SpellBookRohanCloudBreak
		SunbeamObject					= CloudBreakSunbeam
		ObjectSpacing					= 300
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes ; cancel negative effects on good guys
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_CLOUDBREAK_DURATION
		ChangeWeather					= SUNNY
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = CloudBreakSpecialPower	ModuleTag_DurinsDay
		SpecialPowerTemplate			= SpellBookDurinsDay
		SunbeamObject					= DurinsDaySunbeam
		ObjectSpacing					= 300
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes ; cancel negative effects on good guys
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_CLOUDBREAK_DURATION
		ChangeWeather					= CLOUDY
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_CloudBreakNew ;,; Added in v5.1
        SpecialPowerTemplate            = SpellBookCloudBreak_Healing
        OCL                                = OCL_CloudBreak_Healing
        CreateLocation                   = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End
	
	Behavior = OCLSpecialPower ModuleTag_CloudBreakSpeedBonus
        SpecialPowerTemplate            = SpellBookCloudBreak_SpeedBonus
        OCL                                = OCL_CloudBreak_SpeedBonus
        CreateLocation                   = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End	
	
	Behavior = OCLSpecialPower ModuleTag_MirkwoodDarkness
		SpecialPowerTemplate			= SpellBookMirkwoodDarkness
		OCL								= OCL_MirkwoodDarknessWeatherChanger
		CreateLocation					= CREATE_AT_LOCATION
		AttributeModifierWeatherBased	= Yes
		WeatherDuration					= SPELL_DARKNESS_DURATION
		ChangeWeather					= CLOUDY
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic		= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	

	Behavior = OCLSpecialPower ModuleTag_SummonRohan
		SpecialPowerTemplate = SpellBookRohanAllies
		OCL                  = OCL_SpawnRohanRohirrimEgg
       	TriggerFX			 = FX_RohirimSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_RohanAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonLoneScout
		SpecialPowerTemplate = SpellBookLoneScout
		OCL                  = OCL_SpawnRohanLoneScoutEgg
       	TriggerFX			 = FX_GenericGoodSummon
		CreateLocation       = CREATE_AT_LOCATION
		;UpgradeName			 = Upgrade_RohanAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonEverholtBoar
		SpecialPowerTemplate = SpellBookEverholtBoar
		OCL                  = OCL_SpawnEverholtBoarEgg
       	TriggerFX			 = FX_EverholtBoarSummon
		CreateLocation       = CREATE_AT_LOCATION
		;UpgradeName			 = Upgrade_RohanAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_SummonStormcrow
		SpecialPowerTemplate = SpellBookStormcrow
		OCL                  = OCL_SpawnStormCrowEgg
       	TriggerFX			 = FX_GenericGoodSummon
		CreateLocation       = CREATE_AT_LOCATION
		;UpgradeName			 = Upgrade_RohanAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_SummonWhiteStag
		SpecialPowerTemplate = SpellBookWhiteStag
		OCL                  = OCL_SpawnWhiteStagEgg
       	TriggerFX			 = FX_WhiteStagSummon
		CreateLocation       = CREATE_AT_LOCATION
		;UpgradeName			 = Upgrade_RohanAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_SummonDunedain
		SpecialPowerTemplate = SpellBookDunedainAllies
		OCL                  = OCL_SpawnDunedainRangersEgg
       	TriggerFX			 = FX_DunedainSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_DunedainAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonDenethor
		SpecialPowerTemplate = SpellBookSpawnDenethor
		OCL                  = OCL_SpawnDenthorEgg
       	TriggerFX			 = FX_GenericGoodSummon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonTrebuchet
		SpecialPowerTemplate = SpellBookSpawnTrebuchet
		OCL                  = OCL_SpawnTrebuchetEgg
       	TriggerFX			 = FX_GenericGoodSummon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = SpecialPowerModule ModuleTag_SwordAllegiance
		SpecialPowerTemplate		= SpellBookSwornAllegiance
		AttributeModifier			= SpellBookSwornAllegianceModifier
		AttributeModifierRange		= 100
		AttributeModifierAffects	= NONE +GondorBarracks +GondorArcherRange
		TriggerFX					= FX_SwornAllegianceBarbs
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_SummonCirionOath
		SpecialPowerTemplate = SpellBookCirionOath
		OCL                  = OCL_SpawnOathCirionEgg
       	TriggerFX			 = FX_GenericGoodSummon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_SummonLossarnach
		SpecialPowerTemplate = SpellBookLossarnachAllies
		OCL                  = OCL_SpawnLossarnachEgg
       	TriggerFX			 = FX_GenericGoodSummon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonDolAmroth
		SpecialPowerTemplate = SpellBookDolAmrothAllies
		OCL                  = OCL_SpawnDolAmrothEgg
		TriggerFX			 = FX_DolAmrothAlliesSummon
		UpgradeName			 = Upgrade_SonsOfElrond
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonEnts
		SpecialPowerTemplate = SpellBookEntAllies
		OCL                  = OCL_SpawnEnts
       	TriggerFX			 = FX_SummonEntAllies
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_EntAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonLastMarch
		SpecialPowerTemplate = SpellBookLastMarch
		OCL                  = OCL_SpawnLastMarchEgg
       	TriggerFX			 = FX_SummonEntAllies
		CreateLocation       = CREATE_AT_LOCATION
		;UpgradeName			 = Upgrade_EntAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_SummonEagles
		SpecialPowerTemplate = SpellBookEagleAllies
		OCL                  = OCL_SpawnEagles
		CreateLocation       = CREATE_ABOVE_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_CampaignSummonEagles
		SpecialPowerTemplate = SpellBookCampaignEagleAllies
		OCL                  = OCL_CampaignSpawnEagles
		CreateLocation       = CREATE_ABOVE_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End		
	
	Behavior = OCLSpecialPower ModuleTag_SummonEaglesGondor
		SpecialPowerTemplate = SpellBookEagleAlliesGondor
		OCL                  = OCL_SpawnEaglesGondor
		CreateLocation       = CREATE_ABOVE_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower	ModuleTag_SummonTornado
		SpecialPowerTemplate	= SpellBookCampaignTornado
		OCL						= OCL_CampaignSpellBookTornado
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_SummonElessar
		SpecialPowerTemplate = SpellBookSpawnElessar
		OCL                  = OCL_SpawnElessarEgg
       	TriggerFX			 = FX_GenericGoodSummon
		CreateLocation       = CREATE_AT_LOCATION
		;UpgradeName			 = Upgrade_DunedainAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_Undermine
		SpecialPowerTemplate = SpellBookUndermine
		OCL                  = OCL_SpellBookUndermine
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_UndermineErebor
		SpecialPowerTemplate = SpellBookUndermineErebor
		OCL                  = OCL_SpellBookUndermine
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
		Behavior = OCLSpecialPower ModuleTag_ElvesAwokeThemMirkwood
		SpecialPowerTemplate = SpellBookSummonTreeMirkwood
		OCL                  = OCL_SpellBookTheElvesAwokeThem
		TriggerFX			 = FX_ElvesAwokeThem
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_TwirlyWhirly
		SpecialPowerTemplate = SpellBookTwirlyWhirly
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_Earthquake
		SpecialPowerTemplate = SpellBookEarthquake
		OCL                  = OCL_SpellBookEarthquake
        ;TriggerFX			 = FX_ElvenAlliesSummon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_CastDown
		SpecialPowerTemplate = SpellBookCastDown
		OCL                  = OCL_SpellBookCastDown ;OCL_SpellBookEarthquake
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_CampaignFlood
		SpecialPowerTemplate = SpellBookCampaignFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	

	Behavior = OCLSpecialPower ModuleTag_SendintheGoats
		SpecialPowerTemplate = SpellBookSendintheGoats
		OCL                  = OCL_SpellBookGoatsEgg
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_CampaignSunflare
		SpecialPowerTemplate 			= SpellBookCampaignSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_Citadel
		SpecialPowerTemplate = SpellBookCitadel
		OCL                  = OCL_SpellBookCitadel
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = OCLSpecialPower ModuleTag_ThorTreasure
		SpecialPowerTemplate = SpellBookThorsHoard
		OCL                  = OCL_SummonedThrorHoard
		TriggerFX			 = FX_StartThrorHoard
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_CampaignCache
		SpecialPowerTemplate = SpellBookCampaignCache
		OCL                  = OCL_CampaignCache
		TriggerFX			 = FX_StartThrorHoard
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	
	Behavior = BuildableHeroListUpgrade BitsUpgrade
		TriggeredBy = Upgrade_RingHero
	End

;    Behavior = OCLSpecialPower		ModuleTag_BarrowCorrupt
;		SpecialPowerTemplate		= SpecialAbilityBarrowCorruptFXStarter
;		TriggerFX					= FX_BarrowCorruption
;		OCL							= OCL_SpecialPowerBarrowCorrupt
;		CreateLocation				= CREATE_AT_LOCATION
;		UpdateModuleStartsAttack	= No
;		AvailableAtStart			= Yes
;		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
;		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
;	End

	Behavior = OCLSpecialPower ModuleTag_FarsightRivendell
		SpecialPowerTemplate = SpellBookFarsightRivendell
		OCL                  = OCL_SpecialPowerFarSeeing
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_FarsightMirkwood
		SpecialPowerTemplate = SpellBookFarsightMirkwood
		OCL                  = OCL_SpecialPowerFarSeeingMirkwood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	

	Behavior = SpecialPowerModule ModuleTag_RallyingCallRivendell
		SpecialPowerTemplate		= SpellBookRallyingCallRivendell
		AttributeModifier			= SpellBookRallyingCallModifier
		AttributeModifierRange		= 100
		AttributeModifierAffects	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER ;;,;; ANY +HORDE +INFANTRY -HERO -MordorBlackRiderHorde -MordorBlackRider -GondorKnightsofDol -GondorKnightsofDolHorde -IsengardFanatic -IsengardBerserkerHorde  -DwarvenZerker -DwarvenZerkerHorde -NoldorWarrior -NoldorWarriorHorde -WildBabyDrakeHorde -WildBabyDrake ;;.;; Added rest of MHH
		TriggerFX					= FX_SpellRivendellRallyingCall
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower ModuleTag_WestfoldHorn
		SpecialPowerTemplate 		= SpellBookWestfoldHorn
		AttributeModifier			= SpellBookRallyingCallModifier
		AttributeModifierRange		= 100
		AttributeModifierAffects	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
		TriggerFX					= FX_SpellRohanWestfoldHorn
		UpgradeName			 		= Upgrade_Evilboyos
		CreateLocation       		= CREATE_AT_LOCATION
		AvailableAtStart	 		= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = PlayerUpgradeSpecialPower	ModuleTag_BountifulHarvest	;;,;; added for 2.02e
		SpecialPowerTemplate		= SpellBookBountifulHarvest
		UpgradeName 			= Upgrade_GrantDwarvenRiches
		UpdateModuleStartsAttack	= No
		AffectAllies			= No
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	

	Behavior = PlayerHealSpecialPower ModuleTag_HealRivendell
		SpecialPowerTemplate  = SpellBookHealRivendell
		HealAffects			  = INFANTRY CAVALRY DOZER ;;,;; Removed SHIP ; RotWK originally had these as well MONSTER MACHINE
		HealAmount			  = 0.5 ;;,;; 0.6 ;1.0	; 0.5 = 50% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellRivendellHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_RivendellSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = OCLSpecialPower		ModuleTag_OldKingdom
		SpecialPowerTemplate		= SpellBookOldKingdom
		TriggerFX					= FX_NumenorRenmantsSummonFX
		OCL							= OCL_SpellbookRivendellRemnantsSeed
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SummonHallofFire
		SpecialPowerTemplate = SpellBookHallOfFire
		OCL                  = OCL_SpawnHallOfFireEgg
		;TriggerFX			 = FX_ElvenAlliesSummon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

	Behavior = PlayerUpgradeSpecialPower	SpellBookSonsofElrond_ModuleTag
		SpecialPowerTemplate		= SpellBookSonsOfElrond
		UpgradeName 				= Upgrade_SonsOfElrond ;Upgrade_ArmorofOld
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower	ModuleTag_OCLBreathOfManwe
		SpecialPowerTemplate	= SpellBookBreathOfManwe
		OCL						= OCL_BreezeofManwe
		CreateLocation			= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_GandalfRivendell
		SpecialPowerTemplate = SpellBookGandalfSummon
		OCL                  = OCL_SpawnRivendellGandalfEgg
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

 	Behavior = OCLSpecialPower ModuleTag_RivendellRain ;;,;; new 2.02e Freezing Rain
		SpecialPowerTemplate		= SpellBookRivendellRain
		OCL				= OCL_UlmoRainWeatherChanger ; OCL_FreezingRainCaster
		CreateLocation			= CREATE_AT_LOCATION
		AttributeModifierWeatherBased	= Yes
		WeatherDuration			= SPELL_FREEZINGRAIN_DURATION
		ChangeWeather			= RAINY
		AvailableAtStart		= No
;		BurnRateModifier		= -100 ; removing these two lines...
;		BurnDecayModifier		= 20 ; ...because they're not allowed in an OCLSpecialPower =(
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = PlayerUpgradeSpecialPower	SpellBookRelics_ModuleTag
		SpecialPowerTemplate		= SpellBookRelics
		UpgradeName 				= Upgrade_ArmorofOld
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_ManyMeetings
		SpecialPowerTemplate = SpellBookManyMeetings
		OCL                  = OCL_SpawnManyMeetings
       	TriggerFX			 = FX_ManyMeetingsSummon
		CreateLocation       = CREATE_AT_LOCATION
		;UpgradeName			 = Upgrade_ElvenAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_SpellBookBruinenFlood
		SpecialPowerTemplate = SpellBookBruinenFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	Behavior = OCLSpecialPower ModuleTag_TomBombadilRivendell
		SpecialPowerTemplate = SpellBookRivendellTomBombadil
		OCL                  = OCL_SpawnTomBombadilEgg ;OCL_SpawnRivendellTomBombadilEgg
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	
	;///////////////////////////////////////////
	;// AI Heuristics for SkirmishAI
	;///////////////////////////////////////////

	Behavior = AISpecialPowerUpdate SpellBookFarsightAI	;;.;; Added for 2.02 - was previously in the FoD Spell Book
		CommandButtonName = Command_SpellBookFarsight
		SpecialPowerAIType = AI_SPELLBOOK_SHROUD_REVEAL
		SpecialPowerRadius = 100
	End

	Behavior = AISpecialPowerUpdate SpellBookFarsightRivendellAI	;;.;; Added for 2.02 - was previously in the FoD Spell Book
		CommandButtonName = Command_SpellBookFarsightRivendell
		SpecialPowerAIType = AI_SPELLBOOK_SHROUD_REVEAL
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookHealAI
		CommandButtonName = Command_SpellBookHeal
		SpecialPowerAIType = AI_SPELLBOOK_HEAL
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookHealRivendellAI
		CommandButtonName = Command_SpellBookHealRivendell
		SpecialPowerAIType = AI_SPELLBOOK_HEAL
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookEnshroudingMistAI
		CommandButtonName = Command_SpellBookEnshroudingMist
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ; previous type does nothing? ;;,;; AI_SPELLBOOK_ENSHROUDINGMIST
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 250 ;;,;; Added for 3.0.1
	End

	Behavior = AISpecialPowerUpdate SpellBookElvenWoodAI
		CommandButtonName = Command_SpellBookElvenWood ;Command_SpellBookLorienElvenWood Command_SpellBookElvenWoodAdamant
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; AI_SPELLBOOK_BUFFTERRAIN ;;,;; Changed for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	End
	
	Behavior = AISpecialPowerUpdate SpellBookAdamantAI
		CommandButtonName = Command_SpellBookElvenWoodAdamant
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; AI_SPELLBOOK_BUFFTERRAIN ;;,;; Changed for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	End
	
	Behavior = AISpecialPowerUpdate SpellBookIthilienGardenAI
		CommandButtonName = Command_SpellBookIthilienGarden
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; AI_SPELLBOOK_BUFFTERRAIN ;;,;; Changed for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	End
	
	Behavior = AISpecialPowerUpdate SpellBookOldKingdomAI
		CommandButtonName = Command_SpellBookOldKingdom
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; AI_SPELLBOOK_BUFFTERRAIN ;;,;; Changed for 2.4
		SpecialPowerRadius = 500 ;;,;; 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	End

	Behavior = AISpecialPowerUpdate SpellBookLorienElvenWoodAI
		CommandButtonName = Command_SpellBookLorienElvenWood
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; AI_SPELLBOOK_BUFFTERRAIN ;;,;; Changed for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	End

	Behavior = AISpecialPowerUpdate SpellBookDraftAI
		CommandButtonName = Command_SpellBookDraft
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; AI_SPELLBOOK_BUFFTERRAIN ;;,;; Changed for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	End
	
	Behavior = AISpecialPowerUpdate SpellBookRebuildAI
		CommandButtonName = Command_SpellBookRebuild
		SpecialPowerAIType = AI_SPELLBOOK_REBUILD
		SpecialPowerRadius = 100
	End	
	
	Behavior = AISpecialPowerUpdate SpellBookGondorHealAI
		CommandButtonName = Command_SpellBookGondorHeal
		CommandButtonName = AI_SPELLBOOK_HEAL
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookRohanRebuildAI
		CommandButtonName = Command_SpellBookRohanRebuild
		SpecialPowerAIType = AI_SPELLBOOK_REBUILD
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookSwornAllegianceAI
		CommandButtonName = Command_SpellBookSwornAllegiance
		SpecialPowerAIType = AI_SPELLBOOK_REBUILD
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookRebuildAIDwarves
		CommandButtonName = Command_SpellBookRebuildDwarves
		SpecialPowerAIType = AI_SPELLBOOK_REBUILD
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookCrebainAI
		CommandButtonName = Command_SpellBookRavens
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
	End

	Behavior = AISpecialPowerUpdate SpellBookRallyingCallAIDwarves
		CommandButtonName = Command_SpellBookHornofErebor
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End
	
;,; Added in v5.1
	Behavior = AISpecialPowerUpdate SpellBookDwarvenRichesAI
	    CommandButtonName = Command_SpellBookDeepDelving ;Command_SpellBookDwarvenRiches
	    SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
	End
	
	Behavior = AISpecialPowerUpdate SpellBookSonsofElrondAI
	    CommandButtonName = Command_SpellBookSonsOfElrond ;Command_SpellBookDwarvenRiches
	    SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
	End
	
	Behavior = AISpecialPowerUpdate SpellBookBountifulHarvestAI
	    CommandButtonName = Command_SpellBookBountifulHarvest ;Command_SpellBookDwarvenRiches
	    SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
	End
	
	Behavior = AISpecialPowerUpdate SpellCalltheHordeAI
		CommandButtonName = Command_SpellBookMustertheDwarves ;Command_SpellBookMustertheDwarves
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE ;;,;; AI_SPELLBOOK_CALLTHEHORDE doesn't work
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellCalltheRohirrimAI
		CommandButtonName = Command_SpellBookMusterRohirrim ;Command_SpellBookMustertheDwarves
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE ;;,;; AI_SPELLBOOK_CALLTHEHORDE doesn't work
		SpecialPowerRadius = 100
	End

	Behavior = AISpecialPowerUpdate SpellDwarvesFullyArmedandFilthyAI
		CommandButtonName = Command_SpellBookDwarvesFullyArmedandFilthy
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End	

	Behavior = AISpecialPowerUpdate SpellBookWestfoldHornAI
		CommandButtonName = Command_SpellBookWestfoldHorn
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End	

	Behavior = AISpecialPowerUpdate SpellBookPukelStatueAI
		CommandButtonName = Command_SpellBookPukelStatue
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End	
	
	Behavior = AISpecialPowerUpdate SpellGoatsAI
		CommandButtonName = Command_SpellGoats
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;;,;; Added for 2.5
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;1500 ;;,;; 1000	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate BreathOfManweAI
		CommandButtonName = Command_SpecialPowerBreathOfManwe
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;;,;; Added for 2.5
		SpecialPowerRadius = 50 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;1500 ;;,;; 1000	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookUndermineAI
		CommandButtonName = Command_SpellBookUndermineErebor
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ; use on enemy hordes for meta impact ;;,;; AI_SPELLBOOK_STRUCTURE_BREAKER
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;;,;; Added for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		;;,;; RandomizeTargetLocation = Yes
			SpecialPowerRange = 750 ;;,;; 500 ;;,;; 250 ;;,;; added	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End

	Behavior = AISpecialPowerUpdate SpellBookDurinsDayAI
		CommandButtonName = Command_SpellBookDurinsDay ;Command_SpellBookLorienCloudBreak
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE ;;,;; weather powers must be set to always fire, the AI will not wait properly
		SpecialPowerRadius = 100
	End	

	Behavior = AISpecialPowerUpdate SpellBookRivendellRainAI
		CommandButtonName = Command_SpellBookRivendellRain ;Command_SpellBookLorienCloudBreak
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE ;;,;; weather powers must be set to always fire, the AI will not wait properly
		SpecialPowerRadius = 100
	End	
	
	Behavior = AISpecialPowerUpdate SpellBookRivendellManyMeetingsAI
		CommandButtonName = Command_SpellBookManyMeetings
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
	End

	Behavior = AISpecialPowerUpdate SpellBookRohanCloudBreakAI
		CommandButtonName = Command_SpellBookRohanCloudBreak ;Command_SpellBookLorienCloudBreak
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE ;;,;; weather powers must be set to always fire, the AI will not wait properly
		SpecialPowerRadius = 100
	End	

	Behavior = AISpecialPowerUpdate SpellBookEverholtBoarAI
		CommandButtonName = Command_SpellBookEverholtBoar ;Command_SpellBookLorienCloudBreak
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;,; AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL ;;,;; Added for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;,; AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ; wait for an opportune moment to fire? ;;,;; AI_SPELLBOOK_ALWAYS_FIRE
		SpecialPowerRadius = 100
	End	
	
	Behavior = AISpecialPowerUpdate SpellKhazadAlliesAI
		CommandButtonName = Command_SpellBookKhazadAllies
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; Added for 3.0.1
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	End	
	; Behavior = AISpecialPowerUpdate SpellManyAlliesAI
		; CommandButtonName = SBRivendellRelicsOfThePast
		; SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		; SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; Added for 3.0.1
		; SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		; SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	; End

	Behavior = AISpecialPowerUpdate SpellThrorHoardAI
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;,; AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL ;;,;; Added for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;,; AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ; wait for an opportune moment to fire? ;;,;; AI_SPELLBOOK_ALWAYS_FIRE
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookRallyingCallAI
		CommandButtonName = Command_SpellBookRallyingCall
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookRallyingCallRivendellAI
		CommandButtonName = Command_SpellBookRallyingCallRivendell
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate GreyPilgrimAI
		CommandButtonName = Command_SpellBookGreyPilgrim
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End

	Behavior = AISpecialPowerUpdate SpellBookRallyingCallAIGondor
		CommandButtonName = Command_SpellBookRallyingCallGondor
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookRallyingCallAILorien
		CommandButtonName = Command_SpellBookRallyingCallElves
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookLorienTrapAI
		CommandButtonName = Command_SpellBookLorienTrap
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ; AI_SPELLBOOK_TREE_KILLER Was this but battle buffs are better for AI Anyways.
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookArrowVolleyGoodAI
		CommandButtonName = Command_SpellBookArrowVolleyGood
		;SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;;,;; Added for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 900 ;;,;; 500 ;;,;; 250	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookArrowVolleyLorienAI
		CommandButtonName = Command_SpellBookArrowVolleyLorien
		;SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;;,;; Added for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 900 ;;,;; 500 ;;,;; 250	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookLoneTowerAI
		CommandButtonName = Command_SpellBookLoneTower
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
		SpellMakesAStructure = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookLoneTowerGondorAI
		CommandButtonName = Command_SpellBookLoneTowerGondor
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
		SpellMakesAStructure = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookLoneTowerDwarfAI
		CommandButtonName = Command_SpellBookLoneTowerDwarf
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
		SpellMakesAStructure = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookTomBombadilAI
		CommandButtonName = Command_SpellBookTomBombadil ;Command_SpellBookRadagast
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookTomBombadilRivendellAI
		CommandButtonName = Command_SpellBookTomBombadilRivendell ;Command_SpellBookRadagast
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookRadagastAI
		CommandButtonName = Command_SpellBookRadagast
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookCirionOathAI
		CommandButtonName = Command_SpellBookCirionOath
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookHobbitAlliesAI
		CommandButtonName = Command_SpellBookHobbitAllies
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS ;;,;; AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;;,;; Changed for 3.0.0
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; Added for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;,; Added in v5.1
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookMenOfDaleAlliesAI
		CommandButtonName = Command_SpellBookMenOfDaleAllies ;Command_SpellBookSilvanAllies
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ; summon ally archers in own army, not enemy's ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookSilvanAlliesAI
		CommandButtonName = Command_SpellBookSilvanAllies
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ; summon ally archers in own army, not enemy's ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End

	Behavior = AISpecialPowerUpdate SpellBookLossAlliesAI
		CommandButtonName = Command_SpellBookLossarnachAllies
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ; summon ally archers in own army, not enemy's ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End

	Behavior = AISpecialPowerUpdate SpellBookDenethorAlliesAI
		CommandButtonName = Command_SpellBookSpawnDenethor
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ; summon ally archers in own army, not enemy's ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookTrebuchetAI
		CommandButtonName = Command_SpellBookSpawnTrebuchet
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ; summon ally archers in own army, not enemy's ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End	
	
	Behavior = AISpecialPowerUpdate SpellBookLoneScoutAI
		CommandButtonName = Command_SpellBookLoneScout
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ; summon ally archers in own army, not enemy's ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End	

	Behavior = AISpecialPowerUpdate SpellBookRohanAlliesAI
		CommandButtonName = Command_SpellBookRohanAllies
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; Added for 2.4
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookDunedainAlliesAI
		CommandButtonName = Command_SpellBookDunedainAllies
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ; summon ally archers in own army, not enemy's ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookEagleAlliesAI
		CommandButtonName = Command_SpellBookEagleAllies ;Command_SpellBookEagleAlliesLorien
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; Added for 3.0.1
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	End
	
	Behavior = AISpecialPowerUpdate SpellBookEagleAlliesLorienAI
		CommandButtonName = Command_SpellBookEagleAlliesLorien
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; Added for 3.0.1
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	End

	Behavior = AISpecialPowerUpdate SpellBookEagleAlliesGondorAI
		CommandButtonName = Command_SpellBookEagleAlliesGondor
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; Added for 3.0.1
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	End
	
	Behavior = AISpecialPowerUpdate SpellBookElessarAI
		CommandButtonName = Command_SpellBookSpawnElessar
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ;,; AI_SPELLBOOK_ASSIST_BATTLE_BUFF ;;,;; Added for 3.0.1
		SpecialPowerRadius = 150 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 500 ;;,;; Added for 3.0.1
	End
	
	Behavior = AISpecialPowerUpdate SpellBookBombardAI
		CommandButtonName = Command_SpellBookBombard
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;,; AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL ;;,;; Added for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;,; AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 1500 ;;,;; 1000 ;;,;; 600	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookArmyoftheDeadAI
		CommandButtonName = Command_SpellBookArmyoftheDead 
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 1500 ;;,;; 1000	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
						//this power can be used on ;;,;; Changed for 3.0.0
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookEnshroudingMistLorienAI
		CommandButtonName = Command_SpellBookEnshroudingMistLorien
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 1500 ;;,;; 1000	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
						//this power can be used on ;;,;; Changed for 3.0.0
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookStormcrowAI
		CommandButtonName = Command_SpellBookStormcrow
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 1500 ;;,;; 1000	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
						//this power can be used on ;;,;; Changed for 3.0.0
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookFloodAI
		CommandButtonName = Command_SpellBookFlood
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;;,;; Added for 2.5
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 1500 ;;,;; 1000	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookFloodRivendellAI
		CommandButtonName = Command_SpellBookBruinenFlood
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;;,;; Added for 2.5
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 1500 ;;,;; 1000	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookSunflareAI
		CommandButtonName = Command_SpellBookSunflare
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;,; AI_SPELLBOOK_ARMY_BREAKER ; tbh now it has fire it's great vs. structures too ;this hardly even damages structures ;;,;; AI_SPELLBOOK_STRUCTURE_BREAKER
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;,; AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 1500 ;;,;; 1000 ;;,;; added	//NOTE!! Army Breaker uses this value as the minimum enemy threat that
					//this power can be used on ;;,;; Changed for 3.0.0
	End
	
	Behavior = AISpecialPowerUpdate SpellBookCitadel
		CommandButtonName = Command_SpellBookCitadel
		SpecialPowerAIType = AI_SPELLBOOK_CITADEL
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
		SpellMakesAStructure = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookHallOfFireAI
		CommandButtonName = Command_SpellBookHallOfFire
		;SpecialPowerAIType = AI_SPELLBOOK_CITADEL
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
		SpellMakesAStructure = Yes
	End

	Behavior = AISpecialPowerUpdate SpellBookDolAmrothCitadel
		CommandButtonName = Command_SpellBookDolAmrothAllies
		SpecialPowerAIType = AI_SPELLBOOK_CITADEL
		SpecialPowerRadius = 800 ; was 100, larger radius may prevent floating summons
		RandomizeTargetLocation = Yes
		SpellMakesAStructure = Yes
	End

	Behavior = AISpecialPowerUpdate SpellBookEarthquakeAI
		CommandButtonName = Command_SpellBookEarthquake ;Command_SpellBookCastDown
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
	End
	
	Behavior = AISpecialPowerUpdate SpellBookCastDownAI
		CommandButtonName = Command_SpellBookCastDown
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL
		SpecialPowerRadius = 250 ;;,;; 100 ;;,;; Changed for 3.0.1
	End
	
	Behavior = AISpecialPowerUpdate SpellBookEntAlliesAI
		CommandButtonName = Command_SpellBookEntAllies
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerRadius = 200 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 250 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookEntAlliesRohanAI
		CommandButtonName = Command_SpellBookLastMarch
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER ;;,;; Added for 2.4
		SpecialPowerRadius = 200 ;;,;; 100 ;;,;; Changed for 3.0.1
		SpecialPowerRange = 250 ;;,;; Added for 3.0.1
		RandomizeTargetLocation = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookCloudBreakAI
		CommandButtonName = Command_SpellBookCloudBreak ;Command_SpellBookLorienCloudBreak
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF does not work for global powers
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookCloudBreakGondorAI
		CommandButtonName = Command_SpellBookWesternWinds ;Command_SpellBookLorienCloudBreak
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF does not work for global powers
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookCloudBreakLorienAI
		CommandButtonName = Command_SpellBookLorienCloudBreak
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE ;;,;; AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF does not work for global powers
		SpecialPowerRadius = 100
	End
	
;===========================================================================================
;---------------------------Mirkwood Spellbook AI-------------------------------------------
;===========================================================================================

	Behavior = AISpecialPowerUpdate SpellBookRallyingCallMirkwood
		CommandButtonName = Command_SpellBookRallyingCallMirkwood
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End 
	
	Behavior = AISpecialPowerUpdate SpellBookFarsightMirkwood
		CommandButtonName = Command_SpellBookFarsightMirkwood
		;SpecialPowerAIType = AI_SPELLBOOK_SHROUD_REVEAL
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF ; Normal shroud reveal was causing units to bug inside fortress, also shroud reveal is useless to the AI 
		SpecialPowerRadius = 100
	End	
	
	Behavior = AISpecialPowerUpdate SpellBookTheElvesAwokeThemMirkwood
		CommandButtonName = Command_SpellBookTheElvesAwokeThemMirkwood
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookElvenkingRoad
		CommandButtonName = Command_SpellBookElvenkingRoad
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerAIType = AI_SPELLBOOK_CITADEL
		SpecialPowerRadius = 200
		RandomizeTargetLocation = Yes
		SpellMakesAStructure = Yes
	End
	
	Behavior = AISpecialPowerUpdate SpellBookElvenkingPatience
		CommandButtonName = Command_SpellBookElvenkingPatience
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookElvenkingFeast
		CommandButtonName = Command_SpellBookElvenkingPatience
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
		SpellMakesAStructure = Yes ; disable if this causes the AI to summon the tree in weird places 
	End
	
	Behavior = AISpecialPowerUpdate SpellBookElvenkingDecree
		CommandButtonName = Command_SpellBookElvenkingDecree
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookEotheodAllies
		CommandButtonName = Command_SpellBookEotheodAllies
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookMirkwoodDarkness
		CommandButtonName = Command_SpellBookMirkwoodDarkness
		SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
		SpecialPowerRadius = 100
	End
	
	Behavior = AISpecialPowerUpdate SpellBookMirkwoodArrowVolley
		CommandButtonName = Command_SpellBookMikkwoodArrowVolley
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
	End	
	
	Behavior = AISpecialPowerUpdate SpellBookHuntOfOrome
		CommandButtonName = Command_SpellBookHuntOfOrome
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 800
	End
	
	Behavior = AISpecialPowerUpdate SpellBookWhiteStag
		CommandButtonName = Command_SpellBookWhiteStag
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
	End	

;;,;; Now is a passive ability ;;,;; Removed for 2.4	
;;,;;	Behavior = AISpecialPowerUpdate SpellBookDwarvenRichesAI
;;,;;	CommandButtonName = Command_SpellBookDwarvenRiches
;;,;;	SpecialPowerAIType = AI_SPELLBOOK_BUFFECONOMYBUILDING
;;,;;	End

	Behavior = CommandPointsUpgrade CommandPoints_Upgrade
		TriggeredBy		= Upgrade_MarketplaceUpgradeGrandHarvest
		CommandPoints	= 100
		RequiredObject	= NONE +GondorMarketPlace
	End

	CommandSet          = GoodSpellBookCommandSet
	RadarPriority       = NOT_ON_RADAR
	KindOf              = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject MenSpellBook GoodSpellBook
	CommandSet          = MenSpellBookCommandSet
End

ChildObject MenSpellBook_WOTR GoodSpellBook
	CommandSet          = MenSpellBookCommandSet_WOTR
End

ChildObject RohanSpellBook GoodSpellBook
	CommandSet          = RohanSpellBookCommandSet
End

ChildObject RohanSpellBook_WOTR GoodSpellBook
	CommandSet          = RohanSpellBookCommandSet_WOTR
End

ChildObject ElvesSpellBook GoodSpellBook
	CommandSet          = ElvesSpellBookCommandSet
End

ChildObject ElvesSpellBook_WOTR GoodSpellBook
	CommandSet          = ElvesSpellBookCommandSet_WOTR
End

ChildObject MirkwoodSpellBook GoodSpellBook
	CommandSet          = MirkwoodSpellBookCommandSet
End

ChildObject MirkwoodSpellBook_WOTR GoodSpellBook
	CommandSet          = MirkwoodSpellBookCommandSet_WOTR
End

ChildObject DwarvesSpellBook GoodSpellBook
	CommandSet          = DwarvesSpellBookCommandSet
End

ChildObject DwarvesSpellBook_WOTR GoodSpellBook
	CommandSet          = DwarvesSpellBookCommandSet_WOTR
End

ChildObject ArnorSpellBook GoodSpellBook
	CommandSet          = ArnorSpellBookCommandSet
End

ChildObject ArnorSpellBook_WOTR GoodSpellBook
	CommandSet          = ArnorSpellBookCommandSet
End


;------------------------------------------------------------------------------

Object RallyPointMarker
	; *** DESIGN parameters ***
	EditorSorting = SYSTEM
	KindOf = DRAWABLE_ONLY

	; *** ART Parameters ***
	Draw = W3DScriptedModelDraw ModuleTag_01
		DefaultModelConditionState
			Model = RallyFlag_SKN
		End
		IdleAnimationState
			Animation = IDLE
				AnimationName     = RallyFlag_SKL.RallyFlag_WAVA
		        AnimationMode     = LOOP
			End
		End    
	End
End

;------------------------------------------------------------------------------
Object MoveHint

  ; *** ART Parameters ***

  ; *** DESIGN parameters ***
  EditorSorting = SYSTEM
  KindOf = DRAWABLE_ONLY

  ; *** ENGINEERING parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model = SCMoveHint
    End
  End

End

;------------------------------------------------------------------------------
Object AttackHint

  ; *** ART Parameters ***

  ; *** DESIGN parameters ***
  EditorSorting = SYSTEM
  KindOf = DRAWABLE_ONLY

  ; *** ENGINEERING parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model = SCAttckHnt
    End
  End

End

;------------------------------------------------------------------------------
Object SelectIcon

  ; *** ART Parameters ***

  ; *** DESIGN parameters ***
  EditorSorting = SYSTEM
  KindOf = DRAWABLE_ONLY

  ; *** ENGINEERING parameters ***
  ;Scale = 0.5

  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model = SCSelect
    End
  End

End


;------------------------------------------------------------------------------
Object GenericDebris

  ; *** ART Parameters ***
  Draw                  = W3DDebrisDraw ModuleTag_01
    ;nothing
  End

  ; ***DESIGN parameters ***
  EditorSorting = SYSTEM

  ; *** AUDIO Parameters ***

  ; *** ENGINEERING Parameters ***
  KindOf                = UNATTACKABLE

  Behavior = PhysicsBehavior ModuleTag_03
    AllowBouncing           = Yes
    KillWhenRestingOnGround = Yes
  End

  Behavior = SlowDeathBehavior ModuleTag_04
    SinkDelay        = 1000
    SinkRate            = 1     ; in Dist/Sec
    DestructionDelay = 2000
  End

End

;------------------------------------------------------------------------------
Object GenericBridge ; object for the damage system.

  ; *** ART Parameters ***
  Draw                = W3DDefaultDraw ModuleTag_01
    ;nothing
  End; The bridge system actually draws it.

    ; ***DESIGN parameters ***
  EditorSorting       = SYSTEM ; not available in the editor.
  ArmorSet
    Conditions        = None
    Armor             = NoArmor
    DamageFX          = EmptyDamageFX
  End

  ; *** ENGINEERING Parameters ***  
  RadarPriority       = NOT_ON_RADAR
  KindOf              = STRUCTURE IMMOBILE BRIDGE
  Body                = ImmortalBody ModuleTag_02
    MaxHealth         = 1.0
  End

  Behavior                = BridgeBehavior ModuleTag_03
    LateralScaffoldSpeed  = 100.0
    VerticalScaffoldSpeed = 70.0
  End
  
  ; Note that structures with "RUBBLE" states should not use 
  ; DestroyDie; such buildings are never truly
  ; destroyed, even when reduced to zero health.
  Geometry            = BOX
  GeometryMajorRadius = 0.8
  GeometryMinorRadius = 0.8
  GeometryHeight      = 0.8
  GeometryIsSmall     = No
  Shadow              = NONE ; doesn't actually have a model...
End

;PRUNED
; -----------------------------------------------------------------------------
;Object WaveGuide
;  
;  ; *** ART Parameters ***
;  
;  ; *** DESIGN Parameters ***
;  EditorSorting       = SYSTEM;
;
;  ; *** AUDIO Parameters ***
;    
;  ; *** ENGINEERING Parameters ***
;  KindOf              = WAVEGUIDE
;  Body                = ImmortalBody ModuleTag_01
;    MaxHealth         = 1.0
;  End  
;  Behavior = AIUpdateInterface ModuleTag_02
;  End;
;
;  LocomotorSet
;    Locomotor = WaterWaveLocomotor
;    Condition = SET_NORMAL
;    Speed     = 120
;  End
;
;  Behavior            = PhysicsBehavior ModuleTag_03
;  End
;  Behavior = WaveGuideUpdate ModuleTag_04
;    WaveDelay                  = 750    ;(in milliseconds)delay till wave starts moving
;    YSize                      = 650.0  ;size in Y
;    LinearWaveSpacing          = 15.0   ;linear waves get pushed up at these intervals across
;    WaveBendMagnitude          = 500.0  ;shape of wave (larger # = more flat and 0 = straight line)
;    WaterVelocity              = 2.7    ;in dist per sec, velocity to "push up" the water 
;    PreferredHeight            = 37.3   ;water level we want to be after the wave
;    ShorelineEffectDistance     = 5.0   ;this far behind the wave we "hit" the shores
;    DamageRadius               = 25.0   ;damage things this far from us
;    DamageAmount               = 99999  ;do this much damage
;    ToppleForce                = 0.25   ;force strength we topple things with
;    RandomSplashSound          = WaveRandomSplash
;    RandomSplashSoundFrequency = 50     ;every so often a # from 1-100 is chosen, if above this number the sound will play
;    BridgeParticleAngleFudge   = -95.0  ;angle to offset the bridge particle angle
;    LoopingSound               = DamBreakWaveLoop
;  End 
;  Geometry            = SPHERE
;  GeometryMajorRadius = 1.0
;  GeometryIsSmall     = Yes
;  
;End



;------------------------------------------------------------------------------
; This object is used when the water wave hits a bridge ... the bridge is
; replaced with this art that has super special animations of the bridge
; getting "swept" downstream with the water
;------------------------------------------------------------------------------
Object WaterWaveBridge

  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model         = CMFldBrdg_A
    End
    AnimationState = NONE
      Animation = Falling
        AnimationName     = CMFldBrdg_A.CMFldBrdg_A
        AnimationMode = ONCE
      End
    End    
  End
  
  ; ***DESIGN parameters ***
  EditorSorting   = SYSTEM ; not available in the editor.

  ; *** ENGINEERING Parameters ***  
  KindOf              = IMMOBILE

  Geometry            = BOX
  GeometryMajorRadius = 0.8
  GeometryMinorRadius = 0.8
  GeometryHeight      = 0.8
  GeometryIsSmall     = Yes
  Shadow              = NONE
  
End

;------------------------------------------------------------------------------
Object CivilianVehicleTrainGuide

  ; ***DESIGN parameters ***
  DisplayName         = OBJECT:TrainGuide
  EditorSorting       = SYSTEM

  ; *** AUDIO Parameters ***

  ; *** ENGINEERING Parameters ***  
  
  Behavior                 = DestroyDie ModuleTag_01
    ;<NO DATA>
  End

End


;------------------------------------------------------------------------------
Object FireFieldSmall

  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model = NONE
      ParticleSysBone = None FireFieldSmallFire
      ParticleSysBone = None FireFieldSmallFlare
      ParticleSysBone = None FireFieldSmallEmbers
    End
  End

  ; ***DESIGN parameters ***
  EditorSorting = SYSTEM
  KindOf = IMMOBILE NO_COLLIDE IGNORE_FOR_VICTORY

  ; *** ENGINEERING Parameters ***  
  Body = InactiveBody ModuleTag_02
    ;nothing
  End
  Behavior = FireWeaponUpdate ModuleTag_03
		FireWeaponNugget
			WeaponName = SmallFireFieldWeapon
			FireDelay = 0
			OneShot = No
		End
  End

  Behavior = DeletionUpdate ModuleTag_04
    MinLifetime = 3000
    MaxLifetime = 3000
  End
  
  Geometry            = CYLINDER
  GeometryMajorRadius = 0.8
  GeometryMinorRadius = 0.8
  GeometryHeight      = 0.8
  GeometryIsSmall     = No
  
End

;------------------------------------------------------------------------------
Object GenericDamageField

  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model = NONE
    End
  End

  ; ***DESIGN parameters ***
  EditorSorting = SYSTEM
  KindOf = IMMOBILE NO_COLLIDE INERT IGNORE_FOR_VICTORY

  ; *** ENGINEERING Parameters ***  
  Body = InactiveBody ModuleTag_02
    ;nothing
  End
  Behavior = FireWeaponUpdate ModuleTag_03
		FireWeaponNugget
			WeaponName = SmallFireFieldWeapon
			FireDelay = 0
			OneShot = No
		End
  End

  Behavior = DeletionUpdate ModuleTag_04
    MinLifetime = 3000
    MaxLifetime = 3000
  End
  
  Geometry            = CYLINDER
  GeometryMajorRadius = 0.8
  GeometryMinorRadius = 0.8
  GeometryHeight      = 0.8
  GeometryIsSmall     = No
  
End

;------------------------------------------------------------------------------
Object GenericDamageWarning

  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model = NONE
    End
  End

  ; ***DESIGN parameters ***
  EditorSorting = SYSTEM
  KindOf = IMMOBILE NO_COLLIDE INERT IGNORE_FOR_VICTORY

  ; *** ENGINEERING Parameters ***  
  Body = InactiveBody ModuleTag_02
    ;nothing
  End
  
  Behavior = DelayedLuaEventUpdate ModuleTag_03
  End

  Behavior = DeletionUpdate ModuleTag_04
    MinLifetime = 3000
    MaxLifetime = 3000
  End
  
  Geometry            = CYLINDER
  GeometryMajorRadius = 0.8
  GeometryMinorRadius = 0.8
  GeometryHeight      = 0.8
  GeometryIsSmall     = No
  
End

; -----------------------------------------------------------------------------
Object ParticleFXTestObject ; Used to be blown up in a test map to fire an FXList 
  
  ; *** ART Parameters ***
  
  ; *** DESIGN Parameters ***
  EditorSorting = SYSTEM
  
  ; *** ENGINEERING Parameters ***
  KindOf              = SELECTABLE IMMOBILE IGNORE_FOR_VICTORY
  Draw                = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model           = SCMoveHint
    End
  End

  Body               = ActiveBody ModuleTag_02
    MaxHealth        = 1.0
  End

  Behavior = FXListDie ModuleTag_03
    DeathTypes = ALL
;    DeathFX = FX_ParticleTestFX
  End

  Behavior = SlowDeathBehavior ModuleTag_04
    DeathTypes = ALL
    SinkDelay = 0
    SinkRate = 0.40     ; in Dist/Sec
    DestructionDelay = 1800
    OCL = INITIAL SUPERWEAPON_PartTheHeavens
  End
  
  Geometry            = SPHERE
  GeometryMajorRadius = 0.8
  GeometryIsSmall     = Yes
  
End

; -----------------------------------------------------------------------------
Object FXParticleFXTestObject ; Used to be blown up in a test map to fire an FXList 
  
  ; *** ART Parameters ***
  
  ; *** DESIGN Parameters ***
  EditorSorting = SYSTEM
  
  ; *** ENGINEERING Parameters ***
  KindOf              = SELECTABLE IMMOBILE IGNORE_FOR_VICTORY
  Draw                = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model           = SCMoveHint
    End
  End

  Body               = ActiveBody ModuleTag_02
    MaxHealth        = 1.0
  End

  Behavior = FXListDie ModuleTag_03
    DeathTypes = ALL
    DeathFX = FX_FXParticleTestFX
  End
  
  Geometry            = SPHERE
  GeometryMajorRadius = 0.8
  GeometryIsSmall     = Yes
  
End

; -----------------------------------------------------------------------------
;Object RainOfFire
;  ; *** ART Parameters ***
;  Draw = W3DScriptedModelDraw ModuleTag_02
;    DefaultModelConditionState
;      Model = NONE
;      WeaponLaunchBone = PRIMARY NONE
;    End
;  End
;
;  ; ***DESIGN parameters ***
;  EditorSorting = SYSTEM
;
;  WeaponSet
;    Conditions = None
;    Weapon     = PRIMARY CINE_RainOfFireWeapon
;  End
;
;  ; *** ENGINEERING Parameters ***  
;  KindOf        = NO_COLLIDE NO_HEAL_ICON IGNORES_SELECT_ALL IGNORED_IN_GUI UNATTACKABLE ENVIRONMENT IGNORE_FOR_VICTORY
;
;  Behavior      = RainOfFireUpdate ModuleTag_01
;    StartRainTime      = 1000  ; Amount of time till rain starts
;    DarknessFadeTime   = 4000  ; Amount of time to get dark
;    RainEmitterHeight  = 300.0 ; Height of rain drops
;    DarknessLevel      = .5    ; How dark it will get during rain
;    JitterRadius       = 276.0 ; Radius of the effect
;    DPSMin             = 10.0  ; Minimum drops per second
;    DPSMax             = 15.0  ; Maximum drops per second
;    DPSRampupTime      = 3000  ; Rampup from zero intensity
;  End
;
;  Behavior      = DestroyEnvironmentUpdate ModuleTag_03
;    StartTime = 60000
;    DestructionTime = 2000
;  End
;End

; -----------------------------------------------------------------------------
Object PartTheHeavens
  ; *** ART Parameters ***

  ; ***DESIGN parameters ***
  EditorSorting = SYSTEM

  ; *** ENGINEERING Parameters ***  
  KindOf        = NO_COLLIDE NO_HEAL_ICON IGNORES_SELECT_ALL IGNORED_IN_GUI UNATTACKABLE IGNORE_FOR_VICTORY

  Behavior = DestroyEnvironmentUpdate ModuleTag_01
    StartTime       = 5000
    DestructionTime = 2000
  End

  Behavior = PartTheHeavensUpdate ModuleTag_02
    ;Texture = SCCGuard_USA
    Texture = SCCommandBar
    Color = R:255 G:255 B:255
    Radius = FCurve
      Key = T:0 V:0 O:0
      Key = T:20 V:100
    End
    Opacity = FCurve
      Key = T:0 V:0
      Key = T:100 V:.50
    End
    Angle = FCurve
      InPadding = HOLD
      OutPadding = CYCLE
      Key = T:0 V:0
      Key = T:100 V:360 I:0 O:0
      Key = T:200 V:0 I:0
    End
  End

  Behavior = DeletionUpdate ModuleTag_03
    MinLifetime = 10000
    MaxLifetime = 10000
  End
End

;------------------------------------------------------------------------------
;Gondor Lightening Ball
Object GBLiteBall

  ; *** ART Parameters ***

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model = GBLiteBall
      ;Lightning Ball particle elements ------------------
      ParticleSysBone = particleBone01 LighteningBallSmoke
    End
  End

  ; *** AUDIO Parameters ***

  ; ***DESIGN parameters ***
  DisplayName     = OBJECT:Lightning
  EditorSorting   = STRUCTURE

  ; *** ENGINEERING Parameters ***  
  KindOf          = SELECTABLE IMMOBILE IGNORE_FOR_VICTORY
  Shadow          = SHADOW_VOLUME
  Body            = ActiveBody ModuleTag_03
    MaxHealth       = 99999.0
  End

  Geometry = CYLINDER
  GeometryMajorRadius = 2.4
  GeometryMinorRadius = 2.4
  GeometryHeight = 4.8
  GeometryIsSmall = Yes
End

;------------------------------------------------------------------------------
;Gondor Fire Object
Object GBFireObject

  ; *** ART Parameters ***
;  Draw = W3DModelDraw ModuleTag_01
;    DefaultConditionState
;      Model = GBFireObject
;     
;  ;embers and smoke particle elements
;      ParticleSysBone = emberBone fireFlare
;      ParticleSysBone = emberBone FireSmoke
;      ParticleSysBone = emberBone campfireEmbers
;      ParticleSysBone = emberBone fireGlow
;    End
;  End

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model = GBFireObject
      ;embers and smoke particle elements-------
      ParticleSysBone = emberBone fireFlare
      ParticleSysBone = emberBone FireSmoke
      ParticleSysBone = emberBone campfireEmbers
      ParticleSysBone = emberBone fireGlow
    End
  End

  ; *** AUDIO Parameters ***
	SoundAmbient = Campfire1AmbientLoop

  ; ***DESIGN parameters ***
  DisplayName     = OBJECT:Fire
  EditorSorting   = STRUCTURE

  ; *** ENGINEERING Parameters ***  
  KindOf          = SELECTABLE IMMOBILE IGNORE_FOR_VICTORY
  Shadow          = SHADOW_VOLUME
  Body            = ActiveBody ModuleTag_03
    MaxHealth       = 99999.0
  End

  Geometry = CYLINDER
  GeometryMajorRadius = 2.4
  GeometryMinorRadius = 2.4
  GeometryHeight = 4.8
  GeometryIsSmall = Yes
End

;------------------------------------------------------------------------------
Object MapRevealPing

  ; ***DESIGN parameters ***
  VisionRange     = 240.0
  EditorSorting   = SYSTEM
  KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT INERT_SHROUD_REVEALER IGNORE_FOR_VICTORY

  ; *** ENGINEERING Parameters ***
  Body = ImmortalBody ModuleTag_01
    MaxHealth = 1    
  End

  Behavior = DynamicShroudClearingRangeUpdate ModuleTag_02
    FinalVision = 0.0 
    ShrinkDelay = 10000
    ShrinkTime = 5000
    GrowDelay = 0
    GrowTime = 1000
    GrowInterval = 10 ; Faster than most
    ChangeInterval = 80 ; Faster than most
    GridDecalTemplate
      Texture           = EXGrid
      Style             = SHADOW_ADDITIVE_DECAL
      OpacityMin        = 50%
      OpacityMax        = 100%
      OpacityThrobTime  = 500
      Color             = R:32 G:64 B:128 A:0 //dim blue, additive
    End
  End

  Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
    MinLifetime = 13000   ; InitialDelay + TransitionTime for Vision Update
    MaxLifetime = 13000   
  End

  Behavior = StealthDetectorUpdate ModuleTag_04
    DetectionRate = 500   ; how often to rescan for stealthed things in my sight (msec)
  End
End



Object CastleTemplateKeeperForMapINIs

	EditorSorting = SYSTEM

	Behavior = CastleBehavior ModuleTagCB
		CastleToUnpackForFaction  = Men   Camp_MenSW 
		CastleToUnpackForFaction  = Men   Camp_MenNW 
		CastleToUnpackForFaction  = Men   Camp_MenSE 
		CastleToUnpackForFaction  = Men   Camp_MenNE 
		CastleToUnpackForFaction  = Men   Camp_Men
		
		CastleToUnpackForFaction  = Elves    Camp_ElvesSW  
		CastleToUnpackForFaction  = Elves    Camp_ElvesNW  
		CastleToUnpackForFaction  = Elves    Camp_ElvesSE  
		CastleToUnpackForFaction  = Elves    Camp_ElvesNE  
		CastleToUnpackForFaction  = Elves    Camp_Elves
		
		CastleToUnpackForFaction  = Dwarves    Camp_DwarvesSW  
		CastleToUnpackForFaction  = Dwarves    Camp_DwarvesNW  
		CastleToUnpackForFaction  = Dwarves    Camp_DwarvesSE  
		CastleToUnpackForFaction  = Dwarves    Camp_DwarvesNE  
		CastleToUnpackForFaction  = Dwarves    Camp_Dwarves
		
		CastleToUnpackForFaction  = Mordor   Camp_MordorSW  
		CastleToUnpackForFaction  = Mordor   Camp_MordorNW  
		CastleToUnpackForFaction  = Mordor   Camp_MordorSE  
		CastleToUnpackForFaction  = Mordor   Camp_MordorNE  
		CastleToUnpackForFaction  = Mordor   Camp_Mordor  
		CastleToUnpackForFaction  = Mordor   Camp_HaradNE  ; added to make near harad work JGS
		CastleToUnpackForFaction  = Mordor   Camp_HaradNW  ; added to make near harad work JGS
		CastleToUnpackForFaction  = Mordor   Castle_HaradNE  ; added to make near harad work JGS

		CastleToUnpackForFaction  = Isengard Camp_IsengardSW 
		CastleToUnpackForFaction  = Isengard Camp_IsengardNW 
		CastleToUnpackForFaction  = Isengard Camp_IsengardSE 
		CastleToUnpackForFaction  = Isengard Camp_IsengardNE 
		CastleToUnpackForFaction  = Isengard Camp_Isengard 

		CastleToUnpackForFaction  = Wild    Camp_WildSW  
		CastleToUnpackForFaction  = Wild    Camp_WildNW  
		CastleToUnpackForFaction  = Wild    Camp_WildSE  
		CastleToUnpackForFaction  = Wild    Camp_WildNE  
		CastleToUnpackForFaction  = Wild    Camp_Wild
		
		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.
	
	End
End

//------------------------------------------------------------------------------
Object SarumanLightning
	
	// ***DESIGN parameters ***
	EditorSorting   = SYSTEM
	KindOf			= NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY ;INERT
	ThreatLevel		= 0
	
	// *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_01
		MaxHealth		= 999999
		InitialHealth	= 999999
	End
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 1000
		MaxLifetime		= 1000
	End	
End

//------------------------------------------------------------------------------
Object FellstormLightningEgg
	
	// ***DESIGN parameters ***
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE
	
	// *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_01
		MaxHealth		= 1
	End
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 1000
		MaxLifetime		= 8000
	End	
	
	Behavior = SlowDeathBehavior ModuleTag_SpawnRealTHUNDER
		OCL = FINAL OCL_SpellbookFellstormStart
	End
End

//------------------------------------------------------------------------------
Object FellstormLightning
	
	// ***DESIGN parameters ***
	EditorSorting   = SYSTEM
	KindOf			= NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY ;INERT
	ThreatLevel		= 0
	
	// *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_01
		MaxHealth		= 999999
		InitialHealth	= 999999
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= FellStormLightningWeapon
			FireDelay	= 0
			OneShot		= Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
	End
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 1000
		MaxLifetime		= 1000
	End	
End

//------------------------------------------------------------------------------
Object BreathOfManweObject

	; *** ART Parameters ***

    ; ButtonImage for Heros is button image on Hero Select UI to select hero. HI = HeroIcon or HeroImage.
   ButtonImage = HSGaladriel_NaturesWrath
	SelectPortrait         = UPTornado
	Draw = W3DScriptedModelDraw ModuleTag_01
		OkToChangeModelColor = Yes
		DefaultModelConditionState
			Model           = EXTornado_SKN
		End
	End
	
	Draw = W3DTornadoDraw ModuleTag_TornadoDraw
	
		DecalTemplate
  			Texture        = EXTornadoGround
			Style          = SHADOW_ALPHA_DECAL
			OpacityMin     = 5% 
			OpacityMax     = 20%	 
			MaxRadius	   = 300.0
			Color          = R:200 G:200 B:200 A:255 ;R:180 G:48 B:26 A:255 
			OnlyVisibleToOwningPlayer = Yes
			RotationsPerMinute = 0.4
			SpiralAcceleration = 1.0
		End
		DecalCount		= 7
		DecalMaxRadius	= 300.0
		
		
	End
	
	; ***DESIGN parameters ***
	Side			= Mordor
	EditorSorting	= UNIT
	BuildVariations	= GaladrielTornado01 GaladrielTornado02
	ThreatLevel		= 0.0
	CommandPoints	= 0
	ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS

	VisionRange		= 200.0
	DisplayName		= OBJECT:NaturesWrath
	
	CommandSet		= EmptyCommandSet


	; *** AUDIO Parameters ***

	EvaEnemyObjectSightedEvent = None  ; Don't bother player about this object showing up over their base -- happens too much to bother

	SoundAmbient	= TornadoLoopMS
	SoundMoveStart	= TornadoMoveStart

	VoiceAttack		= TornadoSelect
	VoiceMove		= TornadoSelect
	VoiceSelect		= TornadoSelect

	; *** ENGINEERING Parameters ***

	RadarPriority = UNIT
	KindOf = SELECTABLE NO_COLLIDE AIRCRAFT UNATTACKABLE MOVE_ONLY ORIENTS_TO_CAMERA CLICK_THROUGH HERO IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION NOT_AUTOACQUIRABLE IGNORES_SELECT_ALL PASS_EXPERIENCE_TO_PRODUCER
		
	Body = HighlanderBody ModuleTag_02
		MaxHealth         = 1.0
	End
	
	Behavior = AIUpdateInterface	ModuleTag_AIUpdateInterface
	End

	Behavior = PhysicsBehavior		ModuleTag_PhysicsBehavior
	End
	
	LocomotorSet
		Locomotor = TornadoLocomotor
		Condition = SET_NORMAL 
		Speed     = 20
	End
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 60000
		MaxLifetime		= 60000
	End	

	Behavior = FireWeaponUpdate ModuleTag_WINDY
		FireWeaponNugget
			WeaponName = TornadoWindWeapon
			FireDelay = 0
			OneShot = No
		End
	End	
	

	// TORNADOES ARE SCARY	
	Behavior = AttributeModifierAuraUpdate ModuleTag_FearMe
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= EyeOfSauronFear
		RefreshDelay	= 1000
		Range			= 350.0 ;;,;; ;;; 150.0
		ObjectFilter	= ANY +INFANTRY +CAVALRY
		TargetEnemy		= Yes
		MaxActiveRank	= 1		;Only affects level 1 rank units
	End	


	
	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes = ALL
	End

	Geometry = CYLINDER
	GeometryMajorRadius = 1.0
	GeometryMinorRadius = 1.0
	GeometryHeight		= 1.0
	GeometryIsSmall		= Yes





// NO SHADOW -M Lo
//    Shadow			= SHADOW_DECAL;SHADOW_ALPHA_DECAL; SHADOW_ALPHA_DECAL_DYNAMIC
//    ShadowSizeX		= 200;
//    ShadowSizeY		= 200;
//    ShadowTexture	= EUTornadoShadow;
//
//	ShadowOpacityStart = 0
//	ShadowOpacityFadeInTime = 1000
//	ShadowOpacityPeak = 255
//	ShadowOpacityFadeOutTime = 1000
//	ShadowOpacityEnd = 0
//
//	ShadowOverrideLODVisibility = yes

End

//------------------------------------------------------------------------------
Object PalantirVisionBase
	
	// ***DESIGN parameters ***
	EditorSorting   = SYSTEM
	KindOf			= NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY ;INERT
	ThreatLevel		= 0
	
	// *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_01
		MaxHealth		= 999999
		InitialHealth	= 999999
	End
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 60000 ;240000 ;;,;; 120000 ;;.;; 90000
		MaxLifetime		= 60000 ;240000 ;;,;; 120000 ;;.;; 90000
	End	
	
	// Detects other stealth units
	Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
		DetectionRate   = 500   // how often to rescan for stealthed things in my sight (msec)
	End
	
End

//------------------------------------------------------------------------------
ChildObject PalantirVisionPing PalantirVisionBase
	VisionRange     = 500 ;,; 700.0 ;;,;; 400.0 ;;.;; 300.0
	
	Behavior = AttributeModifierAuraUpdate ModuleTag_TroopBonus ;,;
        StartsActive    = Yes
        BonusName        = PalantirVision
        RefreshDelay    = 2000
        ObjectFilter    = ANY +INFANTRY +ARCHER +CAVALRY +HERO +MACHINE +HORDE -MONSTER -STRUCTURE -BASE_FOUNDATION
    End

	// Gives ally trrops bonus		;;,;; Doesn't actually do anything, but no reason to leave it around.
;;,;;	Behavior = AttributeModifierAuraUpdate ModuleTag_TroopBonus
;;,;;		StartsActive	= Yes				//If no, requires upgrade to turn on.
;;,;;		BonusName		= PalantirVision
;;,;;		RefreshDelay	= 1000
;;,;;		Range			= 200
;;,;;		ObjectFilter	= ANY +ORC +URUK +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO
;;,;;	End	
End

;------------------------------------------------------------------------------
ChildObject FarSeeingPing PalantirVisionBase
	VisionRange	= 525 ;;,;; 250

;;.;;
	;Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	;	MinLifetime		= 90000
	;	MaxLifetime		= 90000
	;End	
End

;------------------------------------------------------------------------------
ChildObject GuldurPalantirPing PalantirVisionBase
	VisionRange	= 300

	Behavior = FireWeaponUpdate ModuleTag_GuldurPalantirWeapon
			FireWeaponNugget
				WeaponName = GuldurPalantirWeapon
				FireDelay = 0
				OneShot = No
			End
	End	
	
;;.;;
	;Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	;	MinLifetime		= 90000
	;	MaxLifetime		= 90000
	;End	
End

;------------------------------------------------------------------------------
ChildObject DenethorPalantirPing PalantirVisionBase
	VisionRange	= 300

;;.;;
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 120000 ;;.;; 90000
		MaxLifetime		= 120000 ;;.;; 90000
	End	
End

//------------------------------------------------------------------------------
Object IvoryTowerVisionBase
	
	// ***DESIGN parameters ***
	EditorSorting   = SYSTEM
	KindOf			= NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY ;INERT
	ThreatLevel		= 0
	
	// *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_01
		MaxHealth		= 999999
		InitialHealth	= 999999
	End
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= MEN_FORTRESS_IVORY_TOWER_VISION_TIME
		MaxLifetime		= MEN_FORTRESS_IVORY_TOWER_VISION_TIME
	End	
	
	// Detects other stealth units
	Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
		DetectionRate   = 500   // how often to rescan for stealthed things in my sight (msec)
	End
	
End

//------------------------------------------------------------------------------
ChildObject IvoryTowerVisionPing IvoryTowerVisionBase
	VisionRange     = MEN_FORTRESS_IVORY_TOWER_VISION_RANGE

	;;,;; removed for 2.02, just in case we ever give Palantir Vision a troop bonus
;	// Gives ally troops bonus
;	Behavior = AttributeModifierAuraUpdate ModuleTag_TroopBonus
;		StartsActive	= Yes				//If no, requires upgrade to turn on.
;		BonusName		= PalantirVision
;		RefreshDelay	= 1000
;		Range			= 200
;		ObjectFilter	= ANY +ORC +URUK +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO
;	End	
End

;------------------------------------------------------------------------------
Object GuldurConcealmentPing

	EvaEnemyObjectSightedEvent = None  ; Not a real unit

	; ***DESIGN parameters ***
	VisionRange     = 0.0
	EditorSorting   = SYSTEM
	KindOf			= NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
	ThreatLevel		= 0
	
	; *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_01
		MaxHealth		= 999999
		InitialHealth	= 999999
	End

	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 60000								; 60 seconds
		MaxLifetime		= 60000
	End	

	Behavior = InvisibilityUpdate ModuleTag_BroadcastCamouflage
		InvisibilityNugget
			InvisibilityType	= CAMOUFLAGE
			DetectionRange		= ELVEN_MIST_CAMOUFLAGE_DETECTION_RANGE
		End
		UpdatePeriod			= 1000
		Broadcast				= Yes
		BroadcastRange			= ENSHROUDING_MIST_EFFECT_RADIUS
		BroadcastObjectFilter	= ANY +HORDE +HERO +DOZER +STRUCTURE +GuldurWebbedHumanoid +RohanEntFir_Summoned +RohanEntBirch_Summoned +RohanEntFir +RohanEntBirch +RohanEntAsh +MordorMountainTroll +MordorDrummerTroll +MordorAttackTroll +WildMountainGiant +GoblinCaveTroll +CaveTroll_Slaved +MordorCaveTroll_Summoned +MordorAttackTroll_Summoned +WildMountainGiant_Summoned -Drogoth -GondorGwaihir_Summoned -GondorGwaihir -MordorFellBeast -MordorWitchKingOnFellBeast -ElvenFortressEagle -SpellBookDragonStrikeDragon -KhamulFellBeast -MorgomirFellBeast +GoblinCaveTroll_FromTrollLair ALLIES
		StartsActive			= Yes
	End
	
	Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
		StartsActive	= Yes
		BonusName		= GenericDebuff
		RefreshDelay	= 2000
		Range			= 200
		TargetEnemy		= Yes
		AntiCategory	= LEADERSHIP ;;,;; removed BUFF ; This means cancel all previous leadership bonuses
		ObjectFilter	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
	End
	
End

;------------------------------------------------------------------------------
Object EnshroudingMistPing

	EvaEnemyObjectSightedEvent = None  ; Not a real unit

	; ***DESIGN parameters ***
	VisionRange     = 0.0
	EditorSorting   = SYSTEM
	KindOf			= NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
	ThreatLevel		= 0
	
	; *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_01
		MaxHealth		= 999999
		InitialHealth	= 999999
	End

	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 60000								; 60 seconds
		MaxLifetime		= 60000
	End	

	Behavior = InvisibilityUpdate ModuleTag_BroadcastCamouflage
		InvisibilityNugget
			InvisibilityType	= CAMOUFLAGE
			DetectionRange		= ELVEN_MIST_CAMOUFLAGE_DETECTION_RANGE
		End
		UpdatePeriod			= 1000
		Broadcast				= Yes
		BroadcastRange			= ENSHROUDING_MIST_EFFECT_RADIUS
		BroadcastObjectFilter	= ELVEN_MIST_OBJECT_FILTER
		StartsActive			= Yes
	End
	
	Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
		StartsActive	= Yes
		BonusName		= GenericDebuff
		RefreshDelay	= 2000
		Range			= 200
		TargetEnemy		= Yes
		AntiCategory	= LEADERSHIP ;;,;; removed BUFF ; This means cancel all previous leadership bonuses
		ObjectFilter	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
	End
	
End
;------------------------------------------------------------------------------
Object EnshroudingMistLorienPing

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		OkToChangeModelColor  = Yes
		UseStandardModelNames = Yes
		DefaultModelConditionState
			Model = NONE
			ParticleSysBone = None MistLorien FollowBone:Yes ;HouseColor:yes
			ParticleSysBone = None MistLorienLeaves FollowBone:Yes
		End

		MultiPlayerOnly = No
	End 

	EvaEnemyObjectSightedEvent = None  ; Not a real unit

	; ***DESIGN parameters ***
	VisionRange     = 0.0
	EditorSorting   = SYSTEM
	KindOf			= NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
	ThreatLevel		= 0
	
	; *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_01
		MaxHealth		= 999999
		InitialHealth	= 999999
	End

	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 60000								; 60 seconds
		MaxLifetime		= 60000
	End	

	Behavior = InvisibilityUpdate ModuleTag_BroadcastCamouflage
		InvisibilityNugget
			InvisibilityType	= CAMOUFLAGE
			DetectionRange		= ELVEN_MIST_CAMOUFLAGE_DETECTION_RANGE
		End
		UpdatePeriod			= 1000
		Broadcast				= Yes
		BroadcastRange			= ENSHROUDING_MIST_EFFECT_RADIUS
		BroadcastObjectFilter	= ELVEN_MIST_OBJECT_FILTER
		StartsActive			= Yes
	End
	
	Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
		StartsActive	= Yes
		BonusName		= LorienMist ;GenericDebuff
		RefreshDelay	= 2000
		Range			= 200
		TargetEnemy		= Yes
		AntiCategory	= LEADERSHIP ;;,;; removed BUFF ; This means cancel all previous leadership bonuses
		ObjectFilter	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
	End
	
	Behavior = FireWeaponUpdate ModuleTag_RIPGOBBOS
        FireWeaponNugget
            WeaponName    = LorienFieldWeapon
            Offset = X:0 Y:0 Z:0
            FireDelay    = 50
    End
End
End

;------------------------------------------------------------------------------
;------------------------------------------------------------------------------
Object FrozenLandPing ; this is not a unit, just the "thing" that does the work of the Frozen Land spell

	EvaEnemyObjectSightedEvent = None  ; Not a real unit

	; ***DESIGN parameters ***
	VisionRange     = 0.0
	EditorSorting   = SYSTEM
	KindOf			= NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
	ThreatLevel		= 0
	
	; *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_01
		MaxHealth		= 999999
		InitialHealth	= 999999
	End

	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= AOTR_FROZEN_LAND_EFFECT_DURATION
		MaxLifetime		= AOTR_FROZEN_LAND_EFFECT_DURATION
	End	

	Behavior = AttributeModifierAuraUpdate ModuleTag_WeLikeSnow
		StartsActive	= Yes
		BonusName		= GenericHeroLeadership
		RefreshDelay	= 2000
		Range			= SPELLBOOK_TAINT_RADIUS
		TargetEnemy		= No
		ObjectFilter	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
	End

	Behavior = AttributeModifierAuraUpdate ModuleTag_WeHateSnow ;;,;; added
		StartsActive	= Yes
		BonusName		= FrozenLandSpeedModifier
		RefreshDelay	= 2000
		Range			= SPELLBOOK_TAINT_RADIUS
		TargetEnemy		= Yes
		ObjectFilter	= ANGMAR_NECRO_BLACK_ICE_SPECIAL_OBJECT_FILTER
	End	
	
	Behavior = FireWeaponUpdate ModuleTag_FireExtinguish ;,; Added in v5.1
        FireWeaponNugget
            WeaponName    = FrozenLandFireExtinguish
            Offset = X:0 Y:0 Z:0
            FireDelay    = 50
            ;,; OneShot        = Yes
    End
End
End

;------------------------------------------------------------------------------
;Object BarrowCorruptPing ; this is not a unit, just the "thing" that does the work of the Frozen Land spell
;
;	EvaEnemyObjectSightedEvent = None  ; Not a real unit
;
;	; ***DESIGN parameters ***
;	VisionRange     = 0.0
;	EditorSorting   = SYSTEM
;	KindOf			= NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
;	ThreatLevel		= 0
;	
;	; *** ENGINEERING Parameters ***
;	Body = ActiveBody ModuleTag_01
;		MaxHealth		= 999999
;		InitialHealth	= 999999
;	End
;
;	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
;		MinLifetime		= 5000
;		MaxLifetime		= 5000
;	End	
;
;	
;End


;------------------------------------------------------------------------------
; 'Ping' for heal spell. Acts like an invisible banner carrier or well to 
; replenish exactly one unit for each hurt horde in the area of effect
Object HealSpellHordeReplenishPing


    EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
    ; ***DESIGN parameters ***
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION ;INERT

    ; *** ENGINEERING Parameters ***
    Body = ImmortalBody ModuleTag_01
		MaxHealth = 10000
		InitialHealth = 10000
	End
	
	Behavior = DeletionUpdate ModuleTag_DeletionUpdate ; Not LifetimeUpdate because I can't die
		MinLifetime		= 1000 ; Last 1 second, just long enough to replenish once
		MaxLifetime		= 1000
	End	
	
	Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
		IdleSpawnRate			= 2000							; spawn a new member every n seconds when idle (in miliseconds). Greater than lifetime
		UnitSpawnFX				= FX_BannerCarrierSpawnUnit		; name of particle FX to use when the BannerCarrier spawns a new unit		

		; This object acts like a banner carrier except it spawns unit on nearby hordes instead of itself.
		ReplenishNearbyHorde	= Yes
		ReplenishAllNearbyHordes = Yes ; Except it replenishes 1 for each horde, not 1 total
		ScanHordeDistance		= SPELL_HEAL_RADIUS_HORDE_SCAN
	End	
End

;------------------------------------------------------------------------------
; 'Ping' for RIVENDELL heal spell. Acts like an invisible banner carrier or well to 
; replenish exactly one unit for each hurt horde in the area of effect
Object RivendellSpellHordeReplenishPing


    EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
    ; ***DESIGN parameters ***
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION ;INERT

    ; *** ENGINEERING Parameters ***
    Body = ImmortalBody ModuleTag_01
		MaxHealth = 10000
		InitialHealth = 10000
	End
	
	Behavior = DeletionUpdate ModuleTag_DeletionUpdate ; Not LifetimeUpdate because I can't die
		MinLifetime		= 1000 ; Last 1 second, just long enough to replenish once
		MaxLifetime		= 1000
	End	
	
	Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
		IdleSpawnRate			= 2000							; spawn a new member every n seconds when idle (in miliseconds). Greater than lifetime
		UnitSpawnFX				= FX_BannerCarrierSpawnUnit		; name of particle FX to use when the BannerCarrier spawns a new unit		

		; This object acts like a banner carrier except it spawns unit on nearby hordes instead of itself.
		ReplenishNearbyHorde	= Yes
		ReplenishAllNearbyHordes = Yes ; Except it replenishes 1 for each horde, not 1 total
		ScanHordeDistance		= SPELL_HEAL_RADIUS_HORDE_SCAN
	End	
End

;------------------------------------------------------------------------------
Object SuperweaponPing

  ; ***DESIGN parameters ***
  ShroudClearingRange     = 150.0
  EditorSorting   = SYSTEM
  KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT INERT_SHROUD_REVEALER

  ; *** ENGINEERING Parameters ***
  Body = ImmortalBody ModuleTag_01
    MaxHealth = 1    
    InitialHealth = 1
  End

  Behavior = DeletionUpdate ModuleTag_02 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
    MinLifetime = 10000   ; InitialDelay + TransitionTime for Vision Update
    MaxLifetime = 10000   
  End
  
  ; The deletion time and vision range are determined by the "ViewObject" settings in the special powers.

  Geometry            = BOX
  GeometryMajorRadius = 10.0
  GeometryMinorRadius = 1.0
  GeometryHeight      = 3.0
  GeometryIsSmall     = No
  Shadow              = NONE ; doesn't actually have a model...
End

;---------Pointer------------
Object InGameMarker
 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = EXMarker
	      	ParticleSysBone NONE Pointer
	      	Shadow = SHADOW_ADDITIVE_DECAL_DYNAMIC
	      	ShadowSizeX = 135;
	    	ShadowSizeY = 135;
		    ShadowTexture = EXSpotLight;
			ShadowOpacityStart = 0
			ShadowOpacityFadeInTime = 1000
			ShadowOpacityPeak = 255
			ShadowOpacityFadeOutTime = 1000
			ShadowOpacityEnd = 0
			ShadowOverrideLODVisibility = yes
    	End
  	End
  	
  	; *** AUDIO parameters ***
  	EvaEnemyObjectSightedEvent = None  ; Not a real unit

  ; ***DESIGN parameters ***
  	EditorSorting       = SYSTEM
	Side 				= Civilian
  	KindOf = NO_COLLIDE AIRCRAFT UNATTACKABLE MOVE_ONLY CLICK_THROUGH IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION
  	ThreatLevel		= 0.0
	CommandPoints	= 0
	ShockwaveResistance = SHOCKWAVE_RESISTANCE_IMMUNE
	
	VisionRange		= 200.0
	
	Body = ActiveBody ModuleTag_02
		MaxHealth         = 200000
		MaxHealthDamaged  = 100000
		RecoveryTime      = 5000
	End
	
	Behavior = AIUpdateInterface	ModuleTag_AIUpdateInterface
	End

	Behavior = PhysicsBehavior		ModuleTag_PhysicsBehavior
	End
	LocomotorSet
		Locomotor = EyeLocomotor
		Condition = SET_NORMAL 
		Speed     = 200
 	End
 	Geometry = CYLINDER
	GeometryMajorRadius = 1.0
	GeometryMinorRadius = 1.0
	GeometryHeight		= 1.0
	GeometryIsSmall		= Yes

	ShadowOpacityStart = 0
	ShadowOpacityFadeInTime = 1000
	ShadowOpacityPeak = 255
	ShadowOpacityFadeOutTime = 1000
	ShadowOpacityEnd = 0
End

;------------------------------------------------------------------------------
;---------Pointer------------
Object InGameMarker2
 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = EXThroneShaft
	      	ParticleSysBone NONE Pointer
	      	Shadow = SHADOW_ADDITIVE_DECAL_DYNAMIC
	      	ShadowSizeX = 135;
	    	ShadowSizeY = 135;
		    ShadowTexture = EXSpotLight;
			ShadowOpacityStart = 0
			ShadowOpacityFadeInTime = 1000
			ShadowOpacityPeak = 255
			ShadowOpacityFadeOutTime = 1000
			ShadowOpacityEnd = 0
			ShadowOverrideLODVisibility = yes
    	End
  	End
  	
  	; *** AUDIO parameters ***
  	EvaEnemyObjectSightedEvent = None  ; Not a real unit

  ; ***DESIGN parameters ***
  	EditorSorting       = SYSTEM
	Side 				= Civilian
  	KindOf = NO_COLLIDE AIRCRAFT UNATTACKABLE MOVE_ONLY CLICK_THROUGH IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION
  	ThreatLevel		= 0.0
	CommandPoints	= 0
	ShockwaveResistance = SHOCKWAVE_RESISTANCE_IMMUNE
	
	VisionRange		= 200.0
	
	Body = ActiveBody ModuleTag_02
		MaxHealth         = 200000
		MaxHealthDamaged  = 100000
		RecoveryTime      = 5000
	End
	
	Behavior = AIUpdateInterface	ModuleTag_AIUpdateInterface
	End

	Behavior = PhysicsBehavior		ModuleTag_PhysicsBehavior
	End
	LocomotorSet
		Locomotor = EyeLocomotor
		Condition = SET_NORMAL 
		Speed     = 200
 	End
 	Geometry = CYLINDER
	GeometryMajorRadius = 1.0
	GeometryMinorRadius = 1.0
	GeometryHeight		= 1.0
	GeometryIsSmall		= Yes

	ShadowOpacityStart = 0
	ShadowOpacityFadeInTime = 1000
	ShadowOpacityPeak = 255
	ShadowOpacityFadeOutTime = 1000
	ShadowOpacityEnd = 0
End

;------------------------------------------------------------------------------
Object SpellBookEarthquakePiece
 	Draw = W3DScriptedModelDraw ModuleTag_01

		DefaultModelConditionState
			Model = Earthquake02
		End

		IdleAnimationState
			Animation
				AnimationName = Earthquake02.Earthquake02
				AnimationMode = ONCE
			End
		End
	End

	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 

	;--- AUDIO Parameters ---

	;SoundAmbient = SpellEarthquakeEarthHits
	
	;-------------------

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000   
		MaxLifetime = 10000   
	End
End

;------------------------------------------------------------------------------
Object SpellBookEarthquake

 	Draw = W3DScriptedModelDraw ModuleTag_01

		DefaultModelConditionState											; Comment this out for new style.
	      	Model = None
    	End

    ;	DefaultModelConditionState											; and this in...
	 ;     	Model = EarthQuake01
    ;	End
    ;	IdleAnimationState
	;		Animation = SPAWN
	;			AnimationName     = EarthQuake01.EarthQuake01
	;	        AnimationMode     = ONCE
	;		End
	;	End    

;    	DefaultModelConditionState
;	      	Model = EXEarthQuake
;   	End
;    	IdleAnimationState
;			Animation = SPAWN
;				AnimationName     = EXEarthQuake.EXEarthQuake
;		        AnimationMode     = ONCE
;			End
;		End    

 	End

	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	
	;--- AUDIO Parameters ---
	
	SoundAmbient = SpellEarthquakeRumbleLoop
	
	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000   
		MaxLifetime = 10000   
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName = EarthquakePhaseInitialWeapon
			FireDelay = 0
			OneShot = Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
		FireWeaponNugget
			WeaponName = EarthquakePhaseOneWeapon
			FireDelay = 800
			OneShot = Yes	
		End
		FireWeaponNugget
			WeaponName = EarthquakePhaseTwoWeapon
			FireDelay = 1200
			OneShot = Yes	
		End
		FireWeaponNugget
			WeaponName = EarthquakePhaseThreeWeapon
			FireDelay = 1800
			OneShot = Yes	
		End
		FireWeaponNugget
			WeaponName = EarthquakePhaseFinalWeapon
			FireDelay = 3400
			OneShot = Yes	
		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End
;------------------------------------------------------------------------------
Object SpellBookCastDownPiece
 	Draw = W3DScriptedModelDraw ModuleTag_01

		DefaultModelConditionState
			Model = none ;Earthquake02
		End

		IdleAnimationState
			Animation
				AnimationName = Earthquake02.Earthquake02
				AnimationMode = ONCE
			End
		End
	End

	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 

	;--- AUDIO Parameters ---

	;SoundAmbient = SpellEarthquakeEarthHits
	
	;-------------------
	
	Scale = 0.7

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000   
		MaxLifetime = 10000   
	End
End
;------------------------------------------------------------------------------
Object SpellBookCastDownObject

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = EXWhirl02
			
			ParticleSysBone NONE WhirlpoolMist04Start
			
			ParticleSysBone NONE WhirlpoolMist
			ParticleSysBone NONE WhirlpoolMist02
			ParticleSysBone NONE WhirlpoolMist03
			ParticleSysBone NONE WhirlpoolMist04
			ParticleSysBone NONE WhirlpoolMist05
			ParticleSysBone NONE WhirlpoolFoam
			
			
			;ParticleSysBone NONE WhirlpoolFlashes01
			;ParticleSysBone NONE WhirlpoolSparks		
		End
	End

 	; Draw = W3DScriptedModelDraw ModuleTag_01

		; DefaultModelConditionState											; Comment this out for new style.
	      	; Model = None
    	; End

 	; End

	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	
	;--- AUDIO Parameters ---
	
	SoundAmbient 			= ShipWhirlpoolAttack
	
	;SoundAmbient = SpellEarthquakeRumbleLoop
	
	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000   
		MaxLifetime = 10000   
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName = CastDownPhaseInitialWeapon
			FireDelay = 0
			OneShot = Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
		FireWeaponNugget
			WeaponName = CastDownPhaseOneWeapon
			FireDelay = 800
			OneShot = Yes	
		End
		FireWeaponNugget
			WeaponName = CastDownPhaseTwoWeapon
			FireDelay = 1200
			OneShot = Yes	
		End
		FireWeaponNugget
			WeaponName = CastDownPhaseThreeWeapon
			FireDelay = 1800
			OneShot = Yes	
		End
		FireWeaponNugget
			WeaponName = CastDownPhaseFinalWeapon
			FireDelay = 3400
			OneShot = Yes	
		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------
Object SpellBookFlood

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = None
    	End
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000   
		MaxLifetime = 10000   
	End
	
	Behavior = FloodUpdate ModuleTag_FloodCentral
		AngleOfFlow = 25	; In degrees, with 0 as screen right
		DirectionIsRelative = No ; If it is relative, it adds the facing of the flood object.
		
		FloodMember
			MemberTemplateName = FloodHorse
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:150 Z:0
			ControlPointOffsetThree =	X:100 Y:150 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 20
		End
		FloodMember
			MemberTemplateName = FloodHorse
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:100 Z:0
			ControlPointOffsetThree =	X:100 Y:100 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 21
		End
		FloodMember
			MemberTemplateName = FloodHorse
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:50 Z:0
			ControlPointOffsetThree =	X:100 Y:50 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 20
		End
		FloodMember
			MemberTemplateName = FloodHorse
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:0 Z:0
			ControlPointOffsetThree =	X:100 Y:0 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 22
		End
		FloodMember
			MemberTemplateName = FloodHorse
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:-50 Z:0
			ControlPointOffsetThree =	X:100 Y:-50 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 20
		End
		FloodMember
			MemberTemplateName = FloodHorse
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:-100 Z:0
			ControlPointOffsetThree =	X:100 Y:-100 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 21
		End
		FloodMember
			MemberTemplateName = FloodHorse
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:-150 Z:0
			ControlPointOffsetThree =	X:100 Y:-150 Z:0
			ControlPointOffsetFour =	X:210 Y:0 Z:-60
			MemberSpeed = 20
		End
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE
End

;------------------------------------------------------------------------------
Object FloodHorse

	Draw = W3DScriptedModelDraw ModuleTag_01
	StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
		DefaultModelConditionState
			Model = FloodHorse_SKN
			ParticleSysBone = Bone05 WaterHorseTrail FollowBone:Yes
			ParticleSysBone = Bone05 WaterHorseTrail2 FollowBone:Yes
			ParticleSysBone = Bone05 WaterHorseTrail3 FollowBone:Yes
		End
		
		IdleAnimationState
			StateName				= STATE_Idle
			Animation				= IDLE
				AnimationName		= FloodHorse_SKL.FloodHorse_RUNA
				AnimationMode		= LOOP
			End
			Flags					= RANDOMSTART
		End   
		
		AnimationState				= MOVING
			Animation				= RUNA
				AnimationName		= FloodHorse_SKL.FloodHorse_RUNA
				AnimationMode		= LOOP
			End
			Flags					= RANDOMSTART
		End   
		
	End

	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 

	; *** ENGINEERING Parameters ***
	Body = HighlanderBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End
	
	Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
		FireWeaponNugget
			WeaponName = FloodHorseRadiusWeapon
			Offset = X:-25 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End
		
	Behavior = SlowDeathBehavior ModuleTag_FadeOut
		DeathTypes			= ALL
		DestructionDelay	= 0
	End
	
	Geometry = CYLINDER
	GeometryMajorRadius = 17.6
	GeometryHeight = 32.0
	GeometryIsSmall = No
End

;------------------------------------------------------------------------------
Object FloodHorse_Campaign
	Scale = 2.0

	Draw = W3DScriptedModelDraw ModuleTag_01
	StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
		DefaultModelConditionState
			Model = FloodHorse_SKN
			ParticleSysBone = Bone05 WaterHorseTrail FollowBone:Yes
			ParticleSysBone = Bone05 WaterHorseTrail2 FollowBone:Yes
			ParticleSysBone = Bone05 WaterHorseTrail3 FollowBone:Yes
		End
		
		IdleAnimationState
			StateName				= STATE_Idle
			Animation				= IDLE
				AnimationName		= FloodHorse_SKL.FloodHorse_RUNA
				AnimationMode		= LOOP
			End
			Flags					= RANDOMSTART
		End   
		
		AnimationState				= MOVING
			Animation				= RUNA
				AnimationName		= FloodHorse_SKL.FloodHorse_RUNA
				AnimationMode		= LOOP
			End
			Flags					= RANDOMSTART
		End   
		
	End

	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 

	; *** ENGINEERING Parameters ***
	Body = HighlanderBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End
	
	Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
		FireWeaponNugget
			WeaponName = FloodHorseRadiusWeapon
			Offset = X:-25 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End
		
	Behavior = SlowDeathBehavior ModuleTag_FadeOut
		DeathTypes			= ALL
		DestructionDelay	= 0
	End
	
	Geometry = CYLINDER
	GeometryMajorRadius = 17.6
	GeometryHeight = 32.0
	GeometryIsSmall = No
End

//------------------------------------------------------------------------------
ChildObject FloodGateHorse FloodHorse
	
	Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
		FireWeaponNugget
			WeaponName = FloodGateHorseRadiusWeapon
			Offset = X:-25 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End
End


;------------------------------------------------------------------------------
Object PackWolf

	Draw = W3DScriptedModelDraw ModuleTag_01
	StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
		DefaultModelConditionState
			Model = CUWolf_SKN
			ParticleSysBone = NONE SoWolf_Pack_snow
			ParticleSysBone = NONE SoWolf_Pack_snowburst
			ParticleSysBone = NONE SoWolf_Pack_trail

		End
		
		IdleAnimationState
			StateName				= STATE_Idle
			Animation				= IDLE
				AnimationName		= CUWolf_SKL.CUWolf_RUNA
				AnimationMode		= LOOP
			End
			Flags					= RANDOMSTART
		End   
		
		AnimationState				= MOVING
			Animation				= RUNA
				AnimationName		= CUWolf_SKL.CUWolf_RUNA
				AnimationMode		= LOOP
			End
			Flags					= RANDOMSTART
		End   
		
	End

	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 

	Scale = 1.25
	VoiceMove = NeutralWargVoxMove
	SoundAmbient				= WargAmbienceVOX
	SoundImpact				= ImpactHorse
	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:WargMoveFootsteps Animation:CUWolf_SKL.CUWolf_RUNA Frames:0
	End
;
;	; Tie into LargeGroupAudio system
	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
		Key = Warg
	End

	; *** ENGINEERING Parameters ***
	Body = HighlanderBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End
	
	Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
		FireWeaponNugget
			WeaponName = PackWolfRadiusWeapon
			Offset = X:-25 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End
		
	Behavior = SlowDeathBehavior ModuleTag_FadeOut
		DeathTypes			= ALL
		DestructionDelay		= 250
		FadeDelay			= 0
		FadeTime			= 250
		FX = INITIAL FX_SoWolf_SummonPack_wolfdeath

	End
	
	Geometry = CYLINDER
	GeometryMajorRadius = 17.6
	GeometryHeight = 32.0
	GeometryIsSmall = No
End


;------------------------------------------------------------------------------
Object GoatsEgg
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None
		End
	End
	KindOf = INERT IMMOBILE UNATTACKABLE
	
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End
	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 0.0
		MaxLifetime = 0.0
	End
	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay = 300
		OCL = FINAL OCL_SpellBookGoatsEggNumeroDos
	End
END
Object SpellBookSendintheGoats

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = None
    	End
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000   
		MaxLifetime = 10000   
	End
	
	Behavior = FloodUpdate ModuleTag_FloodCentral
		AngleOfFlow = 25	; In degrees, with 0 as screen right
		DirectionIsRelative = No ; If it is relative, it adds the facing of the flood object.
		
		FloodMember
			MemberTemplateName = SummonGoat
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:125 Z:0
			ControlPointOffsetThree =	X:100 Y:125 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 20
		End
		FloodMember
			MemberTemplateName = SummonGoat
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:100 Z:0
			ControlPointOffsetThree =	X:100 Y:100 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 20
		End
		FloodMember
			MemberTemplateName = SummonGoat
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:75 Z:0
			ControlPointOffsetThree =	X:100 Y:75 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 20
		End
		FloodMember
			MemberTemplateName = SummonGoat
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:50 Z:0
			ControlPointOffsetThree =	X:100 Y:50 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 20
		End
		FloodMember
			MemberTemplateName = SummonGoat
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:25 Z:0
			ControlPointOffsetThree =	X:100 Y:25 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 20
		End
		FloodMember
			MemberTemplateName = SummonGoat
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:0 Z:0
			ControlPointOffsetThree =	X:100 Y:0 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 20
		End
		FloodMember
			MemberTemplateName = SummonGoat
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:-25 Z:0
			ControlPointOffsetThree =	X:100 Y:-25 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 20
		End
		FloodMember
			MemberTemplateName = SummonGoat
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:-50 Z:0
			ControlPointOffsetThree =	X:100 Y:-50 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 20
		End
		FloodMember
			MemberTemplateName = SummonGoat
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:-75 Z:0
			ControlPointOffsetThree =	X:100 Y:-75 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 20
		End
		FloodMember
			MemberTemplateName = SummonGoat
			ControlPointOffsetOne =		X:-200 Y:0 Z:0
			ControlPointOffsetTwo =		X:-100 Y:-100 Z:0
			ControlPointOffsetThree =	X:100 Y:-100 Z:0
			ControlPointOffsetFour =	X:200 Y:0 Z:0
			MemberSpeed = 20
		End
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE
End


;------------------------------------------------------------------------------
Object SummonGoat
	Draw = W3DScriptedModelDraw ModuleTag_01
	StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
		DefaultModelConditionState
			Model = dugoata
			Model = dugoatb  ExtraMesh:Yes
			Model = dugoatc  ExtraMesh:Yes
			ParticleSysBone = NONE GenericSiegeTrailDust
			; ParticleSysBone = NONE SoWolf_Pack_snow
			; ParticleSysBone = NONE SoWolf_Pack_snowburst
			; ParticleSysBone = NONE SoWolf_Pack_trail
		End
		
		IdleAnimationState
			StateName				= STATE_Idle
			Animation				= IDLE
				AnimationName		= RURohrm_SKL.RURohrm_RUNE
				AnimationMode		= LOOP
			End
			Flags					= RANDOMSTART
		End   
		
		AnimationState				= MOVING
			Animation				= RUNA
				AnimationName		= RURohrm_SKL.RURohrm_RUNE
				AnimationMode		= LOOP
			End
			Flags					= RANDOMSTART
		End   
		
	End

	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT SCARY

	;Scale = 1.0
	;VoiceMove = NeutralWargVoxMove
	;SoundAmbient				= WargAmbienceVOX
	SoundImpact				= ImpactHorse
	;ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
	;	MaxUpdateRangeCap = 800
	;	AnimationSound = Sound:WargMoveFootsteps Animation:CUWolf_SKL.CUWolf_RUNA Frames:0
	;End
;
;	; Tie into LargeGroupAudio system
;	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
;		Key = Warg
;	End

	Body = HighlanderBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End
	
	Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
		FireWeaponNugget
			WeaponName = PackRamRadiusWeapon
			Offset = X:-25 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End
		
	Behavior = SlowDeathBehavior ModuleTag_FadeOut
		DeathTypes			= ALL
		DestructionDelay		= 250
		FadeDelay			= 0
		FadeTime			= 250
		FX = INITIAL FX_SoWolf_SummonPack_wolfdeath

	End
	
	Geometry = CYLINDER
	GeometryMajorRadius = 17.6
	GeometryHeight = 32.0
	GeometryIsSmall = No
End

Object SpellBookAvalancheEgg
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None
		End
	End
	KindOf = INERT IMMOBILE UNATTACKABLE
	
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End
	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 0.0
		MaxLifetime = 0.0
	End
	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay	= 1700
		OCL	= MIDPOINT OCL_SpellBookAvalanche
		OCL	= FINAL OCL_SpellBookAvalancheSecond
		DoNotRandomizeMidpoint 	= Yes
	End

End

;------------------------------------------------------------------------------
Object SpellBookAvalanche

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = None
    	End
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate ;,;
		MinLifetime		= 30000
		MaxLifetime		= 30000
	End	

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 30000 ;,; 7000   
		MaxLifetime = 30000 ;,; 7000   
	End
	
	Behavior = AttributeModifierAuraUpdate ModuleTag_WeHateSnow ;,;
		StartsActive	= Yes
		BonusName		= FrozenLandSpeedModifier
		RefreshDelay	= 2000
		Range			= SPELLBOOK_TAINT_RADIUS
		TargetEnemy		= Yes
		ObjectFilter	= ANGMAR_NECRO_BLACK_ICE_SPECIAL_OBJECT_FILTER
	End	

	
	Behavior = FloodUpdate ModuleTag_FloodCentral
		AngleOfFlow = 0	; In degrees, with 0 as screen right
		DirectionIsRelative = No ; If it is relative, it adds the facing of the flood object.
		
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:0 Y:250 Z:0
			ControlPointOffsetFour =	X:0 Y:250 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:0 Y:-250 Z:0
			ControlPointOffsetFour =	X:0 Y:-250 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:20 Y:0 Z:0
			ControlPointOffsetThree =	X:250 Y:0 Z:0
			ControlPointOffsetFour =	X:250 Y:0 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:-250 Y:0 Z:0
			ControlPointOffsetFour =	X:-250 Y:0 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:-200 Y:-200 Z:0
			ControlPointOffsetFour =	X:-200 Y:-200 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:-200 Y:200 Z:0
			ControlPointOffsetFour =	X:-200 Y:200 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:200 Y:-200 Z:0
			ControlPointOffsetFour =	X:200 Y:-200 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:200 Y:200 Z:0
			ControlPointOffsetFour =	X:200 Y:200 Z:0
			MemberSpeed = 30
		End
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE
End

;------------------------------------------------------------------------------
Object SpellBookAvalancheSecond

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = None
    	End
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 7000   
		MaxLifetime = 7000   
	End
	
	
	Behavior = FloodUpdate ModuleTag_FloodCentral
		AngleOfFlow = 22.5	; In degrees, with 0 as screen right
		DirectionIsRelative = No ; If it is relative, it adds the facing of the flood object.
		
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:0 Y:250 Z:0
			ControlPointOffsetFour =	X:0 Y:250 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:0 Y:-250 Z:0
			ControlPointOffsetFour =	X:0 Y:-250 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:20 Y:0 Z:0
			ControlPointOffsetThree =	X:250 Y:0 Z:0
			ControlPointOffsetFour =	X:250 Y:0 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:-250 Y:0 Z:0
			ControlPointOffsetFour =	X:-250 Y:0 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:-200 Y:-200 Z:0
			ControlPointOffsetFour =	X:-200 Y:-200 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:-200 Y:200 Z:0
			ControlPointOffsetFour =	X:-200 Y:200 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:200 Y:-200 Z:0
			ControlPointOffsetFour =	X:200 Y:-200 Z:0
			MemberSpeed = 30
		End
		FloodMember
			MemberTemplateName = Avalanchechunk
			ControlPointOffsetOne =		X:0 Y:0 Z:0
			ControlPointOffsetTwo =		X:0 Y:0 Z:0
			ControlPointOffsetThree =	X:200 Y:200 Z:0
			ControlPointOffsetFour =	X:200 Y:200 Z:0
			MemberSpeed = 30
		End
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE
End

;------------------------------------------------------------------------------
;------------------------------------------------------------------------------
Object Avalanchechunk

	Draw = W3DScriptedModelDraw ModuleTag_01
	StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
		DefaultModelConditionState
			Model = None
;			ParticleSysBone = NONE SoWolf_Pack_snow
;			ParticleSysBone = NONE SoWolf_Pack_snowburst
;			ParticleSysBone = NONE SoWolf_Pack_trail

		End
		
	
	End

	CrusherLevel   = 3  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
	CrushWeapon = AvalancheCrush  
	MinCrushVelocityPercent = 40 ; Has to be moving at at least 35% of full speed.
	CrushDecelerationPercent = 05 ; Lose 20 percent of max velocity when crushing.
	
	CrushKnockback = 40;
	CrushZFactor = 1.0;

	EditorSorting   = SYSTEM
	KindOf =  IMMOBILE UNATTACKABLE INERT ;NO_COLLIDE

;	Scale = 1.25
;	VoiceMove = NeutralWargVoxMove
;	SoundAmbient				= WargAmbienceVOX
;	SoundImpact				= ImpactHorse
;	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
;		MaxUpdateRangeCap = 800
;		AnimationSound = Sound:WargMoveFootsteps Animation:CUWolf_SKL.CUWolf_RUNA Frames:0
;	End
;
;	; Tie into LargeGroupAudio system
;	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
;		Key = Warg
;	End


	; *** ENGINEERING Parameters ***
	Body = HighlanderBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End
	
	Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
		FireWeaponNugget
			WeaponName = AvalancheRadiusWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End
		
	Behavior = SlowDeathBehavior ModuleTag_FadeOut
		DeathTypes			= ALL
		DestructionDelay		= 250
		FadeDelay			= 0
		FadeTime			= 250
;		FX = INITIAL FX_SoWolf_SummonPack_wolfdeath

	End
	
	Geometry = CYLINDER
	GeometryMajorRadius = 10.0
	GeometryHeight = 12.0
	GeometryIsSmall = Yes
End

;------------------------------------------------------------------------------
Object BarrowCorruptProxy

	Draw = W3DScriptedModelDraw ModuleTag_01
	StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
		DefaultModelConditionState
			Model = None
			ParticleSysBone = NONE FX_BarrowCorruption
;			ParticleSysBone = NONE SoWolf_Pack_snowburst
;			ParticleSysBone = NONE SoWolf_Pack_trail

		End
		
	
	End

	DisplayName      = OBJECT:Prop
  	Side                = Civilian
  	EditorSorting   = STRUCTURE
  	Browser = REGION WEATHERTOP  STRUCTURE

	KindOf =  IMMOBILE UNATTACKABLE INERT ;NO_COLLIDE

;	Scale = 1.25

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 5000   
		MaxLifetime = 5000   
	End
	

	
	Geometry = CYLINDER
	GeometryMajorRadius = 10.0
	GeometryHeight = 12.0
	GeometryIsSmall = Yes
End

;------------------------------------------------------------------------------
;------------------------------------------------------------------------------
Object SpellBookRainOfFire02

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = EXMeteor02
	        ParticleSysBone Meteor RainTrail FollowBone:Yes
	        ParticleSysBone Meteor01 MRainTrail2 FollowBone:Yes
	        ParticleSysBone Meteor02 RainTrail2 FollowBone:Yes
	        ParticleSysBone Meteor03 RainTrail2 FollowBone:Yes
	        ParticleSysBone Meteor04 RainTrail2 FollowBone:Yes
	        ParticleSysBone Meteor05 RainTrail2 FollowBone:Yes
	        ParticleSysBone Meteor06 RainTrail2 FollowBone:Yes
	        ParticleSysBone Meteor07 RainTrail2 FollowBone:Yes

	        ParticleSysBone Meteor01 RainHit FollowBone:Yes
	        ParticleSysBone Meteor02 RainHit FollowBone:Yes
	        ParticleSysBone Meteor04 RainHit2 FollowBone:Yes
    	End
    	IdleAnimationState
			Animation = SPAWN
				AnimationName     = EXMeteor02.EXMeteor02
		        AnimationMode     = ONCE
			End
		End    
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	
	; *** AUDIO Parameters ***
	
	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 1800
		AnimationSound = Sound:SpellRainOfFireProjectileFlyBy	Animation:EXMeteor.EXMeteor		Frames: 20 49 55 61
		AnimationSound = Sound:ImpactRainOfFire					Animation:EXMeteor.EXMeteor		Frames: 52 75 79 89
		;AnimationSound = Sound:SpellRainOfFirePlume				Animation:EXMeteor.EXMeteor		Frames: 85
	End
	
	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000
		MaxLifetime = 10000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName = RainOfFirePhaseInitialWeapon02
			FireDelay = 0
			OneShot = Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
		FireWeaponNugget
			WeaponName = RainOfFirePhaseOneWeapon02
			FireDelay = 2500
			OneShot = Yes	
		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------
Object SpellBookRainOfFire

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = EXMeteor
	        ParticleSysBone Meteor MeteorTrail FollowBone:Yes
	        ParticleSysBone Meteor01 MeteorTrail2 FollowBone:Yes
	        ParticleSysBone Meteor02 MeteorTrail2 FollowBone:Yes
	        ParticleSysBone Meteor03 MeteorTrail2 FollowBone:Yes
	        ParticleSysBone Meteor04 MeteorTrail2 FollowBone:Yes
	        ParticleSysBone Meteor05 MeteorTrail2 FollowBone:Yes
	        ParticleSysBone Meteor06 MeteorTrail2 FollowBone:Yes
	        ParticleSysBone Meteor07 MeteorTrail2 FollowBone:Yes

	        ParticleSysBone Meteor01 MeteorHit FollowBone:Yes
	        ParticleSysBone Meteor02 MeteorHit FollowBone:Yes
	        ParticleSysBone Meteor04 MeteorHit2 FollowBone:Yes
    	End
    	IdleAnimationState
			Animation = SPAWN
				AnimationName     = EXMeteor.EXMeteor
		        AnimationMode     = ONCE
			End
		End    
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	
	; *** AUDIO Parameters ***
	
	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 1800
		AnimationSound = Sound:SpellRainOfFireProjectileFlyBy	Animation:EXMeteor.EXMeteor		Frames: 20 49 55 61
		AnimationSound = Sound:ImpactRainOfFire					Animation:EXMeteor.EXMeteor		Frames: 52 75 79 89
		;AnimationSound = Sound:SpellRainOfFirePlume				Animation:EXMeteor.EXMeteor		Frames: 85
	End
		
	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000
		MaxLifetime = 10000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName = RainOfFirePhaseInitialWeapon
			FireDelay = 0
			OneShot = Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
		FireWeaponNugget
			WeaponName = RainOfFirePhaseOneWeapon
			FireDelay = 2500
			OneShot = Yes	
		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End


;----------------------------------------------------------------------------
Object AngmarNecroCorpseRainSeed
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None
		End
	End
	KindOf = IMMOBILE UNATTACKABLE TAINTEFFECT
	
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End
	
	Behavior = LifetimeUpdate ModuleTag_Lifetime
		MinLifetime = 0
		MaxLifetime = 6000
	End
	
	Behavior = SlowDeathBehavior ModuleTag_SpawnRealTree
;		FX = FINAL FX_BalrogSummoningFinish
		OCL = FINAL OCL_AngmarNecroCorpseRainProjectile
	End
End


;----------------------------------------------------------------------------
Object GondorHeadOCL
  ; *** ART Parameters ***
;  Draw = W3DModelDraw ModuleTag_01
;    ConditionState        = NONE
;      Model               = W_Arrow
;      ParticleSysBone     = None FlameArrow
;      ParticleSysBone     = None FlameArrowFlare
;;     ParticleSysBone     = None FlameArrowSmoke
;    End
;  End
  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model = exgondorhead01
      ;ParticleSysBone     = None FlameArrow
      ;ParticleSysBone     = None FlameArrowFlare
    End
  End

  ; *** AUDIO Parameters ***

  ; ***DESIGN parameters ***
  EditorSorting     = SYSTEM
  ArmorSet
    Armor = NoArmor
  End
  VisionRange = 0.0

  ; *** ENGINEERING Parameters ***
  KindOf = NO_COLLIDE OCL_BIT UNATTACKABLE
    
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End
    
  Behavior = LifetimeUpdate ModuleTag_02
    MinLifetime = 3000   ; min lifetime in msec
    MaxLifetime = 4000   ; max lifetime in msec
  End

  Behavior = PhysicsBehavior ModuleTag_03
     AllowBouncing = Yes
;    KillWhenRestingOnGround = Yes
  End

  Behavior = SlowDeathBehavior ModuleTag_04
    SinkDelay         = 600
    SinkRate          = 6     ; in Dist/Sec
    DestructionDelay  = 6000
  End

  Geometry = Sphere
  GeometryIsSmall = Yes
  GeometryMajorRadius = 0.8
End
;------------------------------------------------------------------------------
Object AngmarNecroCorpseRainProjectile
 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = exgondorhead
	        ParticleSysBone Dummy BarrageProjectileSmoke FollowBone:Yes
			;ParticleSysBone     = DUMMY HumanHeadProjectileTrail
			;ParticleSysBone     = DUMMY TrebuchetRockTrail
	        ;ParticleSysBone Dummy BarrageProjectileFireMith FollowBone:Yes
	        ;ParticleSysBone Dummy BarrageProjectileSmokeMith FollowBone:Yes
	        ;ParticleSysBone Dummy BarrageProjectileEmbersMith FollowBone:Yes
    	End
    	IdleAnimationState
			Animation = SPAWN
				AnimationName     = exgondorhead.exgondorhead ;DE_Barrage.DE_Barrage
		        AnimationMode     = ONCE
			End
		End    
  	End
 	;Draw = W3DScriptedModelDraw ModuleTag_01
    	;DefaultModelConditionState
			;Model = exgondorhead ;
	        ;ParticleSysBone HELM CorpseRainProjectileFire FollowBone:Yes
	        ;ParticleSysBone HELM CorpseRainProjectileSmoke FollowBone:Yes
	      	;Model =  EXGoblin_FLYC ;MUBloodySack ;DE_Barrage  ;MUNazgul_SKN
	        ;ParticleSysBone SKULL_HE09 CorpseRainProjectileFire FollowBone:Yes
	        ;ParticleSysBone SKULL_HE09 CorpseRainProjectileSmoke FollowBone:Yes
	        ;ParticleSysBone SKULL_HE09 CorpseRainProjectileEmbers FollowBone:Yes
	        ;ParticleSysBone SKULL_HE09 CorpseRainProjectileEmbers2 FollowBone:Yes
	        ;ParticleSysBone SKULL_HE09 CorpseRainProjectileGlow FollowBone:Yes
    	;End
;   	IdleAnimationState
;			Animation = SPAWN
;				AnimationName     = DE_Barrage.DE_Barrage ;EXGoblin_FLYC.EXGoblin_FLYC ;
;		        AnimationMode     = ONCE
;			End
;		End    
; 	End
 	
;	IdleAnimationState 
;			Animation = FREEFALL
;				AnimationName = MUNazgul_SKL.MUNazgul_FLYA
;			AnimationMode = ONCE
;			End
;		END	
;	End	
;	
; 	Behavior = BezierProjectileBehavior ModuleTag_05
;
;  	 	FirstHeight = 1000  ; Height of Bezier control points above highest intervening terrain
;   	 	SecondHeight = 9
;    		FirstPercentIndent = 80% ; Percentage of shot distance control points are placed
;    		SecondPercentIndent = 90%
;    		FlightPathAdjustDistPerSecond = 50 ; Can allow a max speed this can attempt to follow a target. Units are their velocity we can tag. (45 is default human speed)
;    		GroundHitFX = FX_CatapultHumanHeadsExplosion
;    		CurveFlattenMinDist = 100.0
;  	End

	EditorSorting		= SYSTEM
	KindOf			= IMMOBILE UNATTACKABLE INERT NO_COLLIDE INERT_SHROUD_REVEALER
	ForceLuaRegistration	= Yes ; I have no AI, but I want to send a fear message so please register me.
	ShroudClearingRange	= 100
		Scale = 1.16
	
	Body = ActiveBody ModuleTag_04
    		MaxHealth = 99999.0
	End

	Behavior = LifetimeUpdate ModuleTag_02
		MinLifetime = 1000   ; min lifetime in msec
		MaxLifetime = 1000  ; max lifetime in msec
	End

	Behavior = SlowDeathBehavior ModuleTag_03
		DeathTypes = ALL
		FX = FINAL FX_GondorHeadExplosion ;FX_ZombieHeadExplosion ;FX_CorpseRainExplosion
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName = AngmarCorpseRainPhaseInitialWeapon
			FireDelay = 0
			OneShot = Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
		FireWeaponNugget
			WeaponName = AngmarCorpseRainProjectileWeapon
			FireDelay = 600
			OneShot = Yes	
		End
	End
	
;  Behavior = CreateObjectDie ModuleTag_06
;    DeathTypes = ALL
;    CreationList = OCL_GondorCorpseHead
;  End
 
;	Geometry = BOX
;	GeometryMajorRadius = 7.07355
;	GeometryMinorRadius = 14.6135
;	GeometryHeight = 13.1552
;	GeometryOffset = X:0.0 Y:0.0 Z:0.0
;	GeometryIsSmall = No


	Geometry            = BOX
	GeometryMajorRadius = 1.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 300.0
	GeometryIsSmall     = No
	Shadow              = NONE

;	Geometry = BOX
;	GeometryMajorRadius = 40.0
;	GeometryMinorRadius = 50.0
;	GeometryHeight = 0.0
;	GeometryIsSmall = No
End

;------------------------------------------------------------------------------
;------------------------------------------------------------------------------
Object AngmarNecroCorpseRainProjectileMith

;;,;;
;
; 	Draw = W3DScriptedModelDraw ModuleTag_01
;    	DefaultModelConditionState
;	      	Model = DE_Barrage
;	        ParticleSysBone Dummy BarrageProjectileFireMith FollowBone:Yes
;	        ParticleSysBone Dummy BarrageProjectileSmokeMith FollowBone:Yes
;	        ParticleSysBone Dummy BarrageProjectileEmbersMith FollowBone:Yes
;    	End
;    	IdleAnimationState
;			Animation = SPAWN
;				AnimationName     = DE_Barrage.DE_Barrage
;		        AnimationMode     = ONCE
;			End
;		End    
;  	End
;
;;,;;
	
 	Draw = W3DScriptedModelDraw ModuleTag_01	;;,;; New draw for 2.3
    	DefaultModelConditionState
	      	Model =  EXGoblin_FLYC ;MUBloodySack ;DE_Barrage  ;MUNazgul_SKN
	        ParticleSysBone SKULL_HE09 CorpseRainProjectileFire202Mith FollowBone:Yes
	        ParticleSysBone SKULL_HE09 CorpseRainProjectileSmoke202Mith FollowBone:Yes
	        ParticleSysBone SKULL_HE09 CorpseRainProjectileEmbers202Mith FollowBone:Yes
	        ParticleSysBone SKULL_HE09 CorpseRainProjectileEmbers2202Mith FollowBone:Yes
	        ParticleSysBone SKULL_HE09 CorpseRainProjectileGlow202Mith FollowBone:Yes
    	End
   	IdleAnimationState
			Animation = SPAWN
				AnimationName     = EXGoblin_FLYC.EXGoblin_FLYC ;DE_Barrage.DE_Barrage ;EXGoblin_FLYC.EXGoblin_FLYC ;
		        AnimationMode     = ONCE
			End
		End    
 	End
	
	EditorSorting			= SYSTEM
	KindOf					= IMMOBILE UNATTACKABLE INERT NO_COLLIDE INERT_SHROUD_REVEALER
	ForceLuaRegistration	= Yes ; I have no AI, but I want to send a fear message so please register me.
	ShroudClearingRange		= 100
	
	
	Body = ActiveBody ModuleTag_04
    		MaxHealth = 99999.0
	End

	Behavior = LifetimeUpdate ModuleTag_02
		MinLifetime = 1000   ; min lifetime in msec
		MaxLifetime = 1000  ; max lifetime in msec
	End

	Behavior = SlowDeathBehavior ModuleTag_03
		DeathTypes = ALL
		FX = FINAL FX_CorpseRainExplosion202Mith
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName = AngmarCorpseRainPhaseInitialWeapon
			FireDelay = 0
			OneShot = Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
		FireWeaponNugget
			WeaponName = AngmarCorpseRainProjectileWeapon
			FireDelay = 600
			OneShot = Yes	
		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 1.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 300.0
	GeometryIsSmall     = No
	Shadow              = NONE
End


;----------------------------------------------------------------------------
Object SpellBookBombardSeed
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None
		End
	End
	KindOf = IMMOBILE UNATTACKABLE TAINTEFFECT
	
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End
	
	Behavior = LifetimeUpdate ModuleTag_Lifetime
		MinLifetime = 0
		MaxLifetime = 6000
	End
	
	Behavior = SlowDeathBehavior ModuleTag_SpawnRealTree
;		FX = FINAL FX_BalrogSummoningFinish
		OCL = FINAL OCL_SpellBookBombardProjectile
	End
End


;------------------------------------------------------------------------------
Object SpellBookBombardProjectile

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = DE_Barrage
	        ParticleSysBone Dummy BarrageProjectileFire FollowBone:Yes
	        ParticleSysBone Dummy BarrageProjectileSmoke FollowBone:Yes
	        ParticleSysBone Dummy BarrageProjectileEmbers FollowBone:Yes
    	End
    	IdleAnimationState
			Animation = SPAWN
				AnimationName     = DE_Barrage.DE_Barrage
		        AnimationMode     = ONCE
			End
		End    
  	End
	
	EditorSorting			= SYSTEM
	KindOf					= IMMOBILE UNATTACKABLE INERT NO_COLLIDE INERT_SHROUD_REVEALER
	ForceLuaRegistration	= Yes ; I have no AI, but I want to send a fear message so please register me.
	ShroudClearingRange		= 100
	
	
	Body = ActiveBody ModuleTag_04
    		MaxHealth = 99999.0
	End

	Behavior = LifetimeUpdate ModuleTag_02
		MinLifetime = 1000   ; min lifetime in msec
		MaxLifetime = 1000  ; max lifetime in msec
	End

	Behavior = SlowDeathBehavior ModuleTag_03
		DeathTypes = ALL
		FX = FINAL FX_BombardExplosion
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName = BombardPhaseInitialWeapon
			FireDelay = 0
			OneShot = Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
		FireWeaponNugget
			WeaponName = BombardProjectileWeapon
			FireDelay = 600
			OneShot = Yes	
		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 1.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 300.0
	GeometryIsSmall     = No
	Shadow              = NONE
End

;------------------------------------------------------------------------------
;------------------------------------------------------------------------------
Object SpellBookBombardProjectileMith

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = DE_Barrage
	        ParticleSysBone Dummy BarrageProjectileFireMith FollowBone:Yes
	        ParticleSysBone Dummy BarrageProjectileSmokeMith FollowBone:Yes
	        ParticleSysBone Dummy BarrageProjectileEmbersMith FollowBone:Yes
    	End
    	IdleAnimationState
			Animation = SPAWN
				AnimationName     = DE_Barrage.DE_Barrage
		        AnimationMode     = ONCE
			End
		End    
  	End
	
	EditorSorting			= SYSTEM
	KindOf					= IMMOBILE UNATTACKABLE INERT NO_COLLIDE INERT_SHROUD_REVEALER
	ForceLuaRegistration	= Yes ; I have no AI, but I want to send a fear message so please register me.
	ShroudClearingRange		= 100
	
	
	Body = ActiveBody ModuleTag_04
    		MaxHealth = 99999.0
	End

	Behavior = LifetimeUpdate ModuleTag_02
		MinLifetime = 1000   ; min lifetime in msec
		MaxLifetime = 1000  ; max lifetime in msec
	End

	Behavior = SlowDeathBehavior ModuleTag_03
		DeathTypes = ALL
		FX = FINAL FX_BombardExplosionMith
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName = BombardPhaseInitialWeapon
			FireDelay = 0
			OneShot = Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
		FireWeaponNugget
			WeaponName = BombardProjectileWeapon
			FireDelay = 600
			OneShot = Yes	
		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 1.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 300.0
	GeometryIsSmall     = No
	Shadow              = NONE
End

;------------------------------------------------------------------------------


Object TheFiresOfDoom

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = EXMeteor
	        ParticleSysBone Meteor MeteorTrail FollowBone:Yes
	        ParticleSysBone Meteor01 MeteorTrail2 FollowBone:Yes
	        ParticleSysBone Meteor02 MeteorTrail2 FollowBone:Yes
	        ParticleSysBone Meteor03 MeteorTrail2 FollowBone:Yes
	        ParticleSysBone Meteor04 MeteorTrail2 FollowBone:Yes
	        ParticleSysBone Meteor05 MeteorTrail2 FollowBone:Yes
	        ParticleSysBone Meteor06 MeteorTrail2 FollowBone:Yes
	        ParticleSysBone Meteor07 MeteorTrail2 FollowBone:Yes

	        ParticleSysBone Meteor01 MeteorHit FollowBone:Yes
	        ParticleSysBone Meteor02 MeteorHit FollowBone:Yes
	        ParticleSysBone Meteor04 MeteorHit2 FollowBone:Yes
    	End
    	IdleAnimationState
			Animation = SPAWN
				AnimationName     = EXMeteor.EXMeteor
		        AnimationMode     = ONCE
			End
		End    
  	End
  	
	EditorSorting			= SYSTEM
	KindOf					= NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration	= Yes ; I have no AI, but I want to send a fear message so please register me.
	
	;--- AUDIO Parameters ---

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 1800
		AnimationSound = Sound:SpellRainOfFireProjectileFlyBy	Animation:EXMeteor.EXMeteor		Frames: 20 49 55 61
		AnimationSound = Sound:ImpactRainOfFire					Animation:EXMeteor.EXMeteor		Frames: 52 75 79 89
		;AnimationSound = Sound:SpellRainOfFirePlume				Animation:EXMeteor.EXMeteor		Frames: 85
	End	

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000
		MaxLifetime = 10000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= RainOfFirePhaseInitialWeapon
			FireDelay	= 0
			OneShot		= Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
		FireWeaponNugget
			WeaponName	= RainOfFirePhaseOneWeapon
			FireDelay	= 2500
			OneShot		= Yes	
		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	
	
	Shadow			= SHADOW_ADDITIVE_DECAL_DYNAMIC
    ShadowSizeX		= 400
    ShadowSizeY		= 400
    ShadowTexture	= EXLnzFlar1

	ShadowOpacityStart = 0
	ShadowOpacityFadeInTime = 1000
	ShadowOpacityPeak = 255
	ShadowOpacityFadeOutTime = 1000
	ShadowOpacityEnd = 0
	
End

;//------------------------------------------------------------------------------
Object SunflareSunbeam
	
	;// *** ART Parameters ***
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model               = NONE
			ParticleSysBone		= None SunRays
			ParticleSysBone		= None SunFlareGlow
			ParticleSysBone		= None SunFlareProxy
		End
	End

	;// *** AUDIO Parameters ***

	;// ***DESIGN parameters ***
	EditorSorting     = SYSTEM
	
	ArmorSet
		Armor = NoArmor
	End
	
	VisionRange = 0.0

	;// *** ENGINEERING Parameters ***
	KindOf = IMMOBILE UNATTACKABLE INERT SCARY

	Body = ActiveBody ModuleTag_01
		MaxHealth = 99999.0
	End

	;// the following two modules control death fade -- uses alpha for now
	Behavior = LifetimeUpdate ModuleTag_02
		MinLifetime = SPELL_SUNFLARE_DURATION   ;// min lifetime in msec
		MaxLifetime = SPELL_SUNFLARE_DURATION   ;// max lifetime in msec
	End

	Behavior = FireWeaponUpdate ModuleTag_KillAllCurrentWeather ;;,;; added for 2.02e
		FireWeaponNugget
			WeaponName	= WeatherKiller
			Offset = X:0 Y:0 Z:0
			FireDelay	= 0
			OneShot		= Yes
		End
	End

	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= SunflareWeapon
			FireDelay	= 0
			OneShot		= Yes	;// Alternative is to fire as often as the reload time of this weapon allows
		End
	End

	Behavior = AIUpdateInterface ModuleTag_03	
		AILuaEventsList				= SunbeamFunctions
	End

  	Geometry			= CYLINDER
	GeometryMajorRadius = 50.0
	GeometryMinorRadius = 50.0
	GeometryHeight		= 100.0
	GeometryIsSmall		= No
	
End

;//------------------------------------------------------------------------------
Object FearRadiator
	;// *** AUDIO Parameters ***

	;// ***DESIGN parameters ***
	EditorSorting     = SYSTEM
	
	ArmorSet
		Armor = NoArmor
	End
	
	VisionRange = 0.0

	;// *** ENGINEERING Parameters ***
	KindOf = IMMOBILE UNATTACKABLE

	Body = ActiveBody ModuleTag_TheActiveBody
		MaxHealth = 99999.0
	End

	Behavior = RadiateFearUpdate ModuleTag_GoldenArrowDaylightUpdate
		EmotionPulseRadius		= 300
		EmotionPulseInterval		= 1000
		GenerateUncontrollableFear	= Yes
		InitiallyActive			= Yes
		VictimFilter			= ANY +INFANTRY +CAVALRY +MONSTER -HERO -MordorBlackRider -MordorBlackRiderHorde -DwarvenZerker -NoldorWarrior -GondorKnightsofDol -GondorKnightsofDolHorde -WildBabyDrake -WildBabyDrakeHorde -IsengardFanatic ENEMIES ;;.;; ANY ALLFACTION_EVIL_UNIT_FILTER ;2.02 balance	 ;;.;;VictimFilter			= ANY +AngmarOrcWarrior +AngmarRhudaurSlinger +AngmarRhudaurSpearmen +AngmarWolfRider +MordorBlackOrc +WildMarauderSwords +MordorFighter +MordorBannerOrc +WildBannerGoblin +WildBannerMarauder +WildBannerSpiderling +GoblinFighter +GoblinArcher +WildSpiderling +GoblinSpiderRider +WildShelob +MordorGoblinSwordsman +MordorGoblinSwordsman_Slaved +MordorGoblinArcher +MordorGoblinArcher_Slaved +BarrowWight +MordorArcher +WildMarauder ENEMIES ;;.;; Added RotWK units
		
	End
End

;------------------------------------------------------------------------------
ChildObject HaldirGoldenArrowDaylight FearRadiator
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model               = None
			ParticleSysBone		= None CloudBreakRays
		End
	End
	Behavior = LifetimeUpdate ModuleTag_01
		MinLifetime = SPELL_HALDIR_GOLDENARROW_DAYLIGHT_DURATION_MS
		MaxLifetime = SPELL_HALDIR_GOLDENARROW_DAYLIGHT_DURATION_MS
	End
End

;------------------------------------------------------------------------------
Object GlorfindelStarlightObject ;;,;; ChildObject GlorfindelStarlightObject FearRadiator

  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model               = None
      ParticleSysBone = None CloudBreakRays
    End
;    IdleAnimationState
;      EnteringStateFX = FX_CloudBreakRays
;    End 
        
    ; this is how you control birth fade
;	BirthFadeTime = 1000  ; msec
;	BirthFadeAdditive = Yes
 
  End
  
  ;;,;;-------------------------------
  ;;,;; Now a full object.  Parameters added.
	;// *** AUDIO Parameters ***

	;// ***DESIGN parameters ***
	EditorSorting     = SYSTEM
	
	ArmorSet
		Armor = NoArmor
	End
	
	VisionRange = 0.0

	;// *** ENGINEERING Parameters ***
	KindOf = IMMOBILE UNATTACKABLE

	Body = ActiveBody ModuleTag_TheActiveBody
		MaxHealth = 99999.0
	End
  ;;,;;-------------------------------

	Behavior = LifetimeUpdate ModuleTag_01
		MinLifetime = SPELL_GLORFINDEL_STARLIGHT_DURATION_MS
		MaxLifetime = SPELL_GLORFINDEL_STARLIGHT_DURATION_MS
	End
	
	Behavior = AutoHealBehavior ModuleTag_HealUpdate
		StartsActive	= Yes
		HealingAmount	= 5.0
		HealingDelay	= 30
		Radius			= GLORFINDEL_STARLIGHT_RADIUS
		; no buff effect, GenericBuff below will supply
	End
	
	Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
		StartsActive	= Yes
		BonusName		= GlorfindelStarlightBonus ;;,;; GenericBuff
		RefreshDelay	= 2000
		Range			= GLORFINDEL_STARLIGHT_RADIUS
		ObjectFilter	= AOTR_GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
	End	

End

;------------------------------------------------------------------------------
Object MenLongShotObject

 	Draw = W3DScriptedModelDraw ModuleTag_01
 	// StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
    	DefaultModelConditionState
	      	Model = EXArrowVolleyL
	      	ParticleSysBone Flame ArrowVolleyTrail FollowBone:Yes
			ParticleSysBone Flame ArrowVolleyTrail2 FollowBone:Yes
			ParticleSysBone Flame ArrowVolleyFire FollowBone:Yes
			ParticleSysBone None ArrowStormDust
			ParticleSysBone None ArrowStormEmbers
			ParticleSysBone None ArrowStormShock
    	End
    	IdleAnimationState
			Animation = SPAWN
				AnimationName     = EXArrowVolleyL.EXArrowVolleyL
		        AnimationMode     = ONCE
			End
		End    
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	
	; --- AUDIO Parameters ---

;	VoiceCreated		= IthilienRangerLongShotMS	;this didn't work
;	VoiceFullyCreated	= IthilienRangerLongShotMS	;this didn't work

	SoundAmbient		= LongshotRangerCall	;IthilienRangerLongShotMS	;this works but add delay in audio event

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:LongshotFireArrowWarningShot		Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:34
		AnimationSound = Sound:LongshotBowRelease				Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:100
		AnimationSound = Sound:LongshotArrowBys					Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:90
		;AnimationSound = Sound:LongshotFlyOver					Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:91
		AnimationSound = Sound:LongshotArrowImpacts				Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:137
	End

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000
		MaxLifetime = 10000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= ArrowVolleyPhaseInitialWeapon
			FireDelay	= 0
			OneShot		= Yes
		End
		FireWeaponNugget
			WeaponName	= MenLongShotWeaponReal
			FireDelay	= 4700
			OneShot		= Yes	
		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------
Object MenLongShotObject_NoSound

 	Draw = W3DScriptedModelDraw ModuleTag_01
 	// StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
    	DefaultModelConditionState
	      	Model = EXArrowVolleyL
	      	ParticleSysBone Flame ArrowVolleyTrail FollowBone:Yes
			ParticleSysBone Flame ArrowVolleyTrail2 FollowBone:Yes
			ParticleSysBone Flame ArrowVolleyFire FollowBone:Yes
			ParticleSysBone None ArrowStormDust
			ParticleSysBone None ArrowStormEmbers
			ParticleSysBone None ArrowStormShock
    	End
    	IdleAnimationState
			Animation = SPAWN
				AnimationName     = EXArrowVolleyL.EXArrowVolleyL
		        AnimationMode     = ONCE
			End
		End    
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	
	; --- AUDIO Parameters ---

;	VoiceCreated		= IthilienRangerLongShotMS	;this didn't work
;	VoiceFullyCreated	= IthilienRangerLongShotMS	;this didn't work

	;SoundAmbient		= LongshotRangerCall	;IthilienRangerLongShotMS	;this works but add delay in audio event

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:LongshotFireArrowWarningShot		Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:34
		AnimationSound = Sound:LongshotBowRelease				Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:100
		AnimationSound = Sound:LongshotArrowBys					Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:90
		;AnimationSound = Sound:LongshotFlyOver					Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:91
		AnimationSound = Sound:LongshotArrowImpacts				Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:137
	End

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000
		MaxLifetime = 10000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= ArrowVolleyPhaseInitialWeapon
			FireDelay	= 0
			OneShot		= Yes
		End
;;,;;		FireWeaponNugget
;;,;;			WeaponName	= MenLongShotWeaponReal
;;,;;			FireDelay	= 4700
;;,;;			OneShot		= Yes	
;;,;;		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------
Object SpellBookChillWind
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End

	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	;ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End


	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 3000
		MaxLifetime = 3000
	End


	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= ChillWindWeapon
			FireDelay	= 0
			OneShot		= Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
	End

	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes = ALL
		FadeTime = 4000
        	FadeDelay = 1000
	End


	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End







;------------------------------------------------------------------------------
Object SpellBookArrowVolley

 	Draw = W3DScriptedModelDraw ModuleTag_01
 //	 StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
    	DefaultModelConditionState
	      	Model = EXArrowVolleyL
	      	ParticleSysBone Flame ArrowVolleyTrail FollowBone:Yes
			ParticleSysBone Flame ArrowVolleyTrail2 FollowBone:Yes
			ParticleSysBone Flame ArrowVolleyFire FollowBone:Yes
			ParticleSysBone None ArrowStormDust
			ParticleSysBone None ArrowStormEmbers
			ParticleSysBone None ArrowStormShock
    	End
		IdleAnimationState
			Animation = SPAWN
				AnimationName     = EXArrowVolleyL.EXArrowVolleyL
		        AnimationMode     = ONCE
			End
		End    
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	
	
	; --- AUDIO Parameters ---

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:SpellArrowVolleyFireArrowWarningShot		Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:34
		AnimationSound = Sound:SpellArrowVolleyBowRelease				Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:100
		AnimationSound = Sound:SpellArrowVolleyArrowBys					Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:90
		AnimationSound = Sound:SpellArrowVolleyFlyOver					Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:91
		AnimationSound = Sound:SpellArrowVolleyArrowImpacts				Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:137
	End

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End
	
	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000
		MaxLifetime = 10000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= ArrowVolleyPhaseInitialWeapon
			FireDelay	= 0
			OneShot		= Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
;;,;;		FireWeaponNugget
;;,;;			WeaponName	= ArrowVolleyOneWeapon
;;,;;			FireDelay	= 4700
;;,;;			OneShot		= Yes	
;;,;;		End
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------
Object SpellBookArrowVolleyDamagerEgg	;;,;;

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End
	
	EditorSorting   = SYSTEM
	KindOf = IMMOBILE UNATTACKABLE INERT 
	
	; *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End

	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 0.0
		MaxLifetime = 0.0
	End
	
	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay	= 4600			; Adjusts the actual spawn delay			; this is in miliseconds
		OCL					= FINAL OCL_ArrowVolleyDamager ; Spawn final ents
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------
Object SpellBookCampaignArrowVolleyDamagerEgg	;;,;;

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End
	
	EditorSorting   = SYSTEM
	KindOf = IMMOBILE UNATTACKABLE INERT 
	
	; *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End

	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 0.0
		MaxLifetime = 0.0
	End
	
	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay	= 4600			; Adjusts the actual spawn delay			; this is in miliseconds
		OCL					= FINAL OCL_CampaignArrowVolleyDamager ; Spawn final ents
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------
Object SpellBookArrowVolleyLorienDamagerEgg	;;,;;

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End
	
	EditorSorting   = SYSTEM
	KindOf = IMMOBILE UNATTACKABLE INERT 
	
	; *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End

	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 0.0
		MaxLifetime = 0.0
	End
	
	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay	= 4600			; Adjusts the actual spawn delay			; this is in miliseconds
		OCL					= FINAL OCL_ArrowVolleyLorienDamager ; Spawn final ents
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------
Object SpellBookMirkwoodArrowVolley
	Scale = 1.5
 	Draw = W3DScriptedModelDraw ModuleTag_01
 //	 StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
    	DefaultModelConditionState
	      	Model = exarrowhail
	      	;ParticleSysBone Flame ArrowVolleyTrail FollowBone:Yes
			;ParticleSysBone Flame ArrowVolleyTrail2 FollowBone:Yes
			;ParticleSysBone Flame ArrowVolleyFire FollowBone:Yes
			;ParticleSysBone None ArrowStormDust
			;ParticleSysBone None ArrowStormEmbers
			;ParticleSysBone None ArrowStormShock
    	End
		IdleAnimationState
			Animation = SPAWN
				AnimationName     = exarrowhail.exarrowhail
		        AnimationMode     = ONCE
			End	
			BeginScript
			EndScript
		End    
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	
	
	; --- AUDIO Parameters ---

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
;		AnimationSound = Sound:SpellArrowVolleyFireArrowWarningShot		Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:34
;		AnimationSound = Sound:SpellArrowVolleyBowRelease				Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:100
;		AnimationSound = Sound:SpellArrowVolleyArrowBys					Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:90
;		AnimationSound = Sound:SpellArrowVolleyFlyOver					Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:91
		AnimationSound = Sound:SpellArrowVolleyArrowImpacts				Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:137
	End

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End
	
	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 5000
		MaxLifetime = 5000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= ArrowVolleyPhaseInitialWeapon
			FireDelay	= 0
			OneShot		= Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
;;,;;		FireWeaponNugget
;;,;;			WeaponName	= ArrowVolleyOneWeapon
;;,;;			FireDelay	= 4700
;;,;;			OneShot		= Yes	
;;,;;		End
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------
Object SpellBookMirkwoodArrowVolleyDamagerEgg	;;,;;

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End
	
	EditorSorting   = SYSTEM
	KindOf = IMMOBILE UNATTACKABLE INERT 
	
	; *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End

	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 0.0
		MaxLifetime = 0.0
	End
	
	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay	= 500			; Adjusts the actual spawn delay			; this is in miliseconds
		OCL					= FINAL OCL_MirkwoodArrowVolleyDamager ; Spawn final ents
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

ChildObject MenLongShotDamagerEgg SpellBookArrowVolleyDamagerEgg	;;,;;

	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay	= 4600			; Adjusts the actual spawn delay			; this is in miliseconds
		OCL					= FINAL OCL_MenLongShotDamager ; Spawn final ents
	End
End	
	
ChildObject FaramirAmbushDamagerEgg1 SpellBookArrowVolleyDamagerEgg	;;,;;

	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay	= 4600			; Adjusts the actual spawn delay			; this is in miliseconds
		OCL					= FINAL OCL_FaramirAmbushDamager1 ; Spawn final ents
	End
End	
	
ChildObject FaramirAmbushDamagerEgg2 SpellBookArrowVolleyDamagerEgg	;;,;;

	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay	= 4600			; Adjusts the actual spawn delay			; this is in miliseconds
		OCL					= FINAL OCL_FaramirAmbushDamager2 ; Spawn final ents
	End	
	
End

;------------------------------------------------------------------------------
Object SpellBookArrowVolleyDamager		;;,;;

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = none
    	End
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End
	
	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000
		MaxLifetime = 10000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= ArrowVolleyOneWeapon
			FireDelay	= 0
			OneShot		= Yes	
		End
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------
Object SpellBookCampaignArrowVolleyDamager		;;,;;

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = none
    	End
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End
	
	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000
		MaxLifetime = 10000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= CampaignArrowVolleyOneWeapon
			FireDelay	= 0
			OneShot		= Yes	
		End
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------
Object SpellBookArrowVolleyLorienDamager		;;,;;

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = none
    	End
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End
	
	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000
		MaxLifetime = 10000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= ArrowVolleyLorienOneWeapon
			FireDelay	= 0
			OneShot		= Yes	
		End
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------
Object SpellBookMirkwoodArrowVolleyDamager		;;,;;

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = none
    	End
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End
	
	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 5000
		MaxLifetime = 5000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= MirkwoodArrowVolleyOneWeapon
			FireDelay	= 0
			OneShot		= Yes	
		End
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

ChildObject MenLongShotDamager SpellBookArrowVolleyDamager	;;,;;

	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= MenLongShotWeaponReal
			FireDelay	= 0
			OneShot		= Yes	
		End
	End
End		
	
ChildObject FaramirAmbushDamager1 SpellBookArrowVolleyDamager	;;,;;

	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= FaramirAmbushWeaponReal1
			FireDelay	= 0
			OneShot		= Yes	
		End
	End
End		
	
ChildObject FaramirAmbushDamager2 SpellBookArrowVolleyDamager	;;,;;

	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= FaramirAmbushWeaponReal2
			FireDelay	= 0
			OneShot		= Yes	
		End
	End
	
End

;------------------------------------------------------------------------------
Object ShellMapMD
	; *** DESIGN parameters ***
	EditorSorting = SYSTEM
	Side		  = Civilian
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT INERT_SHROUD_REVEALER CAN_CAST_REFLECTIONS

	; *** ART Parameters ***
	Draw = W3DScriptedModelDraw ModuleTag_01
		DefaultModelConditionState
			Model = Shell02_01
		End
		IdleAnimationState
			Animation = IDLE
				AnimationName     = Shell02_01.Shell02_01
		        AnimationMode     = LOOP
			End
		End    
	End
End

;------------------------------------------------------------------------------
Object ColorTableTestOBJ

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = ColorTableTest
	      	ParticleSysBone = Fire01 ColorTestFire FollowBone:Yes
			ParticleSysBone = Fire02 ColorTestFireball FollowBone:Yes
			ParticleSysBone = Smoke01 SmokeIsengardPitThin FollowBone:Yes
			ParticleSysBone = Smoke02 ElvenForgeSmoke FollowBone:Yes
			ParticleSysBone = Dust01 ColorTestDust01 FollowBone:Yes
			ParticleSysBone = Dust02 ColorTestDust02 FollowBone:Yes
			ParticleSysBone = Snow01 SnowColorTest FollowBone:Yes
			ParticleSysBone = Snow02 BoatDieing2 FollowBone:Yes
    	End
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	
	
	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End


	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

; -----------------------------------------------------------------------------
Object WaterSparkleTest ; Used to be blown up in a test map to fire an FXList 
  
  ; *** ART Parameters ***
  
  ; *** DESIGN Parameters ***
  EditorSorting = SYSTEM
  
  ; *** ENGINEERING Parameters ***
  KindOf              = IMMOBILE IGNORE_FOR_VICTORY
  Draw                = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model           = None
      ParticleSysBone = NONE WaterSparkleTest
    End
  End
  
  Geometry            = SPHERE
  GeometryMajorRadius = 0.8
  GeometryIsSmall     = Yes
  
End

; -----------------------------------------------------------------------------
Object ShroudRevealer_Bombard
   
	EditorSorting		= SYSTEM
	ShroudClearingRange	= EVIL_SHIP_BOMBARD_REVEAL_RADIUS

	; *** ENGINEERING Parameters ***
	KindOf              = IMMOBILE REVEAL_TO_ALL NOT_AUTOACQUIRABLE UNATTACKABLE

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model		= None
		End
	End
	
	Body = HighlanderBody ModuleTag_Body
		MaxHealth      = 1.0
	End
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate	
		MinLifetime		= EVIL_SHIP_BOMBARD_REVEAL_TIMEOUT
		MaxLifetime		= EVIL_SHIP_BOMBARD_REVEAL_TIMEOUT
	End
	
	Behavior = BezierProjectileBehavior ModuleTag_Projectile
		CrushStyle		= Yes									; Don't die when end of path is reached. Allow LifetimeUpdate to do this.
	End

	Geometry            = SPHERE
	GeometryMajorRadius = 0.8
	GeometryIsSmall     = Yes

End

; -----------------------------------------------------------------------------
ChildObject ShroudRevealer_BattleShip ShroudRevealer_Bombard
   
	ShroudClearingRange	= EVIL_SHIP_ANTI_SHIP_REVEAL_RADIUS
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate	
		MinLifetime		= EVIL_SHIP_ANTI_SHIP_REVEAL_TIMEOUT
		MaxLifetime		= EVIL_SHIP_ANTI_SHIP_REVEAL_TIMEOUT
	End

End




;------------------------------------------------------------------------------
Object IsengardDetonateRangedObj

 	Draw = W3DScriptedModelDraw ModuleTag_01
 //	 StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
    	DefaultModelConditionState
	      	Model = EXArrowVolleyL
	      	ParticleSysBone Flame ArrowVolleyTrail FollowBone:Yes
			ParticleSysBone Flame ArrowVolleyTrail2 FollowBone:Yes
			ParticleSysBone Flame ArrowVolleyFire FollowBone:Yes
			ParticleSysBone None ArrowStormDust
			ParticleSysBone None ArrowStormEmbers
			ParticleSysBone None ArrowStormShock
    	End
    	IdleAnimationState
			Animation = SPAWN
				AnimationName     = EXArrowVolleyL.EXArrowVolleyL
		        AnimationMode     = ONCE
			End
		End    
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	
	
	; --- AUDIO Parameters ---

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:SpellArrowVolleyFireArrowWarningShot		Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:34
	End

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 4000
		MaxLifetime = 4000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= ArrowVolleyPhaseInitialWeapon
			FireDelay	= 0
			OneShot		= Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
;		FireWeaponNugget
;			WeaponName	= IsegardDetonateMine
;			FireDelay	= 4000
;			OneShot		= Yes	
;		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------
Object AngmarLongIceShotObject ;MenLongShotObject

 	Draw = W3DScriptedModelDraw ModuleTag_01
 	// StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
    	DefaultModelConditionState
	      	Model = EXArrowVolleyL ;EXIceArwVolleyL ;EXIceArwVolleyM
	      	Texture		= EXArrowStorm.tga EXArrowStormIce.tga
	      		ParticleSysBone Flame IceArrowVolleyTrail FollowBone:Yes
	      		ParticleSysBone Flame IceArrowVolleyEmbers FollowBone:Yes
			ParticleSysBone Flame IceArrowVolleyTrail2 FollowBone:Yes
			ParticleSysBone Flame IceArrowVolleyEmbers2 FollowBone:Yes
			ParticleSysBone Flame IceArrowVolleyFire FollowBone:Yes
			ParticleSysBone None ArrowStormDust
			ParticleSysBone None IceArrowStormEmbers
			ParticleSysBone None IceArrowStormShock
    	End
    	IdleAnimationState
			Animation = SPAWN
				AnimationName     = EXArrowVolleyL.EXArrowVolleyL ;EXIceArwVolleyL.EXIceArwVolleyL
		        AnimationMode     = ONCE
			End
		End    
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	
	; --- AUDIO Parameters ---

;	VoiceCreated		= IthilienRangerLongShotMS	;this didn't work
;	VoiceFullyCreated	= IthilienRangerLongShotMS	;this didn't work

	SoundAmbient		= LongshotRangerCall	;IthilienRangerLongShotMS	;this works but add delay in audio event

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:LongshotFireArrowWarningShot		Animation:EXArrowVolleyL.EXArrowVolleyL Frames:34  ;EXIceArwVolleyL.EXIceArwVolleyL
		AnimationSound = Sound:LongshotBowRelease			Animation:EXArrowVolleyL.EXArrowVolleyL Frames:100 ;EXIceArwVolleyL.EXIceArwVolleyL
		AnimationSound = Sound:LongshotArrowBys				Animation:EXArrowVolleyL.EXArrowVolleyL Frames:90  ;EXIceArwVolleyL.EXIceArwVolleyL
		;AnimationSound = Sound:LongshotFlyOver				Animation:EXArrowVolleyL.EXArrowVolleyL Frames:91  ;EXIceArwVolleyL.EXIceArwVolleyL
		AnimationSound = Sound:LongshotArrowImpacts			Animation:EXArrowVolleyL.EXArrowVolleyL Frames:137  ;EXIceArwVolleyL.EXIceArwVolleyL
	End

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 7000  ;6550
		MaxLifetime = 7000  ;6550
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= ArrowVolleyPhaseInitialWeapon
			FireDelay	= 0
			OneShot		= Yes
		End
;;,;;		FireWeaponNugget
;;,;;			WeaponName	= MenLongShotWeaponReal
;;,;;			FireDelay	= 4700
;;,;;			OneShot		= Yes	
;;,;;		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

;------------------------------------------------------------------------------ ;;.;;
Object SpellBookBlightCompromiseWeapon
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End

	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	;ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End


	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = BLIGHT_EFFECT_DURATION
		MaxLifetime = BLIGHT_EFFECT_DURATION
	End

	Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
		StartsActive		= Yes
		BonusName		= SpellBookBlight
		RefreshDelay		= 2000
		Range			= BLIGHT_EFFECT_RADIUS
		TargetEnemy		= Yes
;;,;;		AntiCategory	= LEADERSHIP BUFF ; This means cancel all previous leadership bonuses
		ObjectFilter	= BLIGHT_TYPE_SPELL_OBJECT_FILTER
	End

;***NOTE: If we can set up the initial weapon to fire ten times, once every ten seconds, then we can considerably clean up the FireWeaponUpdate behavior ;;.;;
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= BlightInitialWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay	= 0
			OneShot		= Yes
		End
		FireWeaponNugget
			WeaponName	= BlightInitialWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay	= 1000
			OneShot		= Yes
		End
		FireWeaponNugget
			WeaponName	= BlightInitialWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay	= 2000
			OneShot		= Yes
		End
		FireWeaponNugget
			WeaponName	= BlightInitialWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay	= 3000
			OneShot		= Yes
		End
		FireWeaponNugget
			WeaponName	= BlightInitialWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay	= 4000
			OneShot		= Yes
		End
		FireWeaponNugget
			WeaponName	= BlightInitialWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay	= 5000
			OneShot		= Yes
		End
		FireWeaponNugget
			WeaponName	= BlightInitialWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay	= 6000
			OneShot		= Yes
		End
		FireWeaponNugget
			WeaponName	= BlightInitialWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay	= 7000
			OneShot		= Yes
		End
		FireWeaponNugget
			WeaponName	= BlightInitialWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay	= 8000
			OneShot		= Yes
		End
		FireWeaponNugget
			WeaponName	= BlightInitialWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay	= 9000
			OneShot		= Yes
		End
		FireWeaponNugget
			WeaponName	= BlightPhaseOneWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay	= 0
			OneShot		= No
		End
		FireWeaponNugget
			WeaponName	= BlightPhaseTwoWeapon
			Offset = X:0 Y:0 Z:0
			FireDelay	= 10000
			OneShot		= No
		End		
	End
End

;------------------------------------------------------------------------------ ;;.;;
Object WellOfSoulsWeaponObject

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End

    EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
    ; ***DESIGN parameters ***
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 1000
		MaxLifetime = 1000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= Necro202WellOfSoulsDamageHandler
			Offset = X:0 Y:0 Z:0
			FireDelay	= 0
			OneShot		= Yes
		End
	End
	
End

;------------------------------------------------------------------------------ ;;.;;
Object FellStrengthWeaponObject

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End

    EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
    ; ***DESIGN parameters ***
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 1000
		MaxLifetime = 1000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= Necro202FellStrengthDamageHandler
			Offset = X:0 Y:0 Z:0
			FireDelay	= 0
			OneShot		= Yes
		End
	End
	
End

;------------------------------------------------------------------------------ ;;,;; added for 2.02e
Object DarknessWeatherChanger

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End
	
	EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
	; ***DESIGN parameters ***
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
	

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 1000
		MaxLifetime = 1000
	End

	Behavior = FireWeaponUpdate ModuleTag_KillAllCurrentWeather
		FireWeaponNugget
			WeaponName	= WeatherKiller
			Offset = X:0 Y:0 Z:0
			FireDelay	= 0
			OneShot		= Yes
		End
	End

	Behavior = FireWeaponUpdate ModuleTag_MakeTheDarknessCaster
		FireWeaponNugget
			WeaponName	= MakeDarknessCaster
			Offset = X:0 Y:0 Z:0
			FireDelay	= 50
			OneShot		= Yes
		End
	End

End

;------------------------------------------------------------------------------ ;;,;; added for 2.02e
Object DarknessCaster

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End
	
	EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
	; ***DESIGN parameters ***
	EditorSorting   = SYSTEM
	KindOf = BOAT ; NO_COLLIDE IMMOBILE INERT ; UNATTACKABLE
	

	; *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_02 ; ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = SPELL_DARKNESS_DURATION
		MaxLifetime = SPELL_DARKNESS_DURATION
	End

	Behavior = FireWeaponUpdate ModuleTag_WeaponFiringApplyAttributeModifier
		FireWeaponNugget
			WeaponName = ConstantDarkness
			Offset = X:0 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End

End

;------------------------------------------------------------------------------ ;;,;; added for 2.02e
Object MirkwoodDarknessWeatherChanger

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End
	
	EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
	; ***DESIGN parameters ***
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
	

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 1000
		MaxLifetime = 1000
	End

	Behavior = FireWeaponUpdate ModuleTag_KillAllCurrentWeather
		FireWeaponNugget
			WeaponName	= WeatherKiller
			Offset = X:0 Y:0 Z:0
			FireDelay	= 0
			OneShot		= Yes
		End
	End

	Behavior = FireWeaponUpdate ModuleTag_MakeTheDarknessCaster
		FireWeaponNugget
			WeaponName	=    
			Offset = X:0 Y:0 Z:0
			FireDelay	= 50
			OneShot		= Yes
		End
	End

End

;------------------------------------------------------------------------------ ;;,;; added for 2.02e
Object MirkwoodDarknessCaster

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End
	
	EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
	; ***DESIGN parameters ***
	EditorSorting   = SYSTEM
	KindOf = BOAT ; NO_COLLIDE IMMOBILE INERT ; UNATTACKABLE
	

	; *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_02 ; ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = SPELL_DARKNESS_DURATION
		MaxLifetime = SPELL_DARKNESS_DURATION
	End

	Behavior = FireWeaponUpdate ModuleTag_WeaponFiringApplyAttributeModifier
		FireWeaponNugget
			WeaponName = ConstantMirkwoodDarkness
			Offset = X:0 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End

End

;------------------------------------------------------------------------------ ;;,;; added for 2.3
Object WotR202PowerGranter

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End
	
	EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
	; ***DESIGN parameters ***
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE INERT UNATTACKABLE
	

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	#include "..\Includes\FortressEconomyBonusGrants.inc"

End

;------------------------------------------------------------------------------ ;,; Added in v5.1

Object CloudBreak_Healing
   Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    ;// *** AUDIO Parameters ***

	;// ***DESIGN parameters ***
	EditorSorting     = SYSTEM
	
	ArmorSet
		Armor = NoArmor
	End
	
	VisionRange = 0.0

	;// *** ENGINEERING Parameters ***
	KindOf = IMMOBILE UNATTACKABLE

	Body = ActiveBody ModuleTag_TheActiveBody
		MaxHealth = 99999.0
	End
	
; -------------------------------

    Behavior = DeletionUpdate ModuleTag_02  ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
        MinLifetime = 15000
        MaxLifetime = 15000
    End

    Behavior = AutoHealBehavior ModuleTag_HealUpdate
        StartsActive                = Yes
        HealingAmount                = 3 ;,; 2 
        HealingDelay                = 100 
        Radius                        = 9999999   
        KindOf                        = INFANTRY CAVALRY HERO MONSTER DOZER ;,;	
    End

    Behavior = BannerCarrierUpdate ReplenishBattalionsModuleTag ;,;
        IdleSpawnRate            = 7000                            ; spawn a new member every n seconds when idle (in miliseconds)
        ReplenishNearbyHorde   = Yes
        ReplenishAllNearbyHordes = Yes
        ScanHordeDistance      = 9999999
        UnitSpawnFX            = FX_BannerCarrierSpawnUnit                ; name of particle FX to use when the BannerCarrier spawns a new unit
    End

    Behavior = AIUpdateInterface ModuleTag_03    
        AILuaEventsList                = None 
    End

      Geometry            = CYLINDER
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight        = 100.0
    GeometryIsSmall        = No
End

;------------------------------------------------------------------------------ ;,; Added in v5.1

Object CloudBreak_SpeedBonus
   Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    ;// *** AUDIO Parameters ***

	;// ***DESIGN parameters ***
	EditorSorting     = SYSTEM
	
	ArmorSet
		Armor = NoArmor
	End
	
	VisionRange = 0.0

	;// *** ENGINEERING Parameters ***
	KindOf = IMMOBILE UNATTACKABLE

	Body = ActiveBody ModuleTag_TheActiveBody
		MaxHealth = 99999.0
	End
	
; -------------------------------

    Behavior = DeletionUpdate ModuleTag_02  ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
        MinLifetime = 15000
        MaxLifetime = 15000
    End

	Behavior = AttributeModifierAuraUpdate ModuleTag_SpeedBonus
		StartsActive	= Yes
		BonusName		= CloudBreak_SpeedBonus
		RefreshDelay	= 3000
		Range			= 9999999999
		ObjectFilter	= ANY +INFANTRY +CAVALRY +HORDE +HERO -MACHINE -DOZER
	End		
	
    Behavior = AIUpdateInterface ModuleTag_03    
        AILuaEventsList                = None 
    End

      Geometry            = CYLINDER
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight        = 100.0
    GeometryIsSmall        = No
End

;------------------------------------------------------------------------------
Object SpellBookLorienTrap

 	Draw = W3DScriptedModelDraw ModuleTag_01
 //	 StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
    	DefaultModelConditionState
	      	Model = None
    	End
  	End
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
	ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
	
	
	; --- AUDIO Parameters ---

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:SpellArrowVolleyFireArrowWarningShot		Animation:EXArrowVolleyL.EXArrowVolleyL	Frames:34
			End

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End
	
	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 10000
		MaxLifetime = 10000
	End
	
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName	= LorienTrapPlaceholderWeapon
			FireDelay	= 0
			OneShot		= Yes	; Alternative is to fire as often as the reload time of this weapon allows
		End
	End
	
	Geometry            = BOX
	GeometryMajorRadius = 10.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 3.0
	GeometryIsSmall     = No
	Shadow              = NONE ; doesn't actually have a model...
End

//-----------------------------------------------------------------------------
//-----------------------------------------------------------------------------
Object BreezeofManwe

	// *** ART Parameters ***

    ; ButtonImage for Heros is button image on Hero Select UI to select hero. HI = HeroIcon or HeroImage.
 ;   ButtonImage = HSGaladriel_NaturesWrath
    SelectPortrait         = UPTornado
	Draw = W3DScriptedModelDraw ModuleTag_01
		OkToChangeModelColor = Yes
		DefaultModelConditionState
			Model           = EXWhirlwind
			ParticleSysBone = NONE WhirlwindDust01 
			ParticleSysBone = NONE WhirlwindDust02
		End  
	End
	
 	Draw = W3DTornadoDraw ModuleTag_TornadoDraw
	
		DecalTemplate
  			Texture        = EXWhirlwindGround
			Style          = SHADOW_ALPHA_DECAL
			OpacityMin     = 5% 
			OpacityMax     = 40%	 
			MaxRadius	   = 100.0
			Color          = R:255 G:255 B:255 A:255 ;R:200 G:200 B:200 A:255 
			OnlyVisibleToOwningPlayer = Yes
			RotationsPerMinute = 0.4
			SpiralAcceleration = 1.0
		End
		DecalCount		= 7
		DecalMaxRadius	= 300.0
		
		
	End
	
	// ***DESIGN parameters ***
	Side			= Mordor
	EditorSorting	= UNIT
	ThreatLevel		= 0.0
	CommandPoints	= 0
	ShockwaveResistance = SHOCKWAVE_RESISTANCE_IMMUNE

	VisionRange		= 200.0
	DisplayName		= OBJECT:Whirlwind
	
	CommandSet		= EmptyCommandSet


	// *** AUDIO Parameters ***

	EvaEnemyObjectSightedEvent = None  // Don't bother player about this object showing up over their base -- happens too much to bother

	SoundAmbient	= TornadoLoopMS
	SoundMoveStart	= TornadoMoveStart

	VoiceAttack		= TornadoSelect
	VoiceMove		= TornadoSelect
	VoiceSelect		= TornadoSelect

	// *** ENGINEERING Parameters ***
	RadarPriority = UNIT
	KindOf = SELECTABLE NO_COLLIDE AIRCRAFT UNATTACKABLE MOVE_ONLY CLICK_THROUGH HERO IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION NOT_AUTOACQUIRABLE IGNORES_SELECT_ALL PASS_EXPERIENCE_TO_PRODUCER
	
	Body = ActiveBody ModuleTag_02
		MaxHealth         = 200000
	End

	Behavior = AIUpdateInterface	ModuleTag_AIUpdateInterface
	End

	Behavior = PhysicsBehavior		ModuleTag_PhysicsBehavior
	End
	
	LocomotorSet
		Locomotor = TornadoLocomotor
		Condition = SET_NORMAL 
		Speed     = 1 ;20
	End
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 10000 ;20000
		MaxLifetime		= 10000 ;20000
	End	

	Behavior = FireWeaponUpdate ModuleTag_WINDY
		FireWeaponNugget
			WeaponName = BreathOfManweWindWeapon ;;,;; TornadoWindWeapon
			FireDelay = 0
			OneShot = No
		End
	End	
	

	// TORNADOES ARE SCARY	
	Behavior = AttributeModifierAuraUpdate ModuleTag_FearMe
		StartsActive	= Yes //If no, requires upgrade to turn on.
		BonusName		= EyeOfSauronFear
		RefreshDelay	= 1000
		Range			= 150.0
		ObjectFilter	= ANY +INFANTRY +CAVALRY
		TargetEnemy		= Yes
		MaxActiveRank	= 1		//Only affects level 1 rank units
	End	


	
	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes = ALL
		FadeDelay = 0
		FadeTime = 4000
		DestructionDelay = 4000
        ;FX = INITIAL FX_RohirrimAlliesUnsummon
		;Sound = INITIAL SpellGenericUnsummonFasterMS
	End

	Geometry = CYLINDER
	GeometryMajorRadius = 1.0
	GeometryMinorRadius = 1.0
	GeometryHeight		= 1.0
	GeometryIsSmall		= Yes

// NO SHADOW -M Lo
//    Shadow			= SHADOW_DECAL//SHADOW_ALPHA_DECAL// SHADOW_ALPHA_DECAL_DYNAMIC
//    ShadowSizeX		= 200//
//    ShadowSizeY		= 200//
//    ShadowTexture	= EUTornadoShadow//
//
//	ShadowOpacityStart = 0
//	ShadowOpacityFadeInTime = 1000
//	ShadowOpacityPeak = 255
//	ShadowOpacityFadeOutTime = 1000
//	ShadowOpacityEnd = 0
//
//	ShadowOverrideLODVisibility = yes

End
;=========================NEW FREEZING RAIN FROM ANDY===================================
;------------------------------------------------------------------------------
Object WhiteWinterFX

  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model               = None
      ParticleSysBone = None SnowFX
    End
  End
  
  
  SoundAmbient = SnowStereoAmbientLoop  ;,; <------- really important and you will see why


  ; ***DESIGN parameters ***
  EditorSorting     = SYSTEM
  ArmorSet
    Armor = NoArmor
  End
  VisionRange = 0.0


  ; *** ENGINEERING Parameters ***
  KindOf = IMMOBILE UNATTACKABLE INERT
 
  Body = ActiveBody ModuleTag_01
    MaxHealth = 99999.0
  End

    Behavior = LifetimeUpdate ModuleTag_02
        MinLifetime =  SPELL_FREEZINGRAIN_DURATION 
        MaxLifetime =  SPELL_FREEZINGRAIN_DURATION 
    End
    
    Behavior = AIUpdateInterface ModuleTag_03    
        AILuaEventsList                = None
    End

  Geometry = BOX
  GeometryMajorRadius = 50.0
  GeometryMinorRadius = 50.0
  GeometryHeight = 100.0
  GeometryIsSmall = No    
End

;------------------------------------------------------------------------------
Object WhiteWinterWeatherChanger 

    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model           = none
        End
    End
    
    EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
    ; ***DESIGN parameters ***
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    

    ; *** ENGINEERING Parameters ***
    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1    
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
        MinLifetime = 1000
        MaxLifetime = 1000
    End

    Behavior = FireWeaponUpdate ModuleTag_KillAllCurrentWeather
        FireWeaponNugget
            WeaponName    = WeatherKiller
            Offset = X:0 Y:0 Z:0
            FireDelay    = 0
            OneShot        = Yes
        End
    End

    Behavior = FireWeaponUpdate ModuleTag_MakeTheSnowCaster
        FireWeaponNugget
            WeaponName    = MakeWhiteWinterCaster
            Offset = X:0 Y:0 Z:0
            FireDelay    = 50
            OneShot        = Yes
        End
    End

End

;------------------------------------------------------------------------------ 
Object WhiteWinterCaster 

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model               = None
    End
  End
    
    EvaEnemyObjectSightedEvent = None  ; Not a real unit
  

    ; *** AUDIO Parameters ***
    ; SoundAmbient = RainStereoAmbientLoop  ;,; <------- really important and you will see why


    ; ***DESIGN parameters ***
    EditorSorting   = SYSTEM
    KindOf = BOAT 
    

    ; *** ENGINEERING Parameters ***
    Body = ActiveBody ModuleTag_02 
        MaxHealth = 1    
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
        MinLifetime = SPELL_FREEZINGRAIN_DURATION
        MaxLifetime = SPELL_FREEZINGRAIN_DURATION
    End


    Behavior = FireWeaponUpdate ModuleTag_WeaponFiringApplyAttributeModifier
        FireWeaponNugget
            WeaponName = ConstantWhiteWinter
            Offset = X:0 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End

End
;=========================NEW FREEZING RAIN FROM ANDY===================================
;------------------------------------------------------------------------------
Object RainFX  

  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model               = None
      ParticleSysBone = None RainFX
    End
  End
  
  SoundAmbient = RainStereoAmbientLoop  ;,; <------- really important and you will see why


  ; ***DESIGN parameters ***
  EditorSorting     = SYSTEM
  ArmorSet
    Armor = NoArmor
  End
  VisionRange = 0.0


  ; *** ENGINEERING Parameters ***
  KindOf = IMMOBILE UNATTACKABLE INERT
 
  Body = ActiveBody ModuleTag_01
    MaxHealth = 99999.0
  End

    Behavior = LifetimeUpdate ModuleTag_02
        MinLifetime =  SPELL_FREEZINGRAIN_DURATION 
        MaxLifetime =  SPELL_FREEZINGRAIN_DURATION 
    End
    
    Behavior = AIUpdateInterface ModuleTag_03    
        AILuaEventsList                = None
    End

  Geometry = BOX
  GeometryMajorRadius = 50.0
  GeometryMinorRadius = 50.0
  GeometryHeight = 100.0
  GeometryIsSmall = No    
End

;------------------------------------------------------------------------------
Object FreezingRainWeatherChanger 

    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model           = none
        End
    End
    
    EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
    ; ***DESIGN parameters ***
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    

    ; *** ENGINEERING Parameters ***
    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1    
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
        MinLifetime = 1000
        MaxLifetime = 1000
    End

    Behavior = FireWeaponUpdate ModuleTag_KillAllCurrentWeather
        FireWeaponNugget
            WeaponName    = WeatherKiller
            Offset = X:0 Y:0 Z:0
            FireDelay    = 0
            OneShot        = Yes
        End
    End

    Behavior = FireWeaponUpdate ModuleTag_MakeTheRainCaster
        FireWeaponNugget
            WeaponName    = MakeFreezingRainCaster
            Offset = X:0 Y:0 Z:0
            FireDelay    = 50
            OneShot        = Yes
        End
    End

End

;------------------------------------------------------------------------------ 
Object FreezingRainCaster 

    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model           = none
        End
    End
    
    EvaEnemyObjectSightedEvent = None  ; Not a real unit
  

    ; *** AUDIO Parameters ***

    ; SoundAmbient = RainStereoAmbientLoop  ;,; <------- really important and you will see why


    ; ***DESIGN parameters ***
    EditorSorting   = SYSTEM
    KindOf = BOAT 
    

    ; *** ENGINEERING Parameters ***
    Body = ActiveBody ModuleTag_02 
        MaxHealth = 1    
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
        MinLifetime = SPELL_FREEZINGRAIN_DURATION
        MaxLifetime = SPELL_FREEZINGRAIN_DURATION
    End


    Behavior = FireWeaponUpdate ModuleTag_WeaponFiringApplyAttributeModifier
        FireWeaponNugget
            WeaponName = ConstantFreezingRain
            Offset = X:0 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End

End

;------------------------------OLD 2.02 VERSION------------------------------------------------ ;;,;; 
Object FreezingRainCasterOLD

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End
	
	EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
	; ***DESIGN parameters ***
	EditorSorting   = SYSTEM
	KindOf = BOAT ; NO_COLLIDE IMMOBILE INERT ; UNATTACKABLE
	

	; *** ENGINEERING Parameters ***
	Body = ActiveBody ModuleTag_02 ; ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = SPELL_FREEZINGRAIN_DURATION
		MaxLifetime = SPELL_FREEZINGRAIN_DURATION
	End

	Behavior = FireWeaponUpdate ModuleTag_WeaponFiringApplyAttributeModifier
		FireWeaponNugget
			WeaponName = ConstantFreezingRain
			Offset = X:0 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End

End
;------------------------------------OLD 2.02 VERSION------------------------------------------ ;;,;; added for 2.02e
Object FreezingRainWeatherChangerOLD

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model           = none
		End
	End
	
	EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
	; ***DESIGN parameters ***
	EditorSorting   = SYSTEM
	KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
	

	; *** ENGINEERING Parameters ***
	Body = ImmortalBody ModuleTag_02
		MaxHealth = 1    
		InitialHealth = 1
	End

	Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
		MinLifetime = 1000
		MaxLifetime = 1000
	End

	Behavior = FireWeaponUpdate ModuleTag_KillAllCurrentWeather
		FireWeaponNugget
			WeaponName	= WeatherKiller
			Offset = X:0 Y:0 Z:0
			FireDelay	= 0
			OneShot		= Yes
		End
	End

	Behavior = FireWeaponUpdate ModuleTag_MakeTheRainCaster
		FireWeaponNugget
			WeaponName	= MakeFreezingRainCaster
			Offset = X:0 Y:0 Z:0
			FireDelay	= 50
			OneShot		= Yes
		End
	End

End
;---------------------RIVENDELL RAIN POWER
;------------------------------------------------------------------------------
Object UlmoRainWeatherChanger 

    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model           = none
        End
    End
    
    EvaEnemyObjectSightedEvent = None  ; Not a real unit
  
    ; ***DESIGN parameters ***
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    

    ; *** ENGINEERING Parameters ***
    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1    
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
        MinLifetime = 1000
        MaxLifetime = 1000
    End

    Behavior = FireWeaponUpdate ModuleTag_KillAllCurrentWeather
        FireWeaponNugget
            WeaponName    = WeatherKiller
            Offset = X:0 Y:0 Z:0
            FireDelay    = 0
            OneShot        = Yes
        End
    End

    Behavior = FireWeaponUpdate ModuleTag_MakeTheRainCaster
        FireWeaponNugget
            WeaponName    = MakeUlmoRainCaster
            Offset = X:0 Y:0 Z:0
            FireDelay    = 50
            OneShot        = Yes
        End
    End

End

;------------------------------------------------------------------------------ 
Object UlmoRainCaster 

    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model           = none
        End
    End
    
    EvaEnemyObjectSightedEvent = None  ; Not a real unit
  

    ; *** AUDIO Parameters ***

    SoundAmbient = RainStereoAmbientLoop  ;,; <------- really important and you will see why


    ; ***DESIGN parameters ***
    EditorSorting   = SYSTEM
    KindOf = BOAT 
    

    ; *** ENGINEERING Parameters ***
    Body = ActiveBody ModuleTag_02 
        MaxHealth = 1    
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
        MinLifetime = SPELL_FREEZINGRAIN_DURATION
        MaxLifetime = SPELL_FREEZINGRAIN_DURATION
    End


    Behavior = FireWeaponUpdate ModuleTag_WeaponFiringApplyAttributeModifier
        FireWeaponNugget
            WeaponName = ConstantUlmoRainBuildings
            Offset = X:0 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End
	
	Behavior = FireWeaponUpdate ModuleTag_WeaponFiringApplyAttributeModifierResist
        FireWeaponNugget
            WeaponName = ConstantUlmoRainFearResist
            Offset = X:0 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End

End

;------------------------------------------------------------------------------ ;,; Added in v5.1

Object BlessingofUlmo_Healing
   Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    ;// *** AUDIO Parameters ***

	;// ***DESIGN parameters ***
	EditorSorting     = SYSTEM
	
	ArmorSet
		Armor = NoArmor
	End
	
	VisionRange = 0.0

	;// *** ENGINEERING Parameters ***
	KindOf = IMMOBILE UNATTACKABLE

	Body = ActiveBody ModuleTag_TheActiveBody
		MaxHealth = 99999.0
	End
	
; -------------------------------

    Behavior = DeletionUpdate ModuleTag_02  ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
        MinLifetime = 15000
        MaxLifetime = 15000
    End

    Behavior = AutoHealBehavior ModuleTag_HealUpdate
        StartsActive                = Yes
        HealingAmount                = 3 ;,; 2 
        HealingDelay                = 100 
        Radius                        = 9999999   
        KindOf                        = INFANTRY CAVALRY HERO MONSTER DOZER ;,;	
    End

    Behavior = BannerCarrierUpdate ReplenishBattalionsModuleTag ;,;
        IdleSpawnRate            = 7000                            ; spawn a new member every n seconds when idle (in miliseconds)
        ReplenishNearbyHorde   = Yes
        ReplenishAllNearbyHordes = Yes
        ScanHordeDistance      = 9999999
        UnitSpawnFX            = FX_BannerCarrierSpawnUnit                ; name of particle FX to use when the BannerCarrier spawns a new unit
    End

    Behavior = AIUpdateInterface ModuleTag_03    
        AILuaEventsList                = None 
    End

      Geometry            = CYLINDER
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight        = 100.0
    GeometryIsSmall        = No
End